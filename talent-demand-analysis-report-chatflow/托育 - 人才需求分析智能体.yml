app:
  description: ''
  icon: 🤖
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: 托育 - 人才需求分析智能体
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/gemini:0.7.1@48bf314aad49c68acee6545f34b6ddb652c33e7da457dfb197ac514065e776e4
    version: null
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: bowenliang123/md_exporter:2.1.0@7472b9ad6fe068f775ec891f1a3b36d99e6699752bab77143a84d38f2f864dbe
    version: null
kind: app
version: 0.5.0
workflow:
  conversation_variables:
  - description: 岗位数据
    id: 50d97855-1662-4a6e-aa19-38ed860ea80b
    name: career_postings
    selector:
    - conversation
    - career_postings
    value: ''
    value_type: string
  - description: 企业数据
    id: 36634fbd-bc7c-47fc-af27-686cf6be4162
    name: enterprise_infos
    selector:
    - conversation
    - enterprise_infos
    value: ''
    value_type: string
  - description: ''
    id: 315c8f43-395d-48b2-8198-138e40278ddf
    name: or_obj
    selector:
    - conversation
    - or_obj
    value:
    - doc_id: chapter_2_industry_overview
    - doc_id: chapter_4_job_profile_analysis
    - doc_id: chapter_5_peer_program_analysis
    - doc_id: chapter_6_supply_demand_gap_analysis
    value_type: array[object]
  - description: ''
    id: e8b2fd7d-1e36-44c8-a7ff-f49f75353cc7
    name: execution_history
    selector:
    - conversation
    - execution_history
    value: []
    value_type: array[number]
  - description: ''
    id: 17c34f61-90b1-41ae-880b-6ff89e5d1e8a
    name: end_index
    selector:
    - conversation
    - end_index
    value: 0
    value_type: integer
  - description: md内容
    id: d666dba2-cdf5-4e8d-bb15-9ce015accc40
    name: md_content
    selector:
    - conversation
    - md_content
    value: ''
    value_type: string
  - description: 联网搜索数据
    id: 6d4bfa6a-93f9-442c-b3e9-4c706957885a
    name: web_data
    selector:
    - conversation
    - web_data
    value: ''
    value_type: string
  - description: 存储上传数据(文档/数据库)
    id: ad98f4a8-0e8e-4b3e-881b-30021e443031
    name: docs
    selector:
    - conversation
    - docs
    value: []
    value_type: array[string]
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - document
      - image
      - audio
      - video
      allowed_file_upload_methods:
      - remote_url
      - local_file
      enabled: true
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 15
        file_size_limit: 50
        image_file_batch_limit: 10
        image_file_size_limit: 50
        single_chunk_attachment_limit: 10
        video_file_size_limit: 1024
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: 您好！我是本次人才培养方案生成的总控智能体。已接收到您的指令：为 {{#1754636636322.school#}} 的 {{#1754636636322.major#}} 专业生成培养方案。
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 1754645946754-source-1754644265030-target
      selected: false
      source: '1754645946754'
      sourceHandle: source
      target: '1754644265030'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1754637066061-source-1754647350021-target
      selected: false
      source: '1754637066061'
      sourceHandle: source
      target: '1754647350021'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 1754713960183-source-1754645946754-target
      selected: false
      source: '1754713960183'
      sourceHandle: source
      target: '1754645946754'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 17546501512370-source-1754772385839-target
      selected: false
      source: '17546501512370'
      sourceHandle: source
      target: '1754772385839'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 1754772385839-source-1754646490358-target
      selected: false
      source: '1754772385839'
      sourceHandle: source
      target: '1754646490358'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1754879416268-source-17548793238850-target
      selected: false
      source: '1754879416268'
      sourceHandle: source
      target: '17548793238850'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 17548793238850-29f81007-27dd-440a-b922-3bb64fef4b44-1754644270883-target
      selected: false
      source: '17548793238850'
      sourceHandle: 29f81007-27dd-440a-b922-3bb64fef4b44
      target: '1754644270883'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 17548793238850-false-1754649960957-target
      selected: false
      source: '17548793238850'
      sourceHandle: 'false'
      target: '1754649960957'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 17548793238850-true-17548796543720-target
      selected: false
      source: '17548793238850'
      sourceHandle: 'true'
      target: '17548796543720'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: answer
        targetType: code
      id: 1754645557770-source-1754879715500-target
      selected: false
      source: '1754645557770'
      sourceHandle: source
      target: '1754879715500'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 1754879715500-source-1754880002087-target
      selected: false
      source: '1754879715500'
      sourceHandle: source
      target: '1754880002087'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: answer
        targetType: code
      id: 1754644265030-source-1754879715500-target
      selected: false
      source: '1754644265030'
      sourceHandle: source
      target: '1754879715500'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: answer
        targetType: code
      id: 1754646490358-source-1754879715500-target
      selected: false
      source: '1754646490358'
      sourceHandle: source
      target: '1754879715500'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 1754644270883-source-1754971016691-target
      selected: false
      source: '1754644270883'
      sourceHandle: source
      target: '1754971016691'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1754971016691-true-1754713960183-target
      selected: false
      source: '1754971016691'
      sourceHandle: 'true'
      target: '1754713960183'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 1754971016691-false-17549710663490-target
      selected: false
      source: '1754971016691'
      sourceHandle: 'false'
      target: '17549710663490'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1754646472936-source-17546501512370-target
      selected: false
      source: '1754646472936'
      sourceHandle: source
      target: '17546501512370'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: code
      id: 1754647350021-source-1755255418099-target
      selected: false
      source: '1754647350021'
      sourceHandle: source
      target: '1755255418099'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: tool
      id: 17548793238850-f4cd6161-255b-4e7f-b730-6799df894cd7-17552597178210-target
      selected: false
      source: '17548793238850'
      sourceHandle: f4cd6161-255b-4e7f-b730-6799df894cd7
      target: '17552597178210'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: llm
      id: 17552597178210-source-1754637066061-target
      selected: false
      source: '17552597178210'
      sourceHandle: source
      target: '1754637066061'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: tool
        targetType: code
      id: 1754999309447-source-1757507775635-target
      selected: false
      source: '1754999309447'
      sourceHandle: source
      target: '1757507775635'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1757507775635-source-1754646472936-target
      selected: false
      source: '1757507775635'
      sourceHandle: source
      target: '1754646472936'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: tool
        targetType: code
      id: 1757497049911-source-1761735212120-target
      selected: false
      source: '1757497049911'
      sourceHandle: source
      target: '1761735212120'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: answer
      id: 1761735212120-source-1754772651793-target
      selected: false
      source: '1761735212120'
      sourceHandle: source
      target: '1754772651793'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: 1754636636322-source-1761735753678-target
      selected: false
      source: '1754636636322'
      sourceHandle: source
      target: '1761735753678'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1761735753678-false-1754879416268-target
      selected: false
      source: '1761735753678'
      sourceHandle: 'false'
      target: '1754879416268'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 1761735753678-true-176173627380517-target
      selected: false
      source: '1761735753678'
      sourceHandle: 'true'
      target: '176173627380517'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 176173627380517-source-176173627380516-target
      selected: false
      source: '176173627380517'
      sourceHandle: source
      target: '176173627380516'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 176173627380516-true-176173627380518-target
      selected: false
      source: '176173627380516'
      sourceHandle: 'true'
      target: '176173627380518'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 176173627380516-false-17617362738059-target
      selected: false
      source: '176173627380516'
      sourceHandle: 'false'
      target: '17617362738059'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 176173627380516-29f81007-27dd-440a-b922-3bb64fef4b44-17617362738053-target
      selected: false
      source: '176173627380516'
      sourceHandle: 29f81007-27dd-440a-b922-3bb64fef4b44
      target: '17617362738053'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: if-else
      id: 17617362738053-source-176173627380521-target
      selected: false
      source: '17617362738053'
      sourceHandle: source
      target: '176173627380521'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 176173627380521-false-176173627380522-target
      selected: false
      source: '176173627380521'
      sourceHandle: 'false'
      target: '176173627380522'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 176173627380521-true-176173627380513-target
      selected: false
      source: '176173627380521'
      sourceHandle: 'true'
      target: '176173627380513'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 176173627380513-source-17617362738055-target
      selected: false
      source: '176173627380513'
      sourceHandle: source
      target: '17617362738055'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 17617362738055-source-17617362738052-target
      selected: false
      source: '17617362738055'
      sourceHandle: source
      target: '17617362738052'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: tool
      id: 176173627380516-f4cd6161-255b-4e7f-b730-6799df894cd7-176173627380526-target
      selected: false
      source: '176173627380516'
      sourceHandle: f4cd6161-255b-4e7f-b730-6799df894cd7
      target: '176173627380526'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 176173627380516-2a1917a9-3a37-4e74-ae24-fba0fc5477c2-176173627380523-target
      selected: false
      source: '176173627380516'
      sourceHandle: 2a1917a9-3a37-4e74-ae24-fba0fc5477c2
      target: '176173627380523'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: tool
      id: 176173627380523-source-176173627380527-target
      selected: false
      source: '176173627380523'
      sourceHandle: source
      target: '176173627380527'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: code
      id: 176173627380527-source-176173627380529-target
      selected: false
      source: '176173627380527'
      sourceHandle: source
      target: '176173627380529'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: answer
      id: 176173627380529-source-176173627380515-target
      selected: false
      source: '176173627380529'
      sourceHandle: source
      target: '176173627380515'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 176173627380514-source-17617362738057-target
      selected: false
      source: '176173627380514'
      sourceHandle: source
      target: '17617362738057'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: answer
        targetType: code
      id: 17617362738052-source-176173627380519-target
      selected: false
      source: '17617362738052'
      sourceHandle: source
      target: '176173627380519'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: answer
        targetType: code
      id: 17617362738054-source-176173627380519-target
      selected: false
      source: '17617362738054'
      sourceHandle: source
      target: '176173627380519'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: answer
        targetType: code
      id: 17617362738057-source-176173627380519-target
      selected: false
      source: '17617362738057'
      sourceHandle: source
      target: '176173627380519'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 176173627380519-source-176173627380520-target
      selected: false
      source: '176173627380519'
      sourceHandle: source
      target: '176173627380520'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: code
      id: 176173627380526-source-1761741945019-target
      selected: false
      source: '176173627380526'
      sourceHandle: source
      target: '1761741945019'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 1761741945019-source-176173627380511-target
      selected: false
      source: '1761741945019'
      sourceHandle: source
      target: '176173627380511'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 176173627380511-source-17617362738054-target
      selected: false
      source: '176173627380511'
      sourceHandle: source
      target: '17617362738054'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: tool
        targetType: code
      id: 176173627380524-source-17617436446190-target
      selected: false
      source: '176173627380524'
      sourceHandle: source
      target: '17617436446190'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 17617436446190-source-176173627380514-target
      selected: false
      source: '17617436446190'
      sourceHandle: source
      target: '176173627380514'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1765163992033-source-1765164099685-target
      selected: false
      source: '1765163992033'
      sourceHandle: source
      target: '1765164099685'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: code
      id: 1765164099685-source-1765164153379-target
      selected: false
      source: '1765164099685'
      sourceHandle: source
      target: '1765164153379'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: code
      id: 1754991511949-source-1766335411658-target
      selected: false
      source: '1754991511949'
      sourceHandle: source
      target: '1766335411658'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: tool
      id: 1766335411658-source-1757497049911-target
      selected: false
      source: '1766335411658'
      sourceHandle: source
      target: '1757497049911'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: code
      id: 17548793238850-2a1917a9-3a37-4e74-ae24-fba0fc5477c2-1754991511949-target
      selected: false
      source: '17548793238850'
      sourceHandle: 2a1917a9-3a37-4e74-ae24-fba0fc5477c2
      target: '1754991511949'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: if-else
      id: 17548793238850-f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc-1770091124929-target
      selected: false
      source: '17548793238850'
      sourceHandle: f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc
      target: '1770091124929'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: tool
      id: 1770091124929-true-1754999309447-target
      selected: false
      source: '1770091124929'
      sourceHandle: 'true'
      target: '1754999309447'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: assigner
      id: 1770091124929-false-1770091146541-target
      selected: false
      source: '1770091124929'
      sourceHandle: 'false'
      target: '1770091146541'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 1770091146541-source-17700911705560-target
      selected: false
      source: '1770091146541'
      sourceHandle: source
      target: '17700911705560'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: answer
        targetType: code
      id: 17700911705560-source-1754879715500-target
      selected: false
      source: '17700911705560'
      sourceHandle: source
      target: '1754879715500'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: if-else
      id: 176173627380516-f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc-1770091319205-target
      selected: false
      source: '176173627380516'
      sourceHandle: f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc
      target: '1770091319205'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: tool
      id: 1770091319205-true-176173627380524-target
      selected: false
      source: '1770091319205'
      sourceHandle: 'true'
      target: '176173627380524'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: assigner
      id: 1770091319205-false-1770091331592-target
      selected: false
      source: '1770091319205'
      sourceHandle: 'false'
      target: '1770091331592'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 1770091331592-source-17700913412330-target
      selected: false
      source: '1770091331592'
      sourceHandle: source
      target: '17700913412330'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: answer
        targetType: assigner
      id: 17700913412330-source-176173627380520-target
      selected: false
      source: '17700913412330'
      sourceHandle: source
      target: '176173627380520'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: tool
      id: 1755255418099-source-1770104708923-target
      selected: false
      source: '1755255418099'
      sourceHandle: source
      target: '1770104708923'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: tool
        targetType: code
      id: 1770104708923-source-1770109415803-target
      source: '1770104708923'
      sourceHandle: source
      target: '1770109415803'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: code
      id: 1770109415803-source-1770109476978-target
      source: '1770109415803'
      sourceHandle: source
      target: '1770109476978'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: llm
      id: 1770109476978-source-1765163992033-target
      source: '1770109476978'
      sourceHandle: source
      target: '1765163992033'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: code
        targetType: code
      id: 1765164153379-source-1754651516960-target
      source: '1765164153379'
      sourceHandle: source
      target: '1754651516960'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: assigner
      id: 1754651516960-source-1770109738186-target
      source: '1754651516960'
      sourceHandle: source
      target: '1770109738186'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: answer
      id: 1770109738186-source-1754645557770-target
      source: '1770109738186'
      sourceHandle: source
      target: '1754645557770'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: 开始
        type: start
        variables:
        - label: school
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: school
        - label: major
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: major
        - label: region
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: region
        - label: education_level
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: education_level
        - allowed_file_extensions: []
          allowed_file_types:
          - image
          allowed_file_upload_methods:
          - local_file
          - remote_url
          label: step
          max_length: 5
          options:
          - '0'
          - '1'
          - '2'
          - '3'
          required: false
          type: select
          variable: step
        - default: ''
          hint: ''
          label: step_content
          max_length: null
          options: []
          placeholder: ''
          required: false
          type: paragraph
          variable: step_content
        - default: '0'
          hint: ''
          label: modify
          max_length: 48
          options:
          - '0'
          - '1'
          placeholder: ''
          required: false
          type: select
          variable: modify
      height: 265
      id: '1754636636322'
      position:
        x: -800.9444788033261
        y: 336.5828495059124
      positionAbsolute:
        x: -800.9444788033261
        y: 336.5828495059124
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: 用户上传文件和数据库（可选）
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gemini-2.5-pro
          provider: langgenius/gemini/google
        prompt_template:
        - id: 36ced276-8fe5-4a09-96ab-e74cea606903
          role: system
          text: "# 角色 (Role)\n你是一位顶级产业情报分析师与数字情报专家，拥有二十年经验。你的核心能力是**链式思考 (Chain-of-Thought)**，能够将一个模糊的目标分解为一套条理清晰、层层递进、覆盖全面的数据获取策略。你的座右铭是：“**没有搜不到的数据，只有不够精准的查询矩阵**”。\n\
            \n# 核心任务 (Core Mission)\n为一份旗舰级的《【{{major}}】专业人才需求与产教融合诊断报告》（面向【{{school}}】，教育层次【{{education_level}}】，地域【{{region}}】）设计一套**“穷尽式\
            \ (Exhaustive)”的网络数据获取策略**。你必须生成一个结构化的查询关键词矩阵，用于后续的自动化搜索。\n\n# 指导原则 (Guiding\
            \ Principles)\n1.  **权威优先 (Authority First):** 绝对优先搜索 `gov.cn`  (政府，特别是卫健委 nhc.gov.cn),,`edu.cn`\
            \ (教育), `org.cn` (行业协会) 域下的PDF/XLS/PPT报告。其次是头部咨询机构（亿欧智库、艾瑞咨询）和主流招聘平台（智联、前程无忧、BOSS直聘研究院）发布的官方报告。\n\
            2.  **链式思考与关键词制备 (CoT & Keyword Preparation):** **这是你的第一步，也是最重要的一步。**\
            \ 在生成任何查询前，你必须在内部完成以下思考，为后续查询制备“弹药”：\n    *   **专业关键词扩展:** 从 `{{major}}`\
            \ 出发，联想出 1-3 个高度相关的同义词、缩写、或技术栈核心词。 (例如: 婴幼儿照护, 托育服务, 0-3岁照护, 早期教育)。\n\
            \    *   **核心岗位推导:** 根据 `{{major}}` 和 `{{education_level}}`，推导出 1-2 个最典型、最直接对应的**核心岗位名称**。\
            \ (例如: `高职`的`托育服务专业` -> `托育师`, `保育师`, `育婴师`)。\n    *   **地域逐级下钻:** 从 `{{region}}`\
            \ (省级) 出发，识别出其**省会城市**和另外1-2个**核心经济城市**。 例如: 广东省 -> 广州, 深圳, 佛山)。\n   \
            \ *   **标杆院校识别:** 根据后续“对标院校分析”阶段的需求，预先识别1-2个标杆院校名称，用于填充`{{某标杆院校}}`占位符。\n\
            3.  **查询矩阵思维 (Query Matrix Mindset):** 使用上一步制备的关键词，构建**组合查询**。例如 `(地域)\
            \ x (核心岗位) x (主题)`，` (来源) x (专业) x (报告类型)`。\n4.  **时间限定 (Time Range):**\
            \ **必须**将所有包含 `{{YYYY}}` 的查询模板，根据 `{{current_time}}` 自动扩展为**过去两年**的独立查询。例如，若`current_time`是2025年，则自动生成2024,\
            \ 2023两年的查询。\n5.  **动态适应 (Dynamic Adaptation):** 查询策略必须根据 `{{education_level}}`\
            \ 动态调整，使用该层次特有的关键词（如高职的“双高计划”，本科的“一流专业”）。\n6.  **语法洁癖 (Strict Syntax):**\
            \ **严禁**在最终查询字符串中使用 `OR`, `|`, `()`。所有高级语法（如`site:`, `filetype:`, `intitle:`）必须在独立的、简单的查询中使用。\n\
            \n# 输入信息 (Input Information)\n-   school: `{{school}}`\n-   major: `{{major}}`\n\
            -   region: `{{region}}`\n-   education_level: `{{education_level}}`\n\
            -   current_time: `{{current_time}}`\n\n# 数据获取作战计划 (Data Acquisition Battle\
            \ Plan)\n---\n#### **阶段一：战略宏观侦察 (宏观报告与政策)**\n*   **目标:** 获取行业宏观数据，【包含最近3年】的政策、市场规模、产业链报告。\n\
            *   **查询策略 (矩阵式生成):**\n    *   `site:{{region}}.gov.cn \"{{major}}产业发展规划\"\
            \ {{YYYY}} filetype:pdf`\n    *   `site:miit.gov.cn \"{{major}}产业\" \"\
            白皮书\" {{YYYY}} filetype:pdf`\n    *   `\"中国 {{major}} 市场规模\" \"研究报告\"\
            \ {{YYYY}}`\n    *   `intitle:\"{{major}}产业链\" \"全景图\" \"报告\"`\n    *\
            \   `\"{{major}} 龙头企业\" \"市场份额\" \"分析报告\" {{YYYY}}`\n    *   `\"艾瑞咨询\"\
            \ \"{{major}}\" \"行业研究报告\" {{YYYY}} filetype:pdf`\n\n---\n#### **阶段二：战术岗位渗透\
            \ (微观岗位与技能)**\n*   **目标:** 利用**推导出的核心岗位和地域**，获取与`{{education_level}}`强相关的微观岗位数据。\n\
            *   **查询策略 (矩阵式生成):**\n    *   **（使用你推导出的核心城市和岗位进行组合查询）**\n    *   `\"\
            {{核心城市A}}\" \"{{核心岗位A}}\" 招聘 薪酬 {{YYYY}}`\n    *   `\"{{核心城市B}}\" \"{{核心岗位B}}\"\
            \ 招聘 要求 \"{{education_level}}\"`\n    *   `\"{{核心岗位A}}\" \"岗位职责\" \"任职要求\"\
            `\n    *   `\"{{核心岗位B}}\" \"技能要求\" \"技能图谱\"`\n    *   `\"{{核心岗位A}}\" \"\
            职业发展路径\" \"晋升\"`\n    *   `\"智联招聘\" \"{{region}}\" \"{{major}}\" \"薪酬报告\"\
            \ {{YYYY}}`\n    *   `\"前程无忧\" \"{{major}}\" \"薪酬报告\" {{YYYY}}`\n    *\
            \   `\"BOSS直聘研究院\" \"{{major}}\" \"人才洞察\" {{YYYY}}`\n    *   `\"教育部\"\
            \ \"1+X证书\" \"{{major}}\"`\n\n---\n#### **阶段三：对标院校分析 (专业建设与课程)**\n*  \
            \ **目标:** 获取全国及区域内**同层次**标杆院校【最近3年】的专业开设与课程设置情况。\n*   **查询策略 (根据{{education_level}}动态选择):**\n\
            \n    *   **如果 `{{education_level}}` 是 `高职` or `专科`:**\n        *   `site:moe.gov.cn\
            \ \"高等职业教育专科专业目录\" {{YYYY}} filetype:pdf`\n        *   `\"{{region}}\"\
            \ \"职业教育\" \"产教融合\" \"实施方案\" {{YYYY}}`\n        *   `\"{{某标杆院校}}\" \"\
            {{major}}\" \"课程体系\" filetype:pdf`\n    *   **如果 `{{education_level}}`\
            \ 是 `本科` or `职教本科`:**\n        *   `site:moe.gov.cn \"普通高等学校本科专业目录\" {{YYYY}}\
            \ filetype:pdf`\n        *   `全国 \"一流本科专业\" \"{{major}}\" \"建设点名单\"`\n\
            \        *   `\"{{某标杆院校}}\" \"{{major}}\" \"课程设置\" filetype:pdf`\n\n---\n\
            #### **阶段四：供需量化分析 (人才缺口数据)**\n*   **目标:** 获取【最近3年】量化的人才供给（毕业生数）和人才需求（岗位数）数据。\n\
            *   **查询策略 (分解查询):**\n    *   **供给端 (Supply Queries):**\n        *   `site:{{region}}.stats.gov.cn\
            \ \"{{region}}省\" \"国民经济和社会发展统计公报\" {{YYYY}}`\n        *   `site:{{region}}.edu.gov.cn\
            \ \"{{region}}省\" \"教育事业发展统计公报\" {{YYYY}}`\n        *   `\"{{school}}\"\
            \ \"{{YYYY}}届\" \"毕业生就业质量年度报告\" filetype:pdf`\n    *   **需求端 (Demand Queries):**\n\
            \        *   `\"猎聘大数据研究院\" \"{{region}}\" \"{{major}}人才\" \"趋势报告\" {{YYYY}}`\n\
            \        *   `\"{{region}}省会城市\" \"{{major}}\" \"人才紧缺指数\" {{YYYY}}`\n\
            \        *   `\"{{region}}\" \"{{major}}相关产业\" 新增企业数量 统计 {{YYYY}}`\n\n\
            # 输出要求 (Output Format)\n你必须严格按照以下 JSON 格式输出。**将上述策略转化为具体的、可执行的查询字符串**。严禁包含任何额外的解释、说明或\
            \ markdown 格式标记。你的输出只能是符合规范的JSON对象。\n\n```json\n{\n  \"search_strategy_for_report\"\
            : {\n    \"chapter_2_industry_overview\": {\n      \"comment\": \"Queries\
            \ for high-level industry data, targeting official reports and white papers.\"\
            ,\n      \"queries\": [\n        \"string\",\n        \"string\",\n  \
            \      \"string\"\n      ]\n    },\n    \"chapter_4_job_profile_analysis\"\
            : {\n      \"comment\": \"Matrix queries for granular job post data (demand,\
            \ salary, skills), using deduced core jobs and cities.\",\n      \"queries\"\
            : [\n        \"string\",\n        \"string\"\n      ]\n    },\n    \"\
            chapter_5_peer_program_analysis\": {\n      \"comment\": \"Queries to\
            \ find peer institutions and their curriculum, adapted for the specific\
            \ education level.\",\n      \"queries\": [\n        \"string\",\n   \
            \     \"string\"\n      ]\n    },\n    \"chapter_6_supply_demand_gap_analysis\"\
            : {\n      \"comment\": \"Decomposed queries to find quantitative data\
            \ for supply (graduates) and demand (jobs).\",\n      \"supply_queries\"\
            : [\n        \"string\"\n      ],\n      \"demand_queries\": [\n     \
            \   \"string\"\n      ]\n    }\n  }\n}\n"
        - id: 91e18c4a-709e-43c7-9b74-e40ac18763e2
          role: user
          text: 'school:{{#1754636636322.school#}}

            major:{{#1754636636322.major#}}

            region：{{#1754636636322.region#}}

            education_level：{{#1754636636322.education_level#}}

            current_time:{{#17552597178210.text#}}'
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 1000
        selected: false
        title: 联网搜索关键字agent
        type: llm
        variables: []
        vision:
          enabled: false
      height: 147
      id: '1754637066061'
      position:
        x: 926.780538230249
        y: -1034.8971219166851
      positionAbsolute:
        x: 926.780538230249
        y: -1034.8971219166851
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: 收到文件{{#1754644270883.result#}}。
        desc: ''
        selected: false
        title: 已经收到文件
        type: answer
        variables: []
      height: 103
      id: '1754644265030'
      position:
        x: 1748.985599869119
        y: -1224.841083336189
      positionAbsolute:
        x: 1748.985599869119
        y: -1224.841083336189
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "def main(files) -> dict:\n    # 提取每个对象的 filename 字段\n    filenames\
          \ = [f.get(\"filename\", \"\") for f in files if isinstance(f, dict)]\n\
          \    \n    # 使用英文逗号连接\n    arg1 = \",\".join(filenames)\n    \n    return\
          \ {\n        \"result\": arg1\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: 获取文件名
        type: code
        variables:
        - value_selector:
          - sys
          - files
          value_type: array[file]
          variable: files
      height: 52
      id: '1754644270883'
      position:
        x: 672.9138950060967
        y: -1168.9928508159128
      positionAbsolute:
        x: 672.9138950060967
        y: -1168.9928508159128
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#1754651516960.result#}}'
        desc: ''
        selected: false
        title: 联网搜索
        type: answer
        variables: []
      height: 103
      id: '1754645557770'
      position:
        x: 2994.2206351086534
        y: -963.7261975025244
      positionAbsolute:
        x: 2994.2206351086534
        y: -963.7261975025244
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1754713960183'
          - arry_str
          variable_selector:
          - conversation
          - docs
          write_mode: over-write
        selected: false
        title: 变量赋值
        type: assigner
        version: '2'
      height: 84
      id: '1754645946754'
      position:
        x: 1460.7548438968497
        y: -1224.841083336189
      positionAbsolute:
        x: 1460.7548438968497
        y: -1224.841083336189
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gemini-2.5-pro
          provider: langgenius/gemini/google
        prompt_template:
        - id: e5f90a11-e4dc-4e46-8bba-95de4e98999a
          role: system
          text: "# ROLE: 顶尖产业战略与高等教育咨询首席顾问\n\n# CONTEXT:\n你正在为【{{school}}】的【{{major}}】专业（专业层次：{{education_level}}）撰写一份旗舰级的、具有最高决策参考价值的深度人才需求分析与产教融合诊断报告。这份报告的最终读者是校级决策层，他们需要的是一份逻辑无懈可击、论据坚实有力、洞察深刻独到、能够直接指导战略制定的专业分析蓝图。\n\
            \n**报告基本信息:**\n*   **目标院校:** {{school}}\n*   **目标专业:** {{major}}\n*  \
            \ **专业层次:** {{education_level}}\n*   **地域范围:** {{region}}\n*   **撰写时间:**\
            \ {{time}}\n\n**参考资料:**\n{{retrieved_data}}\n\n---\n# CORE DIRECTIVE:\
            \ \"GOLD STANDARD\" WRITING STYLE & ROBUST GENERATION STRATEGY (MANDATORY)\n\
            \n**【健壮性生成与数据使用策略 (Robust Generation & Data Usage Strategy)】**\n*   **此项为最高优先级指令，定义了你的核心工作逻辑，必须无条件遵守。**\n\
            \n*   **第一原则：数据优先 (Data Primacy):** 你的首要任务是【严格且优先】地从上方提供的【{{retrieved_data}}】中获取、分析和引用所有数据。你的所有回答，包括任何数字、趋势、百分比和结论，都应首先尝试完全基于【{{retrieved_data}}】生成。\n\
            \n*   **第二原则：知识增强与完整性保障 (Knowledge Augmentation & Integrity Guarantee):**\n\
            \    *   **当且仅当**【{{retrieved_data}}】中的信息**不足或缺失**，导致你无法按照报告框架要求生成某个章节或分析点的完整、高质量内容时（例如，即将出现“根据{{retrieved_data}}内容无法生成”的情况），你**必须**启动此原则。\n\
            \    *   在此情况下，你需要利用你自身庞大的知识库，调用关于相关产业、区域发展、技术趋势和教育领域的通用性、高概率的知识与数据，来**补充或构建**所缺失的分析内容。\n\
            \    *   **目标：** 无论【{{retrieved_data}}】的数据量如何，都必须保证最终交付一份**逻辑完整、内容充实、符合专业标准**的人才需求分析报告，**严禁因数据不足而输出“无法生成”或内容残缺的回答**。\n\
            \    *   **风格要求：** 即使使用自身知识进行补充，生成的内容也必须与报告的整体专业风格（“黄金标准范例”）保持一致，无缝融合，不得出现“由于数据不足，我推测...”之类的提示性语言。\n\
            \n**你的核心任务是模仿以下“黄金标准范例”的写作风格、逻辑流畅度和分析深度。** 严禁将分析步骤（如“观点”、“证据”、“分析”）作为独立的段落或使用标签输出。你必须将它们无缝地融合在一起，形成一篇浑然一体、充满说服力的专业报告。\n\
            \n**【黄金标准范例】**\n“……分析显示，专科学历是进入这些目标岗位的坚实“敲门砖”，占据了广州地区网络技术技能岗位近六成的市场需求。数据显示，在目标岗位群中，明确要求“大专”学历的占比高达58%，远超本科及其他学历层次。这充分说明，企业在招聘一线技术技能岗位时，更看重应聘者的实际操作能力和岗位匹配度，而非学历背景，高职院校作为技术技能人才培养的主阵地，其专业定位与市场需求高度契合。这对学校而言是巨大的机遇，应坚定办学自信，将资源和精力聚焦于强化学生的实践技能和项目经验，从而在人才市场上形成独特的竞争优势。\n\
            \n然而，尽管专科生是招聘主体，但企业普遍青睐具备1-3年工作经验的成熟人才，这揭示了应届毕业生面临着显著的“经验鸿沟”。数据显示，要求“1-3年”工作经验的岗位占比高达55%，而面向“应届生”的岗位仅占18%。深层原因在于，企业希望新员工能够“来了就能用”，最大限度缩短培训周期。这对学校的人才培养模式提出了严峻挑战，必须将“经验鸿沟”的弥合作为核心目标，通过深化产教融合，将企业真实项目、真实案例引入课堂和实训，让学生在毕业时即拥有“准”工作经验，从而跨越这道门槛……”\n\
            \n**【写作风格关键要素】**\n1.  **无缝融合**: 将观点、数据、分析和结论自然地串联在一个或多个段落中。\n2.  **数据驱动的叙事**:\
            \ 先抛出核心洞察，立刻用精准数据支撑，然后深入解读数据背后的原因和对学院的启示。\n3.  **转折与递进**: 使用“然而”、“进一步分析发现”、“这不仅意味着…更重要的是…”等关联词，构建起复杂的逻辑关系，而不是平铺直叙。\n\
            4.  **顾问式语言**: 语言专业、自信，直指问题核心，并给出方向性判断。\n5.  **【新增核心指令】时间逻辑一致性 (Time-Logic\
            \ Consistency):**\n    *   你的所有分析和图表**必须**与报告的【撰写时间: {{time}}】保持严格的逻辑一致性。\n\
            \    *   在处理时间序列数据（如市场规模、需求趋势）时，年份的属性（历史或预测）必须根据 `{{time}}` 动态判断。\n  \
            \  *   **规则示例:** 如果 `{{time}}` 是“2025年”，那么所有2024年及之前的数据均属【历史数据】，在图表和文字中绝不能标记为预测（例如使用\
            \ '(E)' 或 '(预测)'）。只有2025年及之后的年份数据，才能被视为【预测数据】。此规则是确保报告严谨性的底线。\n6.  **图文并茂的艺术\
            \ (STRICTLY REGULATED):**\n    *   **通用规则**: 所有图表必须使用Markdown ECharts\
            \ (` ```echarts `)语法，并紧随其分析文本之后，形成“先文后图，图文呼应”的结构。图表标题必须是结论性的。\n    * \
            \  **【核心指令】基于洞察的智能图表选择 (Insight-Driven Chart Selection):** 为确保图表渲染的兼容性，你为每一个核心洞察匹配的图表类型，**必须严格从以下列表中选择**：\n\
            \        *   **比较类:** 动态排序条形图、美化的柱状图/条形图。\n        *   **趋势类:** 多线平滑折线图。\n\
            \        *   **构成类:** 旭日图、南丁格尔玫瑰图、矩形树图。\n        *   **分布与关联类:** 气泡图、普通散点图。\n\
            \        *   **多维分析类:** 雷达图。\n    *   **地理数据处理:** **严禁使用地理地图（Map）类型图表。**当处理与地理位置相关的数据时，你必须使用以下图表类型进行替代：**条形图**（按区域数值排名）或**旭日图**（展示区域-城市等层级结构）。\n\
            \n---\n# REPORT FRAMEWORK AND CONTENT GUIDELINES\n\n[Instruction: 你必须严格遵循以下章节结构。在撰写每一部分内容时，都要在脑海中运行“观点-证据-分析-启示”的逻辑，但最终要以“黄金标准范例”的风格呈现出来。]\n\
            #### **[封面页与目录页]**\n[Instruction: 此处为报告封面。请根据下方信息，以正式、专业、居中的格式生成封面页内容。]\n\
            （报告主标题）\n【{{major}}】专业人才需求分析与产教融合诊断报告\n（报告副标题）\n——基于大数据分析的深度洞察\n学校：{{school}}\n\
            撰写时间：{{time}}\n### 目录页\n\n**第一章：调研概况**\n（一）调研目的与意义\n（二）调研对象与内容\n（三）调研方法与数据来源\n\
            （四）样本情况说明\n\n**第二章：行业发展现状与趋势**\n（一）行业发展历程\n（二）行业发展现状\n1. 行业政策背景\n2. 行业发展现状（市场规模、竞争格局、地域分布）\n\
            （三）行业人才需求分析\n（四）行业发展趋势\n\n**第三章：专业目标岗位筛选与确定**\n（一）岗位筛选方法说明\n（二）关键指标分析\n\
            （三）目标岗位推荐\n\n**第四章：目标岗位人才需求大数据分析**\n（一）目标岗位人才需求概况\n（二）目标岗位人才需求特征分析\n（三）目标岗位能力需求分析\n\
            （四）目标岗位人才需求趋势预测分析\n（五）目标岗位人才需求画像（总结性）\n\n**第五章：【{{major}}】专业建设情况分析**\n\
            （一）全国【{{major}}】专业分布情况\n（二）全国【{{major}}】专业开设趋势（10年+3年预测）\n（三）全省【{{major}}】专业开设情况\n\
            （四）【{{major}}】专业建设情况分析（如全国排名、重点院校对标）\n\n**第六章：区域产教对接匹配度诊断**\n（一）专业布局对接匹配分析\n\
            （二）学历结构对接匹配分析\n\n**第七章：调研结论**\n\n**第八章：建议**\n\n### **第一章：调研概况**\n[Instruction:\
            \ 此章节是整份报告可信度的基石，必须详细阐述，用科学性和严谨性建立读者的信任。]\n#### **（一）调研目的与意义**\n[Instruction:\
            \ 从宏观（响应国家与区域战略）、中观（支撑学校专业定位）、微观（指导课程教学改革）三个层面，深入阐述本次调研的战略价值与现实意义。]\n\
            #### **（二）调研对象与内容**\n[Instruction: 明确界定本次研究的边界。清晰说明研究的行业范畴、地域范围（{{region}}）、目标岗位群，以及报告所覆盖的核心分析模块。]\n\
            #### **（三）调研方法与数据来源**\n[Instruction: 详细阐述科学的研究方法，以建立信任。说明采用了“混合研究方法”，结合了“大数据挖掘分析”和“文本内容分析”。明确数据来源（如主流招聘平台、官方统计报告、行业白皮书等），并提及运用了自然语言处理（NLP）技术进行岗位需求文本的量化分析。]\n\
            #### **（四）样本情况说明**\n[Instruction: 用数据增强说服力。提供本次分析的样本量化信息，例如：“本次分析共采集和清洗了{{region}}地区与{{major}}专业相关的招聘岗位样本共计XX,XXX条，覆盖企业XXX家，时间跨度为XXXX年XX月至XXXX年XX月。”]\n\
            \n### **第二章：行业发展现状与趋势**\n[Instruction: 目标是描绘出一幅动态的、结构清晰的产业全景图，为后续分析奠定宏观基础。]\n\
            #### **（一）行业发展历程**\n[Instruction: 以故事线的方式叙述，划分为“萌芽期、发展期、成熟/变革期”。重点分析每个阶段的**关键驱动力**及其对**人才能力需求侧重点的演变**。]\n\
            #### **（二）行业发展现状**\n##### **1.行业政策背景**\n[Instruction: 将政策进行归类，并深入解读每类政策如何具体**催化**了市场需求和企业招聘行为，为行业发展提供了何种保障或导向。]\n\
            ##### **2.行业发展现状（市场规模、竞争格局、地域分布）**\n[Instruction: 采用内化的C-E-A-I框架。分析市场增长的**质量**，竞争的**核心赛道**，以及地域分布形成的**深层原因**。]\n\
            #### **（三）行业人才需求分析**\n[Instruction: 按照您提供的详细子结构，从概况、特征、企业等角度进行逐层深入分析。**对比**是产生洞见的关键，尤其在分析不同细分领域时，要深刻揭示其在人才需求上的**差异性**。]\n\
            #### **（四）行业发展趋势**\n[Instruction: 基于前面的所有分析，做出有逻辑依据的预测。明确指出未来3-5年人才需求在**数量、层次和能力结构**上可能发生的变化。]\n\
            \n### **第三章：专业目标岗位筛选与确定**\n[Instruction: 目标是论证筛选过程的科学性，并确定出最具价值的目标岗位。]\n\
            #### **（一）岗位筛选方法说明**\n[Instruction: 详细阐述科学的筛选模型（如“T.P.D.S模型”），并说明各维度的评判标准和权重，以彰显客观性。]\n\
            #### **（二）关键指标分析**\n[Instruction: 解释气泡图的四象限含义，重点解读落在“明星象限”内的岗位，并分析其原因。]\n\
            #### **（三）目标岗位推荐**\n[Instruction: 列出最终清单，并为每个岗位撰写一段强有力的“推荐理由”，论证其为何是本专业的最佳选择。]\n\
            \n### **第四章：目标岗位人才需求大数据分析**\n[Instruction: 目标是利用数据，精细刻画出目标岗位的360度全景画像。]\n\
            #### **（一）目标岗位人才需求概况**\n#### **（二）目标岗位人才需求特征分析**\n[Instruction: 严格按照学历、经验、交叉分析、薪资、晋升路径的顺序进行。在“学历经验交叉分析”部分，必须深刻揭示企业需求与应届生现状之间的“能力鸿沟”。在“晋升路径”部分，必须分析每个晋升节点所需补充的核心能力。]\n\
            #### **（三）目标岗位能力需求分析**\n[Instruction: 将能力需求分为“技术技能”和“综合素质”，并为能力图谱赋予“核心必备、熟练掌握、加分项”的层次与权重。]\n\
            #### **（四）目标岗位人才需求趋势预测分析**\n#### **（五）目标岗位人才需求画像（总结性）**\n\n### **第五章：【{{major}}】专业建设情况分析**\n\
            [Instruction: 对标全国和全省，客观评估本专业当前所处的行业位置。]\n#### **（一）全国【{{major}}】专业分布情况**\n\
            #### **（二）全国【{{major}}】专业开设趋势（10年+3年预测）**\n#### **（三）全省【{{major}}】专业开设情况**\n\
            #### **（四）【{{major}}】专业建设情况分析（如全国排名、重点院校对标）**\n\n### **第六章：区域产教对接匹配度诊断**\n\
            [Instruction: **这是报告的诊断核心，必须用数据说话，量化差距。**]\n#### **（一）专业布局对接匹配分析**\n[Instruction:\
            \ **计算并突出展示“供需比”**。例如，通过对比区域需求占比与专业布点占比，量化人才供给的缺口或冗余。]\n#### **（二）学历结构对接匹配分析**\n\
            [Instruction: **计算并突出展示“结构失配指数”**。通过对比市场需求的学历层次比例与本区域相关专业的供给学历层次比例，揭示结构性矛盾。]\n\
            \n### **第七章：调研结论**\n[Instruction: 高度凝练，将前面各章节最核心、最关键的发现（特别是诊断出的问题）进行系统化总结，形成清晰、有力的结论列表。]\n\
            \n### **第八章：建议**\n[Instruction: 基于第七章的结论，提出具有高度针对性、可操作性和优先级的战略与战术建议。建议应覆盖专业方向调整、课程体系改革、师资队伍建设、实践教学强化、校企合作深化等多个方面。]\n\
            \n---\n# FINAL TASK\n**【最高优先级指令】你的回答必须、只能以“### 封面页”这几个字作为开头，前面不能有任何其他文字、空格或换行符。**\n\
            请立即启动。严格遵循上述所有框架和指导方针，特别是牢记并**完美复刻“黄金标准范例”的写作风格和逻辑**，以首席顾问的身份，撰写这份完整的、具有深度洞察力和强大说服力的战略分析报告。\n"
        - id: bddf9324-a1a9-4ad0-9d0e-408fd1ead040
          role: user
          text: 'school：{{#1754636636322.school#}}

            major:{{#1754636636322.major#}}

            region:{{#1754636636322.region#}}

            education_level:{{#1754636636322.education_level#}}

            retrieved_data：{{#1757507775635.trimmed_markdown_content#}}{{#conversation.docs#}}

            time:{{#1754999309447.text#}}'
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 1000
        selected: false
        title: 人才需求分析agent
        type: llm
        variables: []
        vision:
          enabled: false
      height: 119
      id: '1754646472936'
      position:
        x: 1488.8598215715883
        y: -578.7596152853769
      positionAbsolute:
        x: 1488.8598215715883
        y: -578.7596152853769
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#17546501512370.querier_res#}}'
        desc: ''
        selected: false
        title: 人才需求分析结果
        type: answer
        variables: []
      height: 103
      id: '1754646490358'
      position:
        x: 2363.6717175032386
        y: -578.7596152853769
      positionAbsolute:
        x: 2363.6717175032386
        y: -578.7596152853769
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import re\nimport json\n\ndef main(arg1: str) -> dict:\n    m = re.search(r\"\
          <think>.*?</think>\", arg1, flags=re.DOTALL)\n    thout = m.group(0) if\
          \ m else \"\"\n    res = re.sub(r\"<think>.*?</think>\", \"\", arg1, flags=re.DOTALL).strip()\n\
          \    pattern = r\"```json\\s*([\\s\\S]*?)\\s*```\"\n    m2 = re.search(pattern,\
          \ res, flags=re.DOTALL)\n    if m2:\n        extracted = m2.group(1).strip()\n\
          \    else:\n        start = res.find('[')\n        end = res.rfind(']')\n\
          \        if start != -1 and end != -1 and end > start:\n            extracted\
          \ = res[start:end+1].strip()\n        else:\n            extracted = \"\"\
          \n    return {\n        \"querier_thout\": thout,\n        \"querier_res\"\
          : extracted,\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          querier_res:
            children: null
            type: string
          querier_thout:
            children: null
            type: string
        selected: false
        title: 提取器
        type: code
        variables:
        - value_selector:
          - '1754637066061'
          - text
          value_type: string
          variable: arg1
      height: 52
      id: '1754647350021'
      position:
        x: 1189.2476678522094
        y: -1003.6184717443404
      positionAbsolute:
        x: 1189.2476678522094
        y: -1003.6184717443404
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: error:未知错误
        desc: ''
        selected: false
        title: 错误回复
        type: answer
        variables: []
      height: 100
      id: '1754649960957'
      position:
        x: 385.76598866793347
        y: -608.7668314898638
      positionAbsolute:
        x: 385.76598866793347
        y: -608.7668314898638
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import re\nfrom typing import Dict\n\ndef main(arg1: str) -> Dict[str,\
          \ str]:\n    # 提取 <think> 区块（包含标签）\n    think_match = re.search(r\"<think>.*?</think>\"\
          , arg1, flags=re.DOTALL | re.IGNORECASE)\n    thout = think_match.group(0).strip()\
          \ if think_match else \"\"\n\n    # 提取 <think> 之后的剩余部分\n    remaining =\
          \ re.sub(r\"<think>.*?</think>\", \"\", arg1, flags=re.DOTALL | re.IGNORECASE).strip()\n\
          \n    # 优先尝试提取 markdown 代码块\n    md_match = re.search(r\"```markdown\\s*([\\\
          s\\S]*?)\\s*```\", remaining, flags=re.IGNORECASE)\n    if md_match:\n \
          \       extracted = md_match.group(1).strip()\n    else:\n        # 无 markdown\
          \ 代码块，直接使用剩余文本作为 markdown 内容\n        extracted = remaining\n\n    return\
          \ {\n        \"querier_thout\": thout,\n        \"querier_res\": extracted\n\
          \    }\n"
        code_language: python3
        desc: ''
        outputs:
          querier_res:
            children: null
            type: string
          querier_thout:
            children: null
            type: string
        selected: false
        title: 提取器
        type: code
        variables:
        - value_selector:
          - '1754646472936'
          - text
          value_type: string
          variable: arg1
      height: 52
      id: '17546501512370'
      position:
        x: 1803.2308546823092
        y: -578.7596152853769
      positionAbsolute:
        x: 1803.2308546823092
        y: -578.7596152853769
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "from typing import List, Dict, Any\nimport json\ndef is_empty_dict(data:\
          \ Any) -> bool:\n    \"\"\"Checks if a dictionary is considered empty.\"\
          \"\"\n    if isinstance(data, dict):\n        return not any(data.values())\n\
          \    return False\ndef main(network: List[Dict[Any, Any]], postData: List[Dict[Any,\
          \ Any]], private: List[Dict[Any, Any]]) -> Dict[str, Any]:\n    \"\"\"\n\
          \    Filters out empty dictionaries from the input lists and returns a dictionary\n\
          \    containing the filtered lists and a string representation of the result.\n\
          \    \"\"\"\n    filtered_network = [item for item in network if not is_empty_dict(item)]\n\
          \    filtered_postData = [item for item in postData if not is_empty_dict(item)]\n\
          \    filtered_private = [item for item in private if not is_empty_dict(item)]\n\
          \    result = {\n        \"network\": filtered_network,\n        \"postData\"\
          : filtered_postData,\n        \"private\": filtered_private,\n    }\n  \
          \  result_str = json.dumps(result, ensure_ascii=False)  # Convert to JSON\
          \ string\n    return {\n        \"result\": result,\n        \"result_str\"\
          : result_str\n    }"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: object
          result_str:
            children: null
            type: string
        selected: false
        title: 整理数据结构
        type: code
        variables:
        - value_selector:
          - '1765164153379'
          - web_data
          value_type: array[object]
          variable: network
        - value_selector:
          - '1765164153379'
          - career_postings
          value_type: array[object]
          variable: postData
        - value_selector:
          - '1765164153379'
          - enterprise_infos
          value_type: array[object]
          variable: private
      height: 52
      id: '1754651516960'
      position:
        x: 2416.5091220369354
        y: -963.7261975025244
      positionAbsolute:
        x: 2416.5091220369354
        y: -963.7261975025244
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import requests\nimport io\nimport os\nfrom urllib.parse import urlparse\n\
          import time # 引入time模块，可以在批处理之间添加延时\n \n# 各文件类型的处理库\nimport docx\nimport\
          \ pandas as pd\nfrom pptx import Presentation\nimport pdfplumber\n \ndef\
          \ extract_content_from_url(url: str) -> str:\n    \"\"\"\n    根据给定的URL，下载文件并提取其文本内容。\n\
          \    支持的格式: .txt, .csv, .json, .md, .docx, .xlsx, .pptx, .pdf\n \n    Args:\n\
          \        url (str): 文件的公开URL链接。\n \n    Returns:\n        str: 提取出的文本内容，如果失败或不支持则返回错误信息。\n\
          \    \"\"\"\n    print(f\"[*] 正在处理URL: {url}\")\n \n    try:\n        #\
          \ 1. 下载文件\n        # 添加headers模拟浏览器，可以提高成功率\n        headers = {\n     \
          \       'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\
          \ (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n        }\n \
          \       response = requests.get(url, timeout=30, headers=headers)\n    \
          \    response.raise_for_status() # 检查请求是否成功 (非2xx状态码会引发HTTPError)\n    \
          \    print(\"[+] 文件下载成功\")\n \n        file_in_memory = io.BytesIO(response.content)\n\
          \ \n        # 2. 识别文件类型\n        path = urlparse(url).path\n        ext\
          \ = os.path.splitext(path)[1].lower()\n        \n        # 如果URL没有后缀，尝试从响应头中识别\n\
          \        if not ext:\n            content_type = response.headers.get('Content-Type',\
          \ '')\n            print(f\"[*] URL无后缀，检查Content-Type: {content_type}\"\
          )\n            if 'pdf' in content_type: ext = '.pdf'\n            elif\
          \ 'msword' in content_type: ext = '.doc' # 注意，这个库不支持.doc\n            elif\
          \ 'vnd.openxmlformats-officedocument.wordprocessingml.document' in content_type:\
          \ ext = '.docx'\n            elif 'vnd.openxmlformats-officedocument.spreadsheetml.sheet'\
          \ in content_type: ext = '.xlsx'\n            elif 'vnd.openxmlformats-officedocument.presentationml.presentation'\
          \ in content_type: ext = '.pptx'\n \n        print(f\"[*] 文件类型识别为: {ext}\"\
          )\n        \n        # 3. 根据不同类型进行内容提取\n        content = \"\"\n       \
          \ if ext in ['.txt', '.csv', '.json', '.md', '.html', '.xml']:\n       \
          \     content = response.content.decode('utf-8', errors='ignore')\n \n \
          \       elif ext == '.docx':\n            document = docx.Document(file_in_memory)\n\
          \            paragraphs = [p.text for p in document.paragraphs]\n      \
          \      content = \"\\n\".join(paragraphs)\n \n        elif ext == '.xlsx':\n\
          \            xls = pd.ExcelFile(file_in_memory)\n            for sheet_name\
          \ in xls.sheet_names:\n                df = pd.read_excel(xls, sheet_name=sheet_name)\n\
          \                content += f\"--- 工作表: {sheet_name} ---\\n{df.to_string()}\\\
          n\\n\"\n \n        elif ext == '.pptx':\n            prs = Presentation(file_in_memory)\n\
          \            for slide in prs.slides:\n                for shape in slide.shapes:\n\
          \                    if hasattr(shape, \"text\"):\n                    \
          \    content += shape.text + \"\\n\"\n \n        elif ext == '.pdf':\n \
          \           with pdfplumber.open(file_in_memory) as pdf:\n             \
          \   all_text = [page.extract_text() for page in pdf.pages if page.extract_text()]\n\
          \                content = \"\\n\".join(all_text)\n                    \
          \    \n        else:\n            return f\"错误：不支持或无法识别的文件类型 '{ext}'。\"\n\
          \ \n        print(\"[+] 内容提取完成！\")\n        return content.strip()\n \n\
          \    except requests.exceptions.HTTPError as e:\n        return f\"错误：HTTP请求失败\
          \ - {e.response.status_code} {e.response.reason} for URL: {url}\"\n    except\
          \ requests.exceptions.RequestException as e:\n        return f\"错误：网络请求失败\
          \ - {e}\"\n    except Exception as e:\n        return f\"错误：处理文件时发生未知错误\
          \ - {e}\"\n \n# --- 您要求的批处理函数 ---\n \ndef main(files: list) -> dict:\n \
          \   \"\"\"\n    批量处理文件对象列表，提取每个文件URL指向的内容。\n \n    Args:\n        files\
          \ (list): 对象列表，每个对象都应有 .url 属性。\n                      例如: [File(url='http://...'),\
          \ File(url='http://...')]\n \n    Returns:\n        dict: 包含所有处理结果的字典，格式如下:\n\
          \              {\n                  \"result\": [\n                    \
          \  {\"url\": \"url1\", \"content\": \"extracted_content1\"},\n         \
          \             {\"url\": \"url2\", \"content\": \"error_message2\"},\n  \
          \                    ...\n                  ]\n              }\n    \"\"\
          \"\n    results = []\n    arry_str=[]\n    total_files = len(files)\n  \
          \  print(f\"--- 开始批量处理 {total_files} 个文件 ---\")\n \n    for i, file_obj\
          \ in enumerate(files):\n        print(f\"\\n--- 正在处理第 {i + 1}/{total_files}\
          \ 个文件 ---\")\n        \n        # 健壮性检查：确保对象有url属性且不为空\n        # if not\
          \ hasattr(file_obj, 'url') or not getattr(file_obj, 'url'):\n        # \
          \    print(\"[!] 警告：输入对象格式不正确或URL为空，已跳过。\")\n        #     result_item =\
          \ {\n        #         \"url\": getattr(file_obj, 'url', 'URL缺失'),\n   \
          \     #         \"content\": \"错误：输入对象格式不正确或URL为空。\"\n        #     }\n\
          \        #     results.append(result_item)\n        #     continue\n   \
          \     \n        url = file_obj['url']\n        extracted_content = extract_content_from_url(url)\n\
          \        \n        result_item = {\n            \"url\": url,\n        \
          \    \"content\": extracted_content\n        }\n        results.append(result_item)\n\
          \        arry_str.append(extracted_content)\n        # 礼貌性地暂停一下，避免对服务器造成冲击\n\
          \        # time.sleep(1) \n \n    # print(\"\\n--- 所有文件处理完毕 ---\")\n   \
          \ # 返回您指定的最终格式\n    return {\"result\": results,\n            \"arry_str\"\
          :arry_str}"
        code_language: python3
        desc: ''
        outputs:
          arry_str:
            children: null
            type: array[string]
          result:
            children: null
            type: array[object]
        selected: false
        title: 文档提取
        type: code
        variables:
        - value_selector:
          - sys
          - files
          value_type: array[file]
          variable: files
      height: 52
      id: '1754713960183'
      position:
        x: 1189.2476678522094
        y: -1224.841083336189
      positionAbsolute:
        x: 1189.2476678522094
        y: -1224.841083336189
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '17546501512370'
          - querier_res
          variable_selector:
          - conversation
          - md_content
          write_mode: over-write
        selected: false
        title: 变量赋值 3
        type: assigner
        version: '2'
      height: 84
      id: '1754772385839'
      position:
        x: 2083.5299852067315
        y: -578.7596152853769
      positionAbsolute:
        x: 2083.5299852067315
        y: -578.7596152853769
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#1761735212120.markdown_output#}}'
        desc: ''
        selected: false
        title: 导出文件
        type: answer
        variables: []
      height: 103
      id: '1754772651793'
      position:
        x: 1776.1283278458727
        y: -308.96887810534236
      positionAbsolute:
        x: 1776.1283278458727
        y: -308.96887810534236
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: d5f34988-6220-4148-a25c-637238ef540d
            value: '-1'
            varType: number
            variable_selector:
            - '1754879416268'
            - branch_to_run
          id: 'true'
          logical_operator: and
        - case_id: 29f81007-27dd-440a-b922-3bb64fef4b44
          conditions:
          - comparison_operator: '='
            id: 83fec8cd-8699-4065-ae39-bd3f8002ecb6
            value: '0'
            varType: number
            variable_selector:
            - '1754879416268'
            - branch_to_run
          id: 29f81007-27dd-440a-b922-3bb64fef4b44
          logical_operator: and
        - case_id: f4cd6161-255b-4e7f-b730-6799df894cd7
          conditions:
          - comparison_operator: '='
            id: c7f49bcf-5531-4433-8528-b6662ec0187a
            value: '1'
            varType: number
            variable_selector:
            - '1754879416268'
            - branch_to_run
          id: f4cd6161-255b-4e7f-b730-6799df894cd7
          logical_operator: and
        - case_id: f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc
          conditions:
          - comparison_operator: '='
            id: cd992d70-cca2-450b-bff5-cb2791599e71
            value: '2'
            varType: number
            variable_selector:
            - '1754879416268'
            - branch_to_run
          id: f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc
          logical_operator: and
        - case_id: 2a1917a9-3a37-4e74-ae24-fba0fc5477c2
          conditions:
          - comparison_operator: '='
            id: 5ebc7765-4edd-474b-91a6-10961acddef9
            value: '3'
            varType: number
            variable_selector:
            - '1754879416268'
            - branch_to_run
          id: 2a1917a9-3a37-4e74-ae24-fba0fc5477c2
          logical_operator: and
        desc: ''
        selected: false
        title: 判断跳转分支
        type: if-else
      height: 316
      id: '17548793238850'
      position:
        x: 385.76598866793347
        y: -1055.0964236147993
      positionAbsolute:
        x: 385.76598866793347
        y: -1055.0964236147993
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "def main(target_index: str, end_index: int) -> dict:\n    \"\"\"\n\
          \    分支跳转判断函数\n    :param end_index: 用户最后会话执行到的分支编号\n    :param target_index:\
          \ 用户传的目标分支编号\n    :return: { \"branch_to_run\": int, \"msg\": str }\n  \
          \           branch_to_run = -1 表示不允许执行\n    \"\"\"\n    target_index = int(target_index)\n\
          \n    # 检查输入范围\n    if not (0 <= target_index <= 13):\n        return {\"\
          branch_to_run\": -1, \"msg\": f\"目标分支 {target_index} 超出范围\"}\n\n    # 回退：允许执行\n\
          \    if target_index <= end_index:\n        return {\"branch_to_run\": target_index,\
          \ \"msg\": \"\"}\n\n    # 正常向前：只能一步一步往前\n    if target_index == end_index\
          \ + 1:\n        return {\"branch_to_run\": target_index, \"msg\": \"\"}\n\
          \n    # 跳过中间分支 → 不允许\n    return {\"branch_to_run\": -1, \"msg\": f\"不能从\
          \ {end_index} 跳到 {target_index}，请按顺序执行\"}\n"
        code_language: python3
        desc: ''
        outputs:
          branch_to_run:
            children: null
            type: number
          msg:
            children: null
            type: string
        selected: false
        title: 计算跳转分支
        type: code
        variables:
        - value_selector:
          - '1754636636322'
          - step
          value_type: string
          variable: target_index
        - value_selector:
          - conversation
          - end_index
          value_type: number
          variable: end_index
      height: 52
      id: '1754879416268'
      position:
        x: 114.55739023970955
        y: -1055.0964236147993
      positionAbsolute:
        x: 114.55739023970955
        y: -1055.0964236147993
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: error:你不能跳过步骤，请按照顺序步骤执行
        desc: ''
        selected: false
        title: 直接回复
        type: answer
        variables: []
      height: 116
      id: '17548796543720'
      position:
        x: 414.18740583538147
        y: -1288.2882842630725
      positionAbsolute:
        x: 414.18740583538147
        y: -1288.2882842630725
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "def main(branch_id: int, end_index: int, execution_history: list) ->\
          \ dict:\n    if branch_id is None:\n        raise ValueError(\"缺少 branch_id\
          \ 参数\")\n\n    # 更新 end_index\n    if branch_id >= end_index:\n        end_index\
          \ = branch_id\n    else:\n        # branch_id <= end_index，说明回退或访问之前节点，不更新\
          \ end_index\n        pass\n\n    execution_history.append(branch_id)\n\n\
          \    return {\n        \"message\": f\"分支 {branch_id} 执行完成，状态已更新\",\n  \
          \      \"end_index\": end_index,\n        \"execution_history\": execution_history\n\
          \    }\n"
        code_language: python3
        desc: ''
        outputs:
          end_index:
            children: null
            type: number
          execution_history:
            children: null
            type: array[number]
          message:
            children: null
            type: string
        selected: false
        title: 计算index和execution_history
        type: code
        variables:
        - value_selector:
          - '1754879416268'
          - branch_to_run
          value_type: number
          variable: branch_id
        - value_selector:
          - conversation
          - end_index
          value_type: number
          variable: end_index
        - value_selector:
          - conversation
          - execution_history
          value_type: array[number]
          variable: execution_history
      height: 52
      id: '1754879715500'
      position:
        x: 3489.309964386268
        y: -984.5674122860606
      positionAbsolute:
        x: 3489.309964386268
        y: -984.5674122860606
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1754879715500'
          - end_index
          variable_selector:
          - conversation
          - end_index
          write_mode: over-write
        - input_type: variable
          operation: over-write
          value:
          - '1754879715500'
          - execution_history
          variable_selector:
          - conversation
          - execution_history
          write_mode: over-write
        selected: false
        title: 变量赋值 4
        type: assigner
        version: '2'
      height: 110
      id: '1754880002087'
      position:
        x: 3840.795570184015
        y: -984.5674122860606
      positionAbsolute:
        x: 3840.795570184015
        y: -984.5674122860606
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: not empty
            id: 9ff1c43c-46f3-42a5-8619-a83b1d1d7bbf
            value: ''
            varType: string
            variable_selector:
            - '1754644270883'
            - result
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: 条件分支 2
        type: if-else
      height: 124
      id: '1754971016691'
      position:
        x: 926.780538230249
        y: -1181.494527328725
      positionAbsolute:
        x: 926.780538230249
        y: -1181.494527328725
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: 未检测出文件
        desc: ''
        selected: false
        title: 未收到文件
        type: answer
        variables: []
      height: 100
      id: '17549710663490'
      position:
        x: 1189.2476678522094
        y: -1103.3141130152349
      positionAbsolute:
        x: 1189.2476678522094
        y: -1103.3141130152349
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import requests\nfrom typing import Dict, Optional\n\nuser_token =\
          \ \"123456789\"  # 请赋值你的token\n\ndef main(md_content: str) -> Dict[str,\
          \ Optional[str]]:\n    api_url = \"http://119.45.167.133:17752/api/echarts/convert-markdown\"\
          \n    headers = {\n        \"Authorization\": f\"Bearer {user_token}\",\n\
          \        \"Content-Type\": \"application/json\"\n    }\n    payload = {\n\
          \        \"md_content\": md_content,\n    }\n\n    try:\n        response\
          \ = requests.post(api_url, headers=headers, json=payload, timeout=(10, 60))\n\
          \        response.raise_for_status()\n    except requests.RequestException\
          \ as e:\n        raise RuntimeError(f\"❌ 网络请求失败: {str(e)}\")\n\n    try:\n\
          \        result = response.json()\n    except ValueError:\n        raise\
          \ RuntimeError(\"❌ 返回内容非 JSON 格式\")\n\n    # 检查接口状态\n    if not result.get(\"\
          status\", True):\n        raise RuntimeError(f\"❌ 接口调用失败: {result.get('message',\
          \ '未知错误')}\")\n\n    data = result.get(\"data\", {})\n    if not isinstance(data,\
          \ dict):\n        raise RuntimeError(\"❌ 返回数据格式异常\")\n\n    return {\n \
          \        \"md_content\": data.get(\"md_content\")\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          md_content:
            children: null
            type: string
        selected: false
        title: echart转图片
        type: code
        variables:
        - value_selector:
          - conversation
          - md_content
          value_type: string
          variable: md_content
      height: 52
      id: '1754991511949'
      position:
        x: 641.4176119656995
        y: -308.96887810534236
      positionAbsolute:
        x: 641.4176119656995
        y: -308.96887810534236
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: '%Y-%m-%d %H:%M:%S'
          form: form
          human_description:
            en_US: Time format in strftime standard.
            ja_JP: Time format in strftime standard.
            pt_BR: Time format in strftime standard.
            zh_Hans: strftime 标准的时间格式。
          label:
            en_US: Format
            ja_JP: Format
            pt_BR: Format
            zh_Hans: 格式
          llm_description: null
          max: null
          min: null
          name: format
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: UTC
          form: form
          human_description:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          label:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          llm_description: null
          max: null
          min: null
          name: timezone
          options:
          - icon: null
            label:
              en_US: UTC
              ja_JP: UTC
              pt_BR: UTC
              zh_Hans: UTC
            value: UTC
          - icon: null
            label:
              en_US: America/New_York
              ja_JP: America/New_York
              pt_BR: America/New_York
              zh_Hans: 美洲/纽约
            value: America/New_York
          - icon: null
            label:
              en_US: America/Los_Angeles
              ja_JP: America/Los_Angeles
              pt_BR: America/Los_Angeles
              zh_Hans: 美洲/洛杉矶
            value: America/Los_Angeles
          - icon: null
            label:
              en_US: America/Chicago
              ja_JP: America/Chicago
              pt_BR: America/Chicago
              zh_Hans: 美洲/芝加哥
            value: America/Chicago
          - icon: null
            label:
              en_US: America/Sao_Paulo
              ja_JP: America/Sao_Paulo
              pt_BR: América/São Paulo
              zh_Hans: 美洲/圣保罗
            value: America/Sao_Paulo
          - icon: null
            label:
              en_US: Asia/Shanghai
              ja_JP: Asia/Shanghai
              pt_BR: Asia/Shanghai
              zh_Hans: 亚洲/上海
            value: Asia/Shanghai
          - icon: null
            label:
              en_US: Asia/Ho_Chi_Minh
              ja_JP: Asia/Ho_Chi_Minh
              pt_BR: Ásia/Ho Chi Minh
              zh_Hans: 亚洲/胡志明市
            value: Asia/Ho_Chi_Minh
          - icon: null
            label:
              en_US: Asia/Tokyo
              ja_JP: Asia/Tokyo
              pt_BR: Asia/Tokyo
              zh_Hans: 亚洲/东京
            value: Asia/Tokyo
          - icon: null
            label:
              en_US: Asia/Dubai
              ja_JP: Asia/Dubai
              pt_BR: Asia/Dubai
              zh_Hans: 亚洲/迪拜
            value: Asia/Dubai
          - icon: null
            label:
              en_US: Asia/Kolkata
              ja_JP: Asia/Kolkata
              pt_BR: Asia/Kolkata
              zh_Hans: 亚洲/加尔各答
            value: Asia/Kolkata
          - icon: null
            label:
              en_US: Asia/Seoul
              ja_JP: Asia/Seoul
              pt_BR: Asia/Seoul
              zh_Hans: 亚洲/首尔
            value: Asia/Seoul
          - icon: null
            label:
              en_US: Asia/Singapore
              ja_JP: Asia/Singapore
              pt_BR: Asia/Singapore
              zh_Hans: 亚洲/新加坡
            value: Asia/Singapore
          - icon: null
            label:
              en_US: Europe/London
              ja_JP: Europe/London
              pt_BR: Europe/London
              zh_Hans: 欧洲/伦敦
            value: Europe/London
          - icon: null
            label:
              en_US: Europe/Berlin
              ja_JP: Europe/Berlin
              pt_BR: Europe/Berlin
              zh_Hans: 欧洲/柏林
            value: Europe/Berlin
          - icon: null
            label:
              en_US: Europe/Moscow
              ja_JP: Europe/Moscow
              pt_BR: Europe/Moscow
              zh_Hans: 欧洲/莫斯科
            value: Europe/Moscow
          - icon: null
            label:
              en_US: Australia/Sydney
              ja_JP: Australia/Sydney
              pt_BR: Australia/Sydney
              zh_Hans: 澳大利亚/悉尼
            value: Australia/Sydney
          - icon: null
            label:
              en_US: Pacific/Auckland
              ja_JP: Pacific/Auckland
              pt_BR: Pacific/Auckland
              zh_Hans: 太平洋/奥克兰
            value: Pacific/Auckland
          - icon: null
            label:
              en_US: Africa/Cairo
              ja_JP: Africa/Cairo
              pt_BR: Africa/Cairo
              zh_Hans: 非洲/开罗
            value: Africa/Cairo
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: select
        params:
          format: ''
          timezone: ''
        provider_id: time
        provider_name: time
        provider_type: builtin
        selected: false
        title: 获取当前时间
        tool_configurations:
          format:
            type: mixed
            value: '%Y-%m-%d %H:%M:%S'
          timezone:
            type: constant
            value: UTC
        tool_description: 一个用于获取当前时间的工具。
        tool_label: 获取当前时间
        tool_name: current_time
        tool_parameters: {}
        type: tool
        version: '2'
      height: 114
      id: '1754999309447'
      position:
        x: 917.8466547894516
        y: -578.7596152853769
      positionAbsolute:
        x: 917.8466547894516
        y: -578.7596152853769
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import json\n\ndef transform_to_chapter_based_structure(source_data:\
          \ dict) -> list:\n    \"\"\"\n    将策略性搜索JSON转换为以章节为单位的、包含多个文档的列表结构。\n\n\
          \    Args:\n        source_data: 从V2.0 prompt生成的原始字典数据。\n\n    Returns:\n\
          \        一个列表，其中每个元素都是一个代表章节的字典。\n    \"\"\"\n    final_output_list = []\n\
          \    strategy_data = source_data.get(\"search_strategy_for_report\", {})\n\
          \n    # 预定义一个通用的local_queries，可以根据需要为每个章节定制\n    # 在这个例子中，我们为所有章节使用相同的local_queries\n\
          \    common_local_queries = [\n    ]\n\n    # 遍历每个章节的数据，将章节名作为doc_id\n \
          \   for chapter_id, chapter_content in strategy_data.items():\n        \n\
          \        # 为当前章节收集所有的web queries\n        current_chapter_web_queries =\
          \ []\n        if \"queries\" in chapter_content and chapter_content[\"queries\"\
          ]:\n            current_chapter_web_queries.extend(chapter_content[\"queries\"\
          ])\n        if \"supply_queries\" in chapter_content and chapter_content[\"\
          supply_queries\"]:\n            current_chapter_web_queries.extend(chapter_content[\"\
          supply_queries\"])\n        if \"demand_queries\" in chapter_content and\
          \ chapter_content[\"demand_queries\"]:\n            current_chapter_web_queries.extend(chapter_content[\"\
          demand_queries\"])\n\n        # 如果这个章节有查询，就创建一个文档\n        if current_chapter_web_queries:\n\
          \            chapter_doc = {\n                \"doc_id\": chapter_id, #\
          \ 使用章节名作为doc_id\n                \"local_queries\": common_local_queries,\n\
          \                \"web_queries\": current_chapter_web_queries\n        \
          \    }\n            final_output_list.append(chapter_doc)\n\n    return\
          \ final_output_list\n\ndef main(arg1: str) -> dict:\n    # 1. 将JSON字符串解析为Python字典\n\
          \    source_dict = json.loads(arg1)\n      # 2. 调用新的转换函数\n    transformed_data\
          \ = transform_to_chapter_based_structure(source_dict)\n    # 3. 将结果格式化为美观的JSON字符串\n\
          \    # final_json_output = json.dumps(transformed_data, indent=4, ensure_ascii=False)\n\
          \    return {\n        \"querier\": transformed_data,\n        \"querier_str\"\
          : str(transformed_data),\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          querier:
            children: null
            type: array[object]
          querier_str:
            children: null
            type: string
        selected: false
        title: 代码转化
        type: code
        variables:
        - value_selector:
          - '1754647350021'
          - querier_res
          value_type: string
          variable: arg1
      height: 52
      id: '1755255418099'
      position:
        x: 1465.8171732149956
        y: -1003.6184717443404
      positionAbsolute:
        x: 1465.8171732149956
        y: -1003.6184717443404
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: '%Y-%m-%d %H:%M:%S'
          form: form
          human_description:
            en_US: Time format in strftime standard.
            ja_JP: Time format in strftime standard.
            pt_BR: Time format in strftime standard.
            zh_Hans: strftime 标准的时间格式。
          label:
            en_US: Format
            ja_JP: Format
            pt_BR: Format
            zh_Hans: 格式
          llm_description: null
          max: null
          min: null
          name: format
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: UTC
          form: form
          human_description:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          label:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          llm_description: null
          max: null
          min: null
          name: timezone
          options:
          - icon: null
            label:
              en_US: UTC
              ja_JP: UTC
              pt_BR: UTC
              zh_Hans: UTC
            value: UTC
          - icon: null
            label:
              en_US: America/New_York
              ja_JP: America/New_York
              pt_BR: America/New_York
              zh_Hans: 美洲/纽约
            value: America/New_York
          - icon: null
            label:
              en_US: America/Los_Angeles
              ja_JP: America/Los_Angeles
              pt_BR: America/Los_Angeles
              zh_Hans: 美洲/洛杉矶
            value: America/Los_Angeles
          - icon: null
            label:
              en_US: America/Chicago
              ja_JP: America/Chicago
              pt_BR: America/Chicago
              zh_Hans: 美洲/芝加哥
            value: America/Chicago
          - icon: null
            label:
              en_US: America/Sao_Paulo
              ja_JP: America/Sao_Paulo
              pt_BR: América/São Paulo
              zh_Hans: 美洲/圣保罗
            value: America/Sao_Paulo
          - icon: null
            label:
              en_US: Asia/Shanghai
              ja_JP: Asia/Shanghai
              pt_BR: Asia/Shanghai
              zh_Hans: 亚洲/上海
            value: Asia/Shanghai
          - icon: null
            label:
              en_US: Asia/Ho_Chi_Minh
              ja_JP: Asia/Ho_Chi_Minh
              pt_BR: Ásia/Ho Chi Minh
              zh_Hans: 亚洲/胡志明市
            value: Asia/Ho_Chi_Minh
          - icon: null
            label:
              en_US: Asia/Tokyo
              ja_JP: Asia/Tokyo
              pt_BR: Asia/Tokyo
              zh_Hans: 亚洲/东京
            value: Asia/Tokyo
          - icon: null
            label:
              en_US: Asia/Dubai
              ja_JP: Asia/Dubai
              pt_BR: Asia/Dubai
              zh_Hans: 亚洲/迪拜
            value: Asia/Dubai
          - icon: null
            label:
              en_US: Asia/Kolkata
              ja_JP: Asia/Kolkata
              pt_BR: Asia/Kolkata
              zh_Hans: 亚洲/加尔各答
            value: Asia/Kolkata
          - icon: null
            label:
              en_US: Asia/Seoul
              ja_JP: Asia/Seoul
              pt_BR: Asia/Seoul
              zh_Hans: 亚洲/首尔
            value: Asia/Seoul
          - icon: null
            label:
              en_US: Asia/Singapore
              ja_JP: Asia/Singapore
              pt_BR: Asia/Singapore
              zh_Hans: 亚洲/新加坡
            value: Asia/Singapore
          - icon: null
            label:
              en_US: Europe/London
              ja_JP: Europe/London
              pt_BR: Europe/London
              zh_Hans: 欧洲/伦敦
            value: Europe/London
          - icon: null
            label:
              en_US: Europe/Berlin
              ja_JP: Europe/Berlin
              pt_BR: Europe/Berlin
              zh_Hans: 欧洲/柏林
            value: Europe/Berlin
          - icon: null
            label:
              en_US: Europe/Moscow
              ja_JP: Europe/Moscow
              pt_BR: Europe/Moscow
              zh_Hans: 欧洲/莫斯科
            value: Europe/Moscow
          - icon: null
            label:
              en_US: Australia/Sydney
              ja_JP: Australia/Sydney
              pt_BR: Australia/Sydney
              zh_Hans: 澳大利亚/悉尼
            value: Australia/Sydney
          - icon: null
            label:
              en_US: Pacific/Auckland
              ja_JP: Pacific/Auckland
              pt_BR: Pacific/Auckland
              zh_Hans: 太平洋/奥克兰
            value: Pacific/Auckland
          - icon: null
            label:
              en_US: Africa/Cairo
              ja_JP: Africa/Cairo
              pt_BR: Africa/Cairo
              zh_Hans: 非洲/开罗
            value: Africa/Cairo
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: select
        params:
          format: ''
          timezone: ''
        provider_id: time
        provider_name: time
        provider_type: builtin
        selected: false
        title: 获取当前时间
        tool_configurations:
          format:
            type: mixed
            value: '%Y-%m-%d %H:%M:%S'
          timezone:
            type: constant
            value: UTC
        tool_description: 一个用于获取当前时间的工具。
        tool_label: 获取当前时间
        tool_name: current_time
        tool_parameters: {}
        type: tool
        version: '2'
      height: 114
      id: '17552597178210'
      position:
        x: 666.2392434381495
        y: -1034.8971219166851
      positionAbsolute:
        x: 666.2392434381495
        y: -1034.8971219166851
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Markdown text
            ja_JP: Markdown text
            pt_BR: Markdown text
            zh_Hans: Markdown格式文本
          label:
            en_US: Markdown text
            ja_JP: Markdown text
            pt_BR: Markdown text
            zh_Hans: Markdown格式文本
          llm_description: ''
          max: null
          min: null
          name: md_text
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Filename of the output file
            ja_JP: Filename of the output file
            pt_BR: Filename of the output file
            zh_Hans: 输出文件名
          label:
            en_US: Filename of the output file
            ja_JP: Filename of the output file
            pt_BR: Filename of the output file
            zh_Hans: 输出文件名
          llm_description: ''
          max: null
          min: null
          name: output_filename
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        params:
          md_text: ''
          output_filename: ''
        provider_id: bowenliang123/md_exporter/md_exporter
        provider_name: bowenliang123/md_exporter/md_exporter
        provider_type: builtin
        selected: false
        title: Markdown 转 DOCX 文件
        tool_configurations: {}
        tool_description: 将 Markdown 转换为 DOCX 文件的工具
        tool_label: Markdown 转 DOCX 文件
        tool_name: md_to_docx
        tool_node_version: '2'
        tool_parameters:
          md_text:
            type: mixed
            value: '{{#1766335411658.result#}}'
          output_filename:
            type: mixed
            value: 人才需求分析报告
        type: tool
      height: 52
      id: '1757497049911'
      position:
        x: 1197.8779971386155
        y: -308.96887810534236
      positionAbsolute:
        x: 1197.8779971386155
        y: -308.96887810534236
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "# # -*- coding: utf-8 -*-\n# # 该版本不依赖 tiktoken 库，完全基于字符数估算和操作\n# from\
          \ typing import Dict, Any\n\n# def main(markdown_content: str) -> Dict[str,\
          \ Any]:\n#     \"\"\"\n#     通过估算检查输入文本的 token 数量，如果超过限制，则从中间裁剪以适应模型的上下文窗口。\n\
          #     注意：此版本不使用 tiktoken，所有计算都是基于字符数的粗略估算。\n\n#     Args:\n#         markdown_content\
          \ (str): 需要检查和可能需要裁剪的 Markdown 文本。\n\n#     Returns:\n#         Dict[str,\
          \ Any]: 包含裁剪后文本和处理状态的字典。\n#     \"\"\"\n#     # --- 1. 配置 Token 限制 ---\n\
          #     # 这些值可以根据您的具体模型和错误信息进行调整\n#     try:\n#         MAX_CONTEXT_TOKENS\
          \ = 258576 \n#         RESERVED_OUTPUT_TOKENS = 65501\n#         SAFETY_MARGIN\
          \ = 5000 \n#         MAX_INPUT_TOKENS = MAX_CONTEXT_TOKENS - RESERVED_OUTPUT_TOKENS\
          \ - SAFETY_MARGIN\n\n#         # 定义字符与 token 的估算比例 (一个 token 约等于 4 个英文字符)\n\
          #         CHAR_TO_TOKEN_RATIO = 4\n\n#         print(f\"[+] Dify Log: 模型总限制={MAX_CONTEXT_TOKENS},\
          \ 预留输出={RESERVED_OUTPUT_TOKENS}\")\n#         print(f\"[+] Dify Log: 计算得出最大允许输入\
          \ Token 数为: {MAX_INPUT_TOKENS}\")\n\n#     except Exception as e:\n#   \
          \      # 捕获可能的配置错误\n#         print(f\"[-] Dify Log: 配置初始化失败: {e}\")\n#\
          \         return {\n#             \"trimmed_markdown_content\": markdown_content,\n\
          #             \"status\": f\"Error: Configuration failed with exception:\
          \ {e}\",\n#             \"original_tokens\": -1,\n#             \"new_tokens\"\
          : -1,\n#             \"max_input_tokens\": -1\n#         }\n\n#     # ---\
          \ 2. 基于字符数估算 Token ---\n#     original_char_count = len(markdown_content)\n\
          #     input_token_count = original_char_count // CHAR_TO_TOKEN_RATIO\n#\
          \     print(f\"[~] Dify Log: 当前输入文本有 {original_char_count} 个字符。\")\n#  \
          \   print(f\"[~] Dify Log: 估算的输入 Token 数为: {input_token_count}\")\n\n\n\
          #     # --- 3. 判断是否需要裁剪 ---\n#     if input_token_count <= MAX_INPUT_TOKENS:\n\
          #         print(\"[+] Dify Log: 估算的 Token 数量在限制范围内，无需裁剪。\")\n#         return\
          \ {\n#             \"trimmed_markdown_content\": markdown_content,\n#  \
          \           \"status\": \"No trimming needed (based on character estimate).\"\
          ,\n#             \"original_tokens\": input_token_count,\n#            \
          \ \"new_tokens\": input_token_count, # 无需裁剪时，新旧 token 数一致\n#           \
          \  \"max_input_tokens\": MAX_INPUT_TOKENS\n#         }\n#     else:\n# \
          \        tokens_to_remove = input_token_count - MAX_INPUT_TOKENS\n#    \
          \     print(f\"[-] Dify Log: 估算的 Token 超出限制！需要移除约 {tokens_to_remove} 个 Token。\"\
          )\n        \n#         # --- 4. 执行基于字符的“中间裁切”策略 ---\n#         # 将需要移除的\
          \ token 数量转换回字符数量\n#         chars_to_remove = tokens_to_remove * CHAR_TO_TOKEN_RATIO\n\
          \        \n#         # 找到字符串的中心点\n#         mid_index = original_char_count\
          \ // 2\n        \n#         # 计算要移除的字符切片的起始和结束索引\n#         start_remove_index\
          \ = mid_index - chars_to_remove // 2\n#         end_remove_index = mid_index\
          \ + (chars_to_remove + 1) // 2 # +1处理奇数情况\n\n#         # 确保索引不会越界\n#   \
          \      start_remove_index = max(0, start_remove_index)\n#         end_remove_index\
          \ = min(original_char_count, end_remove_index)\n        \n#         if start_remove_index\
          \ >= end_remove_index:\n#              # 如果计算结果异常，则返回原始文本并附上警告\n#      \
          \        return {\n#                 \"trimmed_markdown_content\": markdown_content,\n\
          #                 \"status\": \"Warning: Calculated trimming resulted in\
          \ an invalid range. No changes made.\",\n#                 \"original_tokens\"\
          : input_token_count,\n#                 \"new_tokens\": input_token_count,\n\
          #                 \"max_input_tokens\": MAX_INPUT_TOKENS\n#            \
          \ }\n\n#         # 构造新的文本，并在中间插入一个标记\n#         truncation_marker = \"\\\
          n\\n... [部分内容因超长已从中间省略] ...\\n\\n\"\n#         trimmed_text = markdown_content[:start_remove_index]\
          \ + truncation_marker + markdown_content[end_remove_index:]\n        \n\
          #         new_char_count = len(trimmed_text)\n#         new_token_count\
          \ = new_char_count // CHAR_TO_TOKEN_RATIO\n#         print(f\"[+] Dify Log:\
          \ 裁剪完成。新的字符数为: {new_char_count}，新的估算 Token 数为: {new_token_count}\")\n\n\
          #         return {\n#             \"trimmed_markdown_content\": trimmed_text,\n\
          #             \"status\": f\"Trimmed from middle based on character count.\
          \ Removed approx. {tokens_to_remove} tokens.\",\n#             \"original_tokens\"\
          : input_token_count,\n#             \"new_tokens\": new_token_count,\n#\
          \             \"max_input_tokens\": MAX_INPUT_TOKENS\n#         }\n\n\n\n\
          \n# -*- coding: utf-8 -*-\n# -- Dify Code Block --\n# This version uses\
          \ the 'tiktoken' library for precise token counting and trimming.\n# Make\
          \ sure 'tiktoken' is installed in your Dify environment's Python packages.\n\
          # from typing import Dict, Any\n\n# try:\n#     import tiktoken\n# except\
          \ ImportError:\n#     # If tiktoken is not installed, raise an exception\
          \ to stop execution\n#     # and provide a clear error message in the Dify\
          \ logs.\n#     raise ImportError(\"The 'tiktoken' library is not installed.\
          \ Please add it to the Python packages in your Dify environment settings.\"\
          )\n\n# def main(markdown_content: str) -> Dict[str, Any]:\n#     \"\"\"\n\
          #     通过 tiktoken 精确检查输入文本的 token 数量，如果超过限制，则从中间裁剪以适应模型的上下文窗口。\n\n#    \
          \ Args:\n#         markdown_content (str): 需要检查和可能需要裁剪的 Markdown 文本。\n\n\
          #     Returns:\n#         Dict[str, Any]: 包含裁剪后文本和处理状态的字典。\n#     \"\"\"\
          \n#     # --- 1. 配置 Token 限制 (与原代码保持一致) ---\n#     MAX_CONTEXT_TOKENS =\
          \ 258576 \n#     RESERVED_OUTPUT_TOKENS = 65501\n#     SAFETY_MARGIN = 5000\
          \ \n#     MAX_INPUT_TOKENS = MAX_CONTEXT_TOKENS - RESERVED_OUTPUT_TOKENS\
          \ - SAFETY_MARGIN\n\n#     print(f\"[+] Dify Log: 模型总限制={MAX_CONTEXT_TOKENS},\
          \ 预留输出={RESERVED_OUTPUT_TOKENS}\")\n#     print(f\"[+] Dify Log: 计算得出最大允许输入\
          \ Token 数为: {MAX_INPUT_TOKENS}\")\n\n#     # --- 2. 初始化 tiktoken 编码器并精确计算\
          \ Token ---\n#     try:\n#         # 使用 cl100k_base 编码器，适用于 gpt-4, gpt-3.5-turbo,\
          \ text-embedding-ada-002 等模型\n#         encoding = tiktoken.get_encoding(\"\
          cl100k_base\")\n#     except Exception as e:\n#         print(f\"[-] Dify\
          \ Log: 初始化 tiktoken 编码器失败: {e}\")\n#         return {\n#             \"\
          trimmed_markdown_content\": markdown_content,\n#             \"status\"\
          : f\"Error: Failed to initialize tiktoken encoder: {e}\",\n#           \
          \  \"original_tokens\": -1, \"new_tokens\": -1, \"max_input_tokens\": MAX_INPUT_TOKENS\n\
          #         }\n\n#     # 对输入内容进行编码，得到 token ID 列表\n#     input_tokens_list\
          \ = encoding.encode(markdown_content)\n#     input_token_count = len(input_tokens_list)\n\
          #     print(f\"[~] Dify Log: [tiktoken] 精确计算的输入 Token 数为: {input_token_count}\"\
          )\n\n#     # --- 3. 判断是否需要裁剪 ---\n#     if input_token_count <= MAX_INPUT_TOKENS:\n\
          #         print(\"[+] Dify Log: [tiktoken] Token 数量在限制范围内，无需裁剪。\")\n#  \
          \       return {\n#             \"trimmed_markdown_content\": markdown_content,\n\
          #             \"status\": \"No trimming needed (based on precise tiktoken\
          \ count).\",\n#             \"original_tokens\": input_token_count,\n# \
          \            \"new_tokens\": input_token_count, # 无需裁剪时，新旧 token 数一致\n#\
          \             \"max_input_tokens\": MAX_INPUT_TOKENS\n#         }\n#   \
          \  else:\n#         tokens_to_remove = input_token_count - MAX_INPUT_TOKENS\n\
          #         print(f\"[-] Dify Log: [tiktoken] Token 超出限制！需要精确移除 {tokens_to_remove}\
          \ 个 Token。\")\n\n#         # --- 4. 执行基于 Token 的“中间裁切”策略 ---\n#        \
          \ # 找到 token 列表的中心点\n#         mid_index = len(input_tokens_list) // 2\n\
          \n#         # 计算要移除的 token 切片的起始和结束索引\n#         half_tokens_to_remove =\
          \ tokens_to_remove // 2\n#         start_remove_index = mid_index - half_tokens_to_remove\n\
          #         # 确保奇数个 token 也能被完全移除\n#         end_remove_index = start_remove_index\
          \ + tokens_to_remove\n\n#         # 从 token 列表中移除中间部分\n#         trimmed_tokens_list\
          \ = input_tokens_list[:start_remove_index] + input_tokens_list[end_remove_index:]\n\
          \n#         # 将裁剪后的 token 列表解码回文本\n#         # 注意：直接解码可能会导致UTF-8字符被截断而产生乱码，但\
          \ tiktoken 的 decode 通常能很好地处理\n#         # 更好的方式是分开解码再拼接，确保万无一失\n#      \
          \   first_part_text = encoding.decode(input_tokens_list[:start_remove_index])\n\
          #         second_part_text = encoding.decode(input_tokens_list[end_remove_index:])\n\
          \n#         truncation_marker = \"\\n\\n... [部分内容因超长已从中间省略] ...\\n\\n\"\n\
          #         trimmed_text = first_part_text + truncation_marker + second_part_text\n\
          \n#         # 重新计算裁剪后文本的 token 数，以获得最精确的结果（因为标记本身也占 token）\n#         new_token_count\
          \ = len(encoding.encode(trimmed_text))\n#         print(f\"[+] Dify Log:\
          \ 裁剪完成。新的精确 Token 数为: {new_token_count}\")\n\n#         return {\n#    \
          \         \"trimmed_markdown_content\": trimmed_text,\n#             \"\
          status\": f\"Trimmed from middle. Removed {tokens_to_remove} tokens.\",\n\
          #             \"original_tokens\": input_token_count,\n#             \"\
          new_tokens\": new_token_count,\n#             \"max_input_tokens\": MAX_INPUT_TOKENS\n\
          #         }\n\n\n# -*- coding: utf-8 -*-\n# 健壮性最终版：本版本在原有基础上增加了全局错误捕获和安全降级机制。\n\
          # 当主要逻辑遇到任何意外错误时，会切换到最简单的“字符数/4”模型进行强制截断，\n# 确保在任何情况下都能返回一个长度安全的结果，保障工作流的稳定运行。\n\
          \nfrom typing import Dict, Any\nimport math\n\ndef estimate_token_count_for_sandbox(text:\
          \ str) -> int:\n    \"\"\"\n    一个为沙箱环境设计的、可靠的 token 估算函数。\n    - 中文字符:\
          \ 1个字 ≈ 2个token (采用保守值确保安全)\n    - 其他字符 (英文、数字、空格等): 4个字符 ≈ 1个token\n  \
          \  \"\"\"\n    if not isinstance(text, str):\n        # 增加输入类型检查，防止非字符串输入导致下方循环报错\n\
          \        return 0\n\n    chinese_char_count = 0\n    other_char_count =\
          \ 0\n\n    for char in text:\n        # 使用Unicode范围判断是否为CJK统一表意文字 (覆盖绝大部分汉字)\n\
          \        if '\\u4e00' <= char <= '\\u9fff':\n            chinese_char_count\
          \ += 1\n        else:\n            other_char_count += 1\n    \n    chinese_tokens\
          \ = chinese_char_count * 2\n    other_tokens = math.ceil(other_char_count\
          \ / 4)\n    \n    total_tokens = chinese_tokens + other_tokens\n    return\
          \ int(total_tokens)\n\ndef main(markdown_content: str) -> Dict[str, Any]:\n\
          \    \"\"\"\n    在不依赖tiktoken的情况下，检查并裁剪超长文本，并包含错误降级处理机制。\n    \"\"\"\n \
          \   MAX_INPUT_TOKENS = 0  # 初始化以扩大作用域\n\n    # --- 1. 配置 Token 限制 ---\n\
          \    try:\n        MAX_CONTEXT_TOKENS = 258576 \n        RESERVED_OUTPUT_TOKENS\
          \ = 65501\n        SAFETY_MARGIN = 5000 \n        MAX_INPUT_TOKENS = MAX_CONTEXT_TOKENS\
          \ - RESERVED_OUTPUT_TOKENS - SAFETY_MARGIN\n\n        print(f\"[+] Dify\
          \ Log: 模型总限制={MAX_CONTEXT_TOKENS}, 预留输出={RESERVED_OUTPUT_TOKENS}, 最大输入={MAX_INPUT_TOKENS}\"\
          )\n\n    except Exception as e:\n        print(f\"[-] Dify Log: 配置初始化失败:\
          \ {e}\")\n        # 即使配置失败，也返回原始文本，避免工作流中断\n        return {\n         \
          \   \"trimmed_markdown_content\": markdown_content, \n            \"status\"\
          : f\"Error: Configuration failed: {e}\",\n            \"original_tokens\"\
          : -1, \n            \"new_tokens\": -1, \n            \"max_input_tokens\"\
          : -1\n        }\n\n    # --- 2. 主逻辑与错误捕获 ---\n    try:\n        original_char_count\
          \ = len(markdown_content)\n        input_token_count = estimate_token_count_for_sandbox(markdown_content)\n\
          \        print(f\"[~] Dify Log: 文本共 {original_char_count} 字符, 估算 Token 数为:\
          \ {input_token_count}\")\n\n        # --- 3. 判断是否需要裁剪 ---\n        if input_token_count\
          \ <= MAX_INPUT_TOKENS:\n            print(\"[+] Dify Log: Token 在限制内，无需裁剪。\"\
          )\n            return {\n                \"trimmed_markdown_content\": markdown_content,\
          \ \n                \"status\": \"No trimming needed.\",\n             \
          \   \"original_tokens\": input_token_count, \n                \"new_tokens\"\
          : input_token_count, \n                \"max_input_tokens\": MAX_INPUT_TOKENS\n\
          \            }\n        else:\n            # --- 4. 执行“中间裁切”（主方案） ---\n\
          \            tokens_to_remove = input_token_count - MAX_INPUT_TOKENS\n \
          \           print(f\"[-] Dify Log: Token 超出限制！需移除约 {tokens_to_remove} 个\
          \ Token。\")\n            \n            avg_char_per_token = original_char_count\
          \ / input_token_count if input_token_count > 0 else 2\n            chars_to_remove\
          \ = math.ceil(tokens_to_remove * avg_char_per_token)\n            \n   \
          \         mid_index = original_char_count // 2\n            start_remove_index\
          \ = max(0, mid_index - chars_to_remove // 2)\n            end_remove_index\
          \ = min(original_char_count, mid_index + (chars_to_remove + 1) // 2)\n\n\
          \            if start_remove_index >= end_remove_index:\n              \
          \   return {\n                    \"trimmed_markdown_content\": markdown_content,\
          \ \n                    \"status\": \"Warning: Trimming range invalid.\"\
          ,\n                    \"original_tokens\": input_token_count, \n      \
          \              \"new_tokens\": input_token_count, \n                   \
          \ \"max_input_tokens\": MAX_INPUT_TOKENS\n                }\n\n        \
          \    truncation_marker = \"\\n\\n... [部分内容因超长已从中间省略] ...\\n\\n\"\n     \
          \       trimmed_text = markdown_content[:start_remove_index] + truncation_marker\
          \ + markdown_content[end_remove_index:]\n            \n            new_token_count\
          \ = estimate_token_count_for_sandbox(trimmed_text)\n            print(f\"\
          [+] Dify Log: 裁剪完成。新估算 Token 数为: {new_token_count}\")\n\n            return\
          \ {\n                \"trimmed_markdown_content\": trimmed_text,\n     \
          \           \"status\": f\"Trimmed from middle. Removed approx. {tokens_to_remove}\
          \ tokens.\",\n                \"original_tokens\": input_token_count, \n\
          \                \"new_tokens\": new_token_count, \n                \"max_input_tokens\"\
          : MAX_INPUT_TOKENS\n            }\n\n    except Exception as e:\n      \
          \  # --- 5. 异常捕获与安全降级处理 ---\n        print(f\"[-] Dify Log: 主逻辑执行出现意外错误:\
          \ '{e}'. 启动安全降级裁剪模式。\")\n        \n        # 使用最保守的 字符/4 模型进行截断\n      \
          \  # 乘以4是为了将Token限制转换为大致的字符限制\n        target_char_count = int(MAX_INPUT_TOKENS\
          \ * 4)\n        \n        if len(markdown_content) > target_char_count:\n\
          \            # 采用最简单的末尾截断，确保不会出错\n            safe_trimmed_text = markdown_content[:target_char_count]\n\
          \            truncation_marker_safe = \"\\n\\n... [内容因程序意外错误被强制截断] ...\\\
          n\\n\"\n            safe_trimmed_text += truncation_marker_safe\n      \
          \      status_msg = f\"Error: Fallback trimming activated due to: {e}\"\n\
          \        else:\n            # 如果文本本身不长，但依然报错，说明是其他问题，返回原文\n            safe_trimmed_text\
          \ = markdown_content\n            status_msg = f\"Error: An unexpected error\
          \ occurred but no trimming was needed. Original error: {e}\"\n\n       \
          \ return {\n            \"trimmed_markdown_content\": safe_trimmed_text,\n\
          \            \"status\": status_msg,\n            \"original_tokens\": -1,\
          \  # 使用-1表示估算失败\n            \"new_tokens\": -1,       # 使用-1表示估算失败\n  \
          \          \"max_input_tokens\": MAX_INPUT_TOKENS\n        }\n"
        code_language: python3
        desc: ''
        outputs:
          max_input_tokens:
            children: null
            type: number
          new_tokens:
            children: null
            type: number
          original_tokens:
            children: null
            type: number
          status:
            children: null
            type: string
          trimmed_markdown_content:
            children: null
            type: string
        selected: false
        title: token量安全保证器
        type: code
        variables:
        - value_selector:
          - conversation
          - web_data
          value_type: string
          variable: markdown_content
      height: 52
      id: '1757507775635'
      position:
        x: 1213.0417311782915
        y: -578.7596152853769
      positionAbsolute:
        x: 1213.0417311782915
        y: -578.7596152853769
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import requests\nimport json\nfrom typing import List, Dict, Any\n\n\
          # ==============================================================================\n\
          # ----------------------------> 用户配置区 <---------------------------------\n\
          # ==============================================================================\n\
          CONFIG = {\n    \"API_BASE_URL\": \"http://119.45.167.133:7751\", # 提取基础URL，方便管理\n\
          \    \n    # 1. 认证相关配置\n    \"AUTH_DETAILS\": {\n        \"login\": \"xt666666\"\
          ,      # 您的登录账号\n        \"password\": \"123456\",    # 您的登录密码\n       \
          \ # 初始令牌（可选，可以留空）。如果提供，第一次请求会用它，过期后会自动刷新。\n        \"initial_token\": \"\
          eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMjAxMDExLCJyb2xlIjoxLCJpYXQiOjE3NjE3Mjg1NTAsImV4cCI6MTc2MTgxNDk1MH0.4YTszVwCiSZ3Ag-mDvvcCYPmIBoTWppnKBu9IpxguA0\"\
          \n    },\n\n    # 2. 功能接口路径\n    \"ENDPOINTS\": {\n        \"upload\": \"\
          /file/upload\",\n        \"sign_in\": \"/auth/sign_in\"\n    }\n}\n# ==============================================================================\n\
          # ---------------------------> 认证管理模块 <---------------------------------\n\
          # ==============================================================================\n\
          \nclass AuthManager:\n    \"\"\"\n    一个专门用于管理认证令牌的类。\n    - 负责存储当前有效的令牌。\n\
          \    - 负责在需要时调用API刷新令牌。\n    \"\"\"\n    def __init__(self, config: Dict[str,\
          \ Any]):\n        self.api_base_url = config[\"API_BASE_URL\"]\n       \
          \ self.sign_in_endpoint = config[\"ENDPOINTS\"][\"sign_in\"]\n        self.credentials\
          \ = config[\"AUTH_DETAILS\"]\n        self.token = self.credentials.get(\"\
          initial_token\") # 使用初始令牌\n\n    def get_headers(self) -> Dict[str, str]:\n\
          \        \"\"\"获取带有当前 Authorization Token 的请求头\"\"\"\n        if not self.token:\n\
          \            print(\"当前无可用Token，立即尝试刷新。\")\n            self.refresh_token()\n\
          \        return {'Authorization': f'Bearer {self.token}'}\n\n    def refresh_token(self):\n\
          \        \"\"\"\n        请求新的认证令牌并更新到实例中。\n        \"\"\"\n        print(\"\
          --- 开始刷新认证令牌 ---\")\n        refresh_url = f\"{self.api_base_url}{self.sign_in_endpoint}\"\
          \n        payload = {\n            'login': self.credentials['login'],\n\
          \            'password': self.credentials['password']\n        }\n     \
          \   headers = {'Content-Type': 'application/x-www-form-urlencoded'}\n\n\
          \        try:\n            response = requests.post(refresh_url, data=payload,\
          \ headers=headers, timeout=30)\n            response.raise_for_status()\n\
          \            response_data = response.json()\n\n            if response_data.get(\"\
          status\") and 'data' in response_data and 'token' in response_data['data']:\n\
          \                self.token = response_data['data']['token']\n         \
          \       print(f\"令牌刷新成功！新的令牌已存储。\")\n            else:\n               \
          \ raise Exception(f\"刷新令牌API返回错误: {response_data.get('message', '未知错误')}\"\
          )\n        except Exception as e:\n            print(f\"!!! 致命错误: 刷新令牌失败，程序无法继续。错误:\
          \ {e}\")\n            # 在一个关键任务中，如果连认证都失败了，就应该直接抛出异常中断执行\n            raise\
          \ e\n\n# ==============================================================================\n\
          # ---------------------------> 核心实现区 <---------------------------------\n\
          # ==============================================================================\n\
          \ndef main(input_files: List[Dict[str, Any]]) -> Dict[str, Any]:\n    \"\
          \"\"\n    主函数，处理文件上传，并内置令牌过期自动刷新重试逻辑。\n    \"\"\"\n    # 1. 输入验证\n    if\
          \ not isinstance(input_files, list):\n        raise TypeError(f\"输入应为文件数组\
          \ (List)，但收到了 {type(input_files)} 类型。\")\n\n    if not input_files:\n  \
          \      return {\"output_files\": [], \"markdown_output\": \"没有文件需要处理。\"\
          }\n\n    # 初始化认证管理器\n    auth_manager = AuthManager(CONFIG)\n    target_url\
          \ = f\"{CONFIG['API_BASE_URL']}{CONFIG['ENDPOINTS']['upload']}\"\n    processed_files\
          \ = []\n\n    # 2. 遍历处理每个文件\n    for index, file_obj in enumerate(input_files):\n\
          \        print(f\"--- 开始处理第 {index + 1} 个文件: {file_obj.get('filename')}\
          \ ---\")\n        updated_file_obj = file_obj.copy()\n\n        try:\n \
          \           # a. 参数校验 (逻辑不变)\n            dify_download_url = file_obj.get('url')\n\
          \            original_filename = file_obj.get('filename')\n            mime_type\
          \ = file_obj.get('mime_type')\n            if not all([dify_download_url,\
          \ original_filename, mime_type]):\n                raise ValueError(\"文件对象缺少\
          \ 'url', 'filename', 或 'mime_type' 关键字段。\")\n\n            # b. 下载文件 (逻辑不变)\n\
          \            print(\"步骤 1/3: 正在从Dify下载文件...\")\n            # ... (下载逻辑保持完全一致)\n\
          \            with requests.get(dify_download_url, stream=True, timeout=60)\
          \ as download_response:\n                download_response.raise_for_status()\n\
          \                file_content = download_response.content\n            \n\
          \            files_to_upload = {'file': (original_filename, file_content,\
          \ mime_type)}\n\n            # c. 上传文件 - 包含重试逻辑\n            print(\"步骤\
          \ 2/3: 正在上传文件...\")\n            try:\n                # 第一次尝试上传\n     \
          \           upload_response = requests.post(\n                    target_url,\
          \ \n                    headers=auth_manager.get_headers(), \n         \
          \           files=files_to_upload, \n                    timeout=120\n \
          \               )\n                upload_response.raise_for_status()\n\
          \            except requests.exceptions.HTTPError as e:\n              \
          \  # 关键：检查是否是401错误\n                if e.response.status_code == 401:\n\
          \                    print(\"上传失败 (401 Unauthorized)，疑似令牌过期。尝试刷新令牌并重试...\"\
          )\n                    auth_manager.refresh_token() # 刷新令牌\n           \
          \         print(\"重试上传...\")\n                    # 第二次尝试上传\n          \
          \          upload_response = requests.post(\n                        target_url,\
          \ \n                        headers=auth_manager.get_headers(), \n     \
          \                   files=files_to_upload, \n                        timeout=120\n\
          \                    )\n                    upload_response.raise_for_status()\
          \ # 如果再次失败，异常会向上抛出\n                else:\n                    # 如果是其他HTTP错误（如500,\
          \ 404等），直接抛出\n                    raise e\n            \n            # d.\
          \ 解析API响应 (逻辑不变)\n            response_data = upload_response.json()\n \
          \           print(\"上传成功，API返回:\", json.dumps(response_data, indent=2, ensure_ascii=False))\n\
          \            if response_data.get(\"status\") is True and 'data' in response_data\
          \ and 'url' in response_data['data']:\n                new_url = response_data['data']['url']\n\
          \                print(f\"步骤 3/3: 成功获取新URL: {new_url}\")\n             \
          \   updated_file_obj['url'] = new_url\n            else:\n             \
          \   raise Exception(f\"API响应格式不正确或状态为false。消息: {response_data.get('message')}\"\
          )\n\n        except Exception as e:\n            error_message = f\"处理文件时发生错误:\
          \ {e}\"\n            print(f\"错误: {error_message}\")\n            updated_file_obj['error']\
          \ = error_message\n\n        processed_files.append(updated_file_obj)\n\
          \        print(f\"--- 文件 {file_obj.get('filename')} 处理完毕 ---\\n\")\n\n \
          \   # 3. 生成 Markdown 字符串 (逻辑不变)\n    markdown_links = []\n    for file_data\
          \ in processed_files:\n        if 'error' not in file_data:\n          \
          \  filename = file_data.get('filename')\n            url = file_data.get('url')\n\
          \            if filename and url:\n                markdown_links.append(f\"\
          [{filename}]({url})\")\n    markdown_output_string = \"\\n\".join(markdown_links)\n\
          \n    # 4. 返回结果 (逻辑不变)\n    return {\n        \"output_files\": processed_files,\n\
          \        \"markdown_output\": markdown_output_string\n    }"
        code_language: python3
        outputs:
          markdown_output:
            children: null
            type: string
          output_files:
            children: null
            type: array[object]
        selected: false
        title: 传服务器
        type: code
        variables:
        - value_selector:
          - '1757497049911'
          - files
          value_type: array[file]
          variable: input_files
      height: 52
      id: '1761735212120'
      position:
        x: 1498.192053583558
        y: -308.96887810534236
      positionAbsolute:
        x: 1498.192053583558
        y: -308.96887810534236
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: 976618ba-ce05-453a-8c24-53c1c6a01b43
            value: 襄阳职业技术学院
            varType: string
            variable_selector:
            - '1754636636322'
            - school
          id: 'true'
          logical_operator: and
        selected: false
        title: 条件分支 3
        type: if-else
      height: 124
      id: '1761735753678'
      position:
        x: -456.7952504957166
        y: 357.5828495059124
      positionAbsolute:
        x: -456.7952504957166
        y: 357.5828495059124
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        author: Vampxgg
        desc: ''
        height: 1162
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"真实数据","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":null,"format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 3103
      height: 1162
      id: '1761736135525'
      position:
        x: -56.78778603083629
        y: -1288.2882842630725
      positionAbsolute:
        x: -56.78778603083629
        y: -1288.2882842630725
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 3103
    - data:
        answer: 收到文件{{#17617362738053.result#}}。
        desc: ''
        selected: false
        title: 已经收到文件 (1)
        type: answer
        variables: []
      height: 103
      id: '17617362738052'
      position:
        x: 1581.4457807769568
        y: 702.8515632343581
      positionAbsolute:
        x: 1581.4457807769568
        y: 702.8515632343581
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "def main(files) -> dict:\n    # 提取每个对象的 filename 字段\n    filenames\
          \ = [f.get(\"filename\", \"\") for f in files if isinstance(f, dict)]\n\
          \    \n    # 使用英文逗号连接\n    arg1 = \",\".join(filenames)\n    \n    return\
          \ {\n        \"result\": arg1\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: 获取文件名 (1)
        type: code
        variables:
        - value_selector:
          - sys
          - files
          value_type: array[file]
          variable: files
      height: 52
      id: '17617362738053'
      position:
        x: 479.4745333565843
        y: 758.6997957546344
      positionAbsolute:
        x: 479.4745333565843
        y: 758.6997957546344
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#1761741945019.result#}}'
        desc: ''
        selected: false
        title: 联网搜索 (1)
        type: answer
        variables: []
      height: 103
      id: '17617362738054'
      position:
        x: 1460.7548438968497
        y: 940.423402380192
      positionAbsolute:
        x: 1460.7548438968497
        y: 940.423402380192
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '176173627380513'
          - arry_str
          variable_selector:
          - conversation
          - docs
          write_mode: over-write
        selected: false
        title: 变量赋值 (1)
        type: assigner
        version: '2'
      height: 84
      id: '17617362738055'
      position:
        x: 1277.7620890068906
        y: 702.8515632343581
      positionAbsolute:
        x: 1277.7620890068906
        y: 702.8515632343581
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#17617436446190.result#}}'
        desc: ''
        selected: false
        title: 人才需求分析结果 (1)
        type: answer
        variables: []
      height: 103
      id: '17617362738057'
      position:
        x: 1760.7548438968497
        y: 1073.8894580209421
      positionAbsolute:
        x: 1760.7548438968497
        y: 1073.8894580209421
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: error:未知错误
        desc: ''
        selected: false
        title: 错误回复 (1)
        type: answer
        variables: []
      height: 100
      id: '17617362738059'
      position:
        x: 185.89674254086583
        y: 1215.6023854706302
      positionAbsolute:
        x: 185.89674254086583
        y: 1215.6023854706302
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1761741945019'
          - result
          variable_selector:
          - conversation
          - web_data
          write_mode: over-write
        selected: false
        title: 变量赋值 2 (1)
        type: assigner
        version: '2'
      height: 84
      id: '176173627380511'
      position:
        x: 1100.8368212663206
        y: 935.8286089602037
      positionAbsolute:
        x: 1100.8368212663206
        y: 935.8286089602037
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import requests\nimport io\nimport os\nfrom urllib.parse import urlparse\n\
          import time # 引入time模块，可以在批处理之间添加延时\n \n# 各文件类型的处理库\nimport docx\nimport\
          \ pandas as pd\nfrom pptx import Presentation\nimport pdfplumber\n \ndef\
          \ extract_content_from_url(url: str) -> str:\n    \"\"\"\n    根据给定的URL，下载文件并提取其文本内容。\n\
          \    支持的格式: .txt, .csv, .json, .md, .docx, .xlsx, .pptx, .pdf\n \n    Args:\n\
          \        url (str): 文件的公开URL链接。\n \n    Returns:\n        str: 提取出的文本内容，如果失败或不支持则返回错误信息。\n\
          \    \"\"\"\n    print(f\"[*] 正在处理URL: {url}\")\n \n    try:\n        #\
          \ 1. 下载文件\n        # 添加headers模拟浏览器，可以提高成功率\n        headers = {\n     \
          \       'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\
          \ (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'\n        }\n \
          \       response = requests.get(url, timeout=30, headers=headers)\n    \
          \    response.raise_for_status() # 检查请求是否成功 (非2xx状态码会引发HTTPError)\n    \
          \    print(\"[+] 文件下载成功\")\n \n        file_in_memory = io.BytesIO(response.content)\n\
          \ \n        # 2. 识别文件类型\n        path = urlparse(url).path\n        ext\
          \ = os.path.splitext(path)[1].lower()\n        \n        # 如果URL没有后缀，尝试从响应头中识别\n\
          \        if not ext:\n            content_type = response.headers.get('Content-Type',\
          \ '')\n            print(f\"[*] URL无后缀，检查Content-Type: {content_type}\"\
          )\n            if 'pdf' in content_type: ext = '.pdf'\n            elif\
          \ 'msword' in content_type: ext = '.doc' # 注意，这个库不支持.doc\n            elif\
          \ 'vnd.openxmlformats-officedocument.wordprocessingml.document' in content_type:\
          \ ext = '.docx'\n            elif 'vnd.openxmlformats-officedocument.spreadsheetml.sheet'\
          \ in content_type: ext = '.xlsx'\n            elif 'vnd.openxmlformats-officedocument.presentationml.presentation'\
          \ in content_type: ext = '.pptx'\n \n        print(f\"[*] 文件类型识别为: {ext}\"\
          )\n        \n        # 3. 根据不同类型进行内容提取\n        content = \"\"\n       \
          \ if ext in ['.txt', '.csv', '.json', '.md', '.html', '.xml']:\n       \
          \     content = response.content.decode('utf-8', errors='ignore')\n \n \
          \       elif ext == '.docx':\n            document = docx.Document(file_in_memory)\n\
          \            paragraphs = [p.text for p in document.paragraphs]\n      \
          \      content = \"\\n\".join(paragraphs)\n \n        elif ext == '.xlsx':\n\
          \            xls = pd.ExcelFile(file_in_memory)\n            for sheet_name\
          \ in xls.sheet_names:\n                df = pd.read_excel(xls, sheet_name=sheet_name)\n\
          \                content += f\"--- 工作表: {sheet_name} ---\\n{df.to_string()}\\\
          n\\n\"\n \n        elif ext == '.pptx':\n            prs = Presentation(file_in_memory)\n\
          \            for slide in prs.slides:\n                for shape in slide.shapes:\n\
          \                    if hasattr(shape, \"text\"):\n                    \
          \    content += shape.text + \"\\n\"\n \n        elif ext == '.pdf':\n \
          \           with pdfplumber.open(file_in_memory) as pdf:\n             \
          \   all_text = [page.extract_text() for page in pdf.pages if page.extract_text()]\n\
          \                content = \"\\n\".join(all_text)\n                    \
          \    \n        else:\n            return f\"错误：不支持或无法识别的文件类型 '{ext}'。\"\n\
          \ \n        print(\"[+] 内容提取完成！\")\n        return content.strip()\n \n\
          \    except requests.exceptions.HTTPError as e:\n        return f\"错误：HTTP请求失败\
          \ - {e.response.status_code} {e.response.reason} for URL: {url}\"\n    except\
          \ requests.exceptions.RequestException as e:\n        return f\"错误：网络请求失败\
          \ - {e}\"\n    except Exception as e:\n        return f\"错误：处理文件时发生未知错误\
          \ - {e}\"\n \n# --- 您要求的批处理函数 ---\n \ndef main(files: list) -> dict:\n \
          \   \"\"\"\n    批量处理文件对象列表，提取每个文件URL指向的内容。\n \n    Args:\n        files\
          \ (list): 对象列表，每个对象都应有 .url 属性。\n                      例如: [File(url='http://...'),\
          \ File(url='http://...')]\n \n    Returns:\n        dict: 包含所有处理结果的字典，格式如下:\n\
          \              {\n                  \"result\": [\n                    \
          \  {\"url\": \"url1\", \"content\": \"extracted_content1\"},\n         \
          \             {\"url\": \"url2\", \"content\": \"error_message2\"},\n  \
          \                    ...\n                  ]\n              }\n    \"\"\
          \"\n    results = []\n    arry_str=[]\n    total_files = len(files)\n  \
          \  print(f\"--- 开始批量处理 {total_files} 个文件 ---\")\n \n    for i, file_obj\
          \ in enumerate(files):\n        print(f\"\\n--- 正在处理第 {i + 1}/{total_files}\
          \ 个文件 ---\")\n        \n        # 健壮性检查：确保对象有url属性且不为空\n        # if not\
          \ hasattr(file_obj, 'url') or not getattr(file_obj, 'url'):\n        # \
          \    print(\"[!] 警告：输入对象格式不正确或URL为空，已跳过。\")\n        #     result_item =\
          \ {\n        #         \"url\": getattr(file_obj, 'url', 'URL缺失'),\n   \
          \     #         \"content\": \"错误：输入对象格式不正确或URL为空。\"\n        #     }\n\
          \        #     results.append(result_item)\n        #     continue\n   \
          \     \n        url = file_obj['url']\n        extracted_content = extract_content_from_url(url)\n\
          \        \n        result_item = {\n            \"url\": url,\n        \
          \    \"content\": extracted_content\n        }\n        results.append(result_item)\n\
          \        arry_str.append(extracted_content)\n        # 礼貌性地暂停一下，避免对服务器造成冲击\n\
          \        # time.sleep(1) \n \n    # print(\"\\n--- 所有文件处理完毕 ---\")\n   \
          \ # 返回您指定的最终格式\n    return {\"result\": results,\n            \"arry_str\"\
          :arry_str}"
        code_language: python3
        desc: ''
        outputs:
          arry_str:
            children: null
            type: array[string]
          result:
            children: null
            type: array[object]
        selected: false
        title: 文档提取 (1)
        type: code
        variables:
        - value_selector:
          - sys
          - files
          value_type: array[file]
          variable: files
      height: 52
      id: '176173627380513'
      position:
        x: 995.8083062026972
        y: 702.8515632343581
      positionAbsolute:
        x: 995.8083062026972
        y: 702.8515632343581
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '17617436446190'
          - result
          variable_selector:
          - conversation
          - md_content
          write_mode: over-write
        selected: false
        title: 变量赋值 3 (1)
        type: assigner
        version: '2'
      height: 84
      id: '176173627380514'
      position:
        x: 1400.8368212663206
        y: 1073.8894580209421
      positionAbsolute:
        x: 1400.8368212663206
        y: 1073.8894580209421
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#176173627380529.markdown_output#}}'
        desc: ''
        selected: false
        title: 导出文件 (1)
        type: answer
        variables: []
      height: 103
      id: '176173627380515'
      position:
        x: 1310.4789779884327
        y: 1221.0327580230687
      positionAbsolute:
        x: 1310.4789779884327
        y: 1221.0327580230687
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: d5f34988-6220-4148-a25c-637238ef540d
            value: '-1'
            varType: number
            variable_selector:
            - '176173627380517'
            - branch_to_run
          id: 'true'
          logical_operator: and
        - case_id: 29f81007-27dd-440a-b922-3bb64fef4b44
          conditions:
          - comparison_operator: '='
            id: 83fec8cd-8699-4065-ae39-bd3f8002ecb6
            value: '0'
            varType: number
            variable_selector:
            - '176173627380517'
            - branch_to_run
          id: 29f81007-27dd-440a-b922-3bb64fef4b44
          logical_operator: and
        - case_id: f4cd6161-255b-4e7f-b730-6799df894cd7
          conditions:
          - comparison_operator: '='
            id: c7f49bcf-5531-4433-8528-b6662ec0187a
            value: '1'
            varType: number
            variable_selector:
            - '176173627380517'
            - branch_to_run
          id: f4cd6161-255b-4e7f-b730-6799df894cd7
          logical_operator: and
        - case_id: f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc
          conditions:
          - comparison_operator: '='
            id: cd992d70-cca2-450b-bff5-cb2791599e71
            value: '2'
            varType: number
            variable_selector:
            - '176173627380517'
            - branch_to_run
          id: f0d07bf0-74f2-4e3c-b01c-e7b094b33fdc
          logical_operator: and
        - case_id: 2a1917a9-3a37-4e74-ae24-fba0fc5477c2
          conditions:
          - comparison_operator: '='
            id: 5ebc7765-4edd-474b-91a6-10961acddef9
            value: '3'
            varType: number
            variable_selector:
            - '176173627380517'
            - branch_to_run
          id: 2a1917a9-3a37-4e74-ae24-fba0fc5477c2
          logical_operator: and
        desc: ''
        selected: false
        title: 判断跳转分支 (1)
        type: if-else
      height: 316
      id: '176173627380516'
      position:
        x: 192.32662701842128
        y: 872.5962229557479
      positionAbsolute:
        x: 192.32662701842128
        y: 872.5962229557479
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "def main(target_index: str, end_index: int) -> dict:\n    \"\"\"\n\
          \    分支跳转判断函数\n    :param end_index: 用户最后会话执行到的分支编号\n    :param target_index:\
          \ 用户传的目标分支编号\n    :return: { \"branch_to_run\": int, \"msg\": str }\n  \
          \           branch_to_run = -1 表示不允许执行\n    \"\"\"\n    target_index = int(target_index)\n\
          \n    # 检查输入范围\n    if not (0 <= target_index <= 13):\n        return {\"\
          branch_to_run\": -1, \"msg\": f\"目标分支 {target_index} 超出范围\"}\n\n    # 回退：允许执行\n\
          \    if target_index <= end_index:\n        return {\"branch_to_run\": target_index,\
          \ \"msg\": \"\"}\n\n    # 正常向前：只能一步一步往前\n    if target_index == end_index\
          \ + 1:\n        return {\"branch_to_run\": target_index, \"msg\": \"\"}\n\
          \n    # 跳过中间分支 → 不允许\n    return {\"branch_to_run\": -1, \"msg\": f\"不能从\
          \ {end_index} 跳到 {target_index}，请按顺序执行\"}\n"
        code_language: python3
        desc: ''
        outputs:
          branch_to_run:
            children: null
            type: number
          msg:
            children: null
            type: string
        selected: false
        title: 计算跳转分支 (1)
        type: code
        variables:
        - value_selector:
          - '1754636636322'
          - step
          value_type: string
          variable: target_index
        - value_selector:
          - conversation
          - end_index
          value_type: number
          variable: end_index
      height: 52
      id: '176173627380517'
      position:
        x: -78.88197140980265
        y: 872.5962229557479
      positionAbsolute:
        x: -78.88197140980265
        y: 872.5962229557479
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: error:你不能跳过步骤，请按照顺序步骤执行
        desc: ''
        selected: false
        title: 直接回复 (1)
        type: answer
        variables: []
      height: 116
      id: '176173627380518'
      position:
        x: 185.89674254086583
        y: 722.198119241822
      positionAbsolute:
        x: 185.89674254086583
        y: 722.198119241822
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "def main(branch_id: int, end_index: int, execution_history: list) ->\
          \ dict:\n    if branch_id is None:\n        raise ValueError(\"缺少 branch_id\
          \ 参数\")\n\n    # 更新 end_index\n    if branch_id >= end_index:\n        end_index\
          \ = branch_id\n    else:\n        # branch_id <= end_index，说明回退或访问之前节点，不更新\
          \ end_index\n        pass\n\n    execution_history.append(branch_id)\n\n\
          \    return {\n        \"message\": f\"分支 {branch_id} 执行完成，状态已更新\",\n  \
          \      \"end_index\": end_index,\n        \"execution_history\": execution_history\n\
          \    }\n"
        code_language: python3
        desc: ''
        outputs:
          end_index:
            children: null
            type: number
          execution_history:
            children: null
            type: array[number]
          message:
            children: null
            type: string
        selected: false
        title: 计算index和execution_history (1)
        type: code
        variables:
        - value_selector:
          - '176173627380517'
          - branch_to_run
          value_type: number
          variable: branch_id
        - value_selector:
          - conversation
          - end_index
          value_type: number
          variable: end_index
        - value_selector:
          - conversation
          - execution_history
          value_type: array[number]
          variable: execution_history
      height: 52
      id: '176173627380519'
      position:
        x: 2138.7401621672852
        y: 948.3256398903732
      positionAbsolute:
        x: 2138.7401621672852
        y: 948.3256398903732
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        items:
        - input_type: variable
          operation: over-write
          value:
          - '176173627380519'
          - end_index
          variable_selector:
          - conversation
          - end_index
          write_mode: over-write
        - input_type: variable
          operation: over-write
          value:
          - '176173627380519'
          - execution_history
          variable_selector:
          - conversation
          - execution_history
          write_mode: over-write
        selected: false
        title: 变量赋值 4 (1)
        type: assigner
        version: '2'
      height: 110
      id: '176173627380520'
      position:
        x: 2416.5091220369354
        y: 948.3256398903732
      positionAbsolute:
        x: 2416.5091220369354
        y: 948.3256398903732
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: not empty
            id: 9ff1c43c-46f3-42a5-8619-a83b1d1d7bbf
            value: ''
            varType: string
            variable_selector:
            - '17617362738053'
            - result
          id: 'true'
          logical_operator: and
        desc: ''
        selected: false
        title: 条件分支 2 (1)
        type: if-else
      height: 124
      id: '176173627380521'
      position:
        x: 733.3411765807368
        y: 746.198119241822
      positionAbsolute:
        x: 733.3411765807368
        y: 746.198119241822
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: 未检测出文件
        desc: ''
        selected: false
        title: 未收到文件 (1)
        type: answer
        variables: []
      height: 100
      id: '176173627380522'
      position:
        x: 1004.7526919340453
        y: 775.8756034269796
      positionAbsolute:
        x: 1004.7526919340453
        y: 775.8756034269796
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import requests\nfrom typing import Dict, Optional\n\nuser_token =\
          \ \"123456789\"  # 请赋值你的token\n\ndef main(md_content: str) -> Dict[str,\
          \ Optional[str]]:\n    api_url = \"http://119.45.167.133:17752/api/echarts/convert-markdown\"\
          \n    headers = {\n        \"Authorization\": f\"Bearer {user_token}\",\n\
          \        \"Content-Type\": \"application/json\"\n    }\n    payload = {\n\
          \        \"md_content\": md_content,\n    }\n\n    try:\n        response\
          \ = requests.post(api_url, headers=headers, json=payload, timeout=(10, 60))\n\
          \        response.raise_for_status()\n    except requests.RequestException\
          \ as e:\n        raise RuntimeError(f\"❌ 网络请求失败: {str(e)}\")\n\n    try:\n\
          \        result = response.json()\n    except ValueError:\n        raise\
          \ RuntimeError(\"❌ 返回内容非 JSON 格式\")\n\n    # 检查接口状态\n    if not result.get(\"\
          status\", True):\n        raise RuntimeError(f\"❌ 接口调用失败: {result.get('message',\
          \ '未知错误')}\")\n\n    data = result.get(\"data\", {})\n    if not isinstance(data,\
          \ dict):\n        raise RuntimeError(\"❌ 返回数据格式异常\")\n\n    return {\n \
          \        \"md_content\": data.get(\"md_content\")\n    }\n"
        code_language: python3
        desc: ''
        outputs:
          md_content:
            children: null
            type: string
        selected: false
        title: echart转图片 (1)
        type: code
        variables:
        - value_selector:
          - conversation
          - md_content
          value_type: string
          variable: md_content
      height: 52
      id: '176173627380523'
      position:
        x: 472.7998817886373
        y: 1221.0327580230687
      positionAbsolute:
        x: 472.7998817886373
        y: 1221.0327580230687
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: '%Y-%m-%d %H:%M:%S'
          form: form
          human_description:
            en_US: Time format in strftime standard.
            ja_JP: Time format in strftime standard.
            pt_BR: Time format in strftime standard.
            zh_Hans: strftime 标准的时间格式。
          label:
            en_US: Format
            ja_JP: Format
            pt_BR: Format
            zh_Hans: 格式
          llm_description: null
          max: null
          min: null
          name: format
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: UTC
          form: form
          human_description:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          label:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          llm_description: null
          max: null
          min: null
          name: timezone
          options:
          - icon: null
            label:
              en_US: UTC
              ja_JP: UTC
              pt_BR: UTC
              zh_Hans: UTC
            value: UTC
          - icon: null
            label:
              en_US: America/New_York
              ja_JP: America/New_York
              pt_BR: America/New_York
              zh_Hans: 美洲/纽约
            value: America/New_York
          - icon: null
            label:
              en_US: America/Los_Angeles
              ja_JP: America/Los_Angeles
              pt_BR: America/Los_Angeles
              zh_Hans: 美洲/洛杉矶
            value: America/Los_Angeles
          - icon: null
            label:
              en_US: America/Chicago
              ja_JP: America/Chicago
              pt_BR: America/Chicago
              zh_Hans: 美洲/芝加哥
            value: America/Chicago
          - icon: null
            label:
              en_US: America/Sao_Paulo
              ja_JP: America/Sao_Paulo
              pt_BR: América/São Paulo
              zh_Hans: 美洲/圣保罗
            value: America/Sao_Paulo
          - icon: null
            label:
              en_US: Asia/Shanghai
              ja_JP: Asia/Shanghai
              pt_BR: Asia/Shanghai
              zh_Hans: 亚洲/上海
            value: Asia/Shanghai
          - icon: null
            label:
              en_US: Asia/Ho_Chi_Minh
              ja_JP: Asia/Ho_Chi_Minh
              pt_BR: Ásia/Ho Chi Minh
              zh_Hans: 亚洲/胡志明市
            value: Asia/Ho_Chi_Minh
          - icon: null
            label:
              en_US: Asia/Tokyo
              ja_JP: Asia/Tokyo
              pt_BR: Asia/Tokyo
              zh_Hans: 亚洲/东京
            value: Asia/Tokyo
          - icon: null
            label:
              en_US: Asia/Dubai
              ja_JP: Asia/Dubai
              pt_BR: Asia/Dubai
              zh_Hans: 亚洲/迪拜
            value: Asia/Dubai
          - icon: null
            label:
              en_US: Asia/Kolkata
              ja_JP: Asia/Kolkata
              pt_BR: Asia/Kolkata
              zh_Hans: 亚洲/加尔各答
            value: Asia/Kolkata
          - icon: null
            label:
              en_US: Asia/Seoul
              ja_JP: Asia/Seoul
              pt_BR: Asia/Seoul
              zh_Hans: 亚洲/首尔
            value: Asia/Seoul
          - icon: null
            label:
              en_US: Asia/Singapore
              ja_JP: Asia/Singapore
              pt_BR: Asia/Singapore
              zh_Hans: 亚洲/新加坡
            value: Asia/Singapore
          - icon: null
            label:
              en_US: Europe/London
              ja_JP: Europe/London
              pt_BR: Europe/London
              zh_Hans: 欧洲/伦敦
            value: Europe/London
          - icon: null
            label:
              en_US: Europe/Berlin
              ja_JP: Europe/Berlin
              pt_BR: Europe/Berlin
              zh_Hans: 欧洲/柏林
            value: Europe/Berlin
          - icon: null
            label:
              en_US: Europe/Moscow
              ja_JP: Europe/Moscow
              pt_BR: Europe/Moscow
              zh_Hans: 欧洲/莫斯科
            value: Europe/Moscow
          - icon: null
            label:
              en_US: Australia/Sydney
              ja_JP: Australia/Sydney
              pt_BR: Australia/Sydney
              zh_Hans: 澳大利亚/悉尼
            value: Australia/Sydney
          - icon: null
            label:
              en_US: Pacific/Auckland
              ja_JP: Pacific/Auckland
              pt_BR: Pacific/Auckland
              zh_Hans: 太平洋/奥克兰
            value: Pacific/Auckland
          - icon: null
            label:
              en_US: Africa/Cairo
              ja_JP: Africa/Cairo
              pt_BR: Africa/Cairo
              zh_Hans: 非洲/开罗
            value: Africa/Cairo
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: select
        params:
          format: ''
          timezone: ''
        provider_id: time
        provider_name: time
        provider_type: builtin
        selected: false
        title: 获取当前时间 (1)
        tool_configurations:
          format:
            type: mixed
            value: '%Y-%m-%d %H:%M:%S'
          timezone:
            type: constant
            value: UTC
        tool_description: 一个用于获取当前时间的工具。
        tool_label: 获取当前时间
        tool_name: current_time
        tool_node_version: '2'
        tool_parameters: {}
        type: tool
        version: '2'
      height: 114
      id: '176173627380524'
      position:
        x: 762.2438185024539
        y: 1067.0743758049127
      positionAbsolute:
        x: 762.2438185024539
        y: 1067.0743758049127
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: '%Y-%m-%d %H:%M:%S'
          form: form
          human_description:
            en_US: Time format in strftime standard.
            ja_JP: Time format in strftime standard.
            pt_BR: Time format in strftime standard.
            zh_Hans: strftime 标准的时间格式。
          label:
            en_US: Format
            ja_JP: Format
            pt_BR: Format
            zh_Hans: 格式
          llm_description: null
          max: null
          min: null
          name: format
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: UTC
          form: form
          human_description:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          label:
            en_US: Timezone
            ja_JP: Timezone
            pt_BR: Timezone
            zh_Hans: 时区
          llm_description: null
          max: null
          min: null
          name: timezone
          options:
          - icon: null
            label:
              en_US: UTC
              ja_JP: UTC
              pt_BR: UTC
              zh_Hans: UTC
            value: UTC
          - icon: null
            label:
              en_US: America/New_York
              ja_JP: America/New_York
              pt_BR: America/New_York
              zh_Hans: 美洲/纽约
            value: America/New_York
          - icon: null
            label:
              en_US: America/Los_Angeles
              ja_JP: America/Los_Angeles
              pt_BR: America/Los_Angeles
              zh_Hans: 美洲/洛杉矶
            value: America/Los_Angeles
          - icon: null
            label:
              en_US: America/Chicago
              ja_JP: America/Chicago
              pt_BR: America/Chicago
              zh_Hans: 美洲/芝加哥
            value: America/Chicago
          - icon: null
            label:
              en_US: America/Sao_Paulo
              ja_JP: America/Sao_Paulo
              pt_BR: América/São Paulo
              zh_Hans: 美洲/圣保罗
            value: America/Sao_Paulo
          - icon: null
            label:
              en_US: Asia/Shanghai
              ja_JP: Asia/Shanghai
              pt_BR: Asia/Shanghai
              zh_Hans: 亚洲/上海
            value: Asia/Shanghai
          - icon: null
            label:
              en_US: Asia/Ho_Chi_Minh
              ja_JP: Asia/Ho_Chi_Minh
              pt_BR: Ásia/Ho Chi Minh
              zh_Hans: 亚洲/胡志明市
            value: Asia/Ho_Chi_Minh
          - icon: null
            label:
              en_US: Asia/Tokyo
              ja_JP: Asia/Tokyo
              pt_BR: Asia/Tokyo
              zh_Hans: 亚洲/东京
            value: Asia/Tokyo
          - icon: null
            label:
              en_US: Asia/Dubai
              ja_JP: Asia/Dubai
              pt_BR: Asia/Dubai
              zh_Hans: 亚洲/迪拜
            value: Asia/Dubai
          - icon: null
            label:
              en_US: Asia/Kolkata
              ja_JP: Asia/Kolkata
              pt_BR: Asia/Kolkata
              zh_Hans: 亚洲/加尔各答
            value: Asia/Kolkata
          - icon: null
            label:
              en_US: Asia/Seoul
              ja_JP: Asia/Seoul
              pt_BR: Asia/Seoul
              zh_Hans: 亚洲/首尔
            value: Asia/Seoul
          - icon: null
            label:
              en_US: Asia/Singapore
              ja_JP: Asia/Singapore
              pt_BR: Asia/Singapore
              zh_Hans: 亚洲/新加坡
            value: Asia/Singapore
          - icon: null
            label:
              en_US: Europe/London
              ja_JP: Europe/London
              pt_BR: Europe/London
              zh_Hans: 欧洲/伦敦
            value: Europe/London
          - icon: null
            label:
              en_US: Europe/Berlin
              ja_JP: Europe/Berlin
              pt_BR: Europe/Berlin
              zh_Hans: 欧洲/柏林
            value: Europe/Berlin
          - icon: null
            label:
              en_US: Europe/Moscow
              ja_JP: Europe/Moscow
              pt_BR: Europe/Moscow
              zh_Hans: 欧洲/莫斯科
            value: Europe/Moscow
          - icon: null
            label:
              en_US: Australia/Sydney
              ja_JP: Australia/Sydney
              pt_BR: Australia/Sydney
              zh_Hans: 澳大利亚/悉尼
            value: Australia/Sydney
          - icon: null
            label:
              en_US: Pacific/Auckland
              ja_JP: Pacific/Auckland
              pt_BR: Pacific/Auckland
              zh_Hans: 太平洋/奥克兰
            value: Pacific/Auckland
          - icon: null
            label:
              en_US: Africa/Cairo
              ja_JP: Africa/Cairo
              pt_BR: Africa/Cairo
              zh_Hans: 非洲/开罗
            value: Africa/Cairo
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: select
        params:
          format: ''
          timezone: ''
        provider_id: time
        provider_name: time
        provider_type: builtin
        selected: false
        title: 获取当前时间 (1)
        tool_configurations:
          format:
            type: mixed
            value: '%Y-%m-%d %H:%M:%S'
          timezone:
            type: constant
            value: UTC
        tool_description: 一个用于获取当前时间的工具。
        tool_label: 获取当前时间
        tool_name: current_time
        tool_node_version: '2'
        tool_parameters: {}
        type: tool
        version: '2'
      height: 114
      id: '176173627380526'
      position:
        x: 472.7998817886373
        y: 892.795524653862
      positionAbsolute:
        x: 472.7998817886373
        y: 892.795524653862
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        desc: ''
        is_team_authorization: true
        output_schema: null
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Markdown text
            ja_JP: Markdown text
            pt_BR: Markdown text
            zh_Hans: Markdown格式文本
          label:
            en_US: Markdown text
            ja_JP: Markdown text
            pt_BR: Markdown text
            zh_Hans: Markdown格式文本
          llm_description: ''
          max: null
          min: null
          name: md_text
          options: []
          placeholder: null
          precision: null
          required: true
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: Filename of the output file
            ja_JP: Filename of the output file
            pt_BR: Filename of the output file
            zh_Hans: 输出文件名
          label:
            en_US: Filename of the output file
            ja_JP: Filename of the output file
            pt_BR: Filename of the output file
            zh_Hans: 输出文件名
          llm_description: ''
          max: null
          min: null
          name: output_filename
          options: []
          placeholder: null
          precision: null
          required: false
          scope: null
          template: null
          type: string
        params:
          md_text: ''
          output_filename: ''
        provider_id: bowenliang123/md_exporter/md_exporter
        provider_name: bowenliang123/md_exporter/md_exporter
        provider_type: builtin
        selected: false
        title: Markdown 转 DOCX 文件 (1)
        tool_configurations: {}
        tool_description: 将 Markdown 转换为 DOCX 文件的工具
        tool_label: Markdown 转 DOCX 文件
        tool_name: md_to_docx
        tool_node_version: '2'
        tool_parameters:
          md_text:
            type: mixed
            value: '{{#176173627380523.md_content#}}'
          output_filename:
            type: mixed
            value: 人才需求分析报告
        type: tool
      height: 52
      id: '176173627380527'
      position:
        x: 750.935468811097
        y: 1221.0327580230687
      positionAbsolute:
        x: 750.935468811097
        y: 1221.0327580230687
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import requests\nimport json\nfrom typing import List, Dict, Any\n\n\
          # ==============================================================================\n\
          # ----------------------------> 用户配置区 <---------------------------------\n\
          # ==============================================================================\n\
          CONFIG = {\n    \"API_BASE_URL\": \"http://119.45.167.133:7751\", # 提取基础URL，方便管理\n\
          \    \n    # 1. 认证相关配置\n    \"AUTH_DETAILS\": {\n        \"login\": \"xt666666\"\
          ,      # 您的登录账号\n        \"password\": \"123456\",    # 您的登录密码\n       \
          \ # 初始令牌（可选，可以留空）。如果提供，第一次请求会用它，过期后会自动刷新。\n        \"initial_token\": \"\
          eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIwMjAxMDExLCJyb2xlIjoxLCJpYXQiOjE3NjE3Mjg1NTAsImV4cCI6MTc2MTgxNDk1MH0.4YTszVwCiSZ3Ag-mDvvcCYPmIBoTWppnKBu9IpxguA0\"\
          \n    },\n\n    # 2. 功能接口路径\n    \"ENDPOINTS\": {\n        \"upload\": \"\
          /file/upload\",\n        \"sign_in\": \"/auth/sign_in\"\n    }\n}\n# ==============================================================================\n\
          # ---------------------------> 认证管理模块 <---------------------------------\n\
          # ==============================================================================\n\
          \nclass AuthManager:\n    \"\"\"\n    一个专门用于管理认证令牌的类。\n    - 负责存储当前有效的令牌。\n\
          \    - 负责在需要时调用API刷新令牌。\n    \"\"\"\n    def __init__(self, config: Dict[str,\
          \ Any]):\n        self.api_base_url = config[\"API_BASE_URL\"]\n       \
          \ self.sign_in_endpoint = config[\"ENDPOINTS\"][\"sign_in\"]\n        self.credentials\
          \ = config[\"AUTH_DETAILS\"]\n        self.token = self.credentials.get(\"\
          initial_token\") # 使用初始令牌\n\n    def get_headers(self) -> Dict[str, str]:\n\
          \        \"\"\"获取带有当前 Authorization Token 的请求头\"\"\"\n        if not self.token:\n\
          \            print(\"当前无可用Token，立即尝试刷新。\")\n            self.refresh_token()\n\
          \        return {'Authorization': f'Bearer {self.token}'}\n\n    def refresh_token(self):\n\
          \        \"\"\"\n        请求新的认证令牌并更新到实例中。\n        \"\"\"\n        print(\"\
          --- 开始刷新认证令牌 ---\")\n        refresh_url = f\"{self.api_base_url}{self.sign_in_endpoint}\"\
          \n        payload = {\n            'login': self.credentials['login'],\n\
          \            'password': self.credentials['password']\n        }\n     \
          \   headers = {'Content-Type': 'application/x-www-form-urlencoded'}\n\n\
          \        try:\n            response = requests.post(refresh_url, data=payload,\
          \ headers=headers, timeout=30)\n            response.raise_for_status()\n\
          \            response_data = response.json()\n\n            if response_data.get(\"\
          status\") and 'data' in response_data and 'token' in response_data['data']:\n\
          \                self.token = response_data['data']['token']\n         \
          \       print(f\"令牌刷新成功！新的令牌已存储。\")\n            else:\n               \
          \ raise Exception(f\"刷新令牌API返回错误: {response_data.get('message', '未知错误')}\"\
          )\n        except Exception as e:\n            print(f\"!!! 致命错误: 刷新令牌失败，程序无法继续。错误:\
          \ {e}\")\n            # 在一个关键任务中，如果连认证都失败了，就应该直接抛出异常中断执行\n            raise\
          \ e\n\n# ==============================================================================\n\
          # ---------------------------> 核心实现区 <---------------------------------\n\
          # ==============================================================================\n\
          \ndef main(input_files: List[Dict[str, Any]]) -> Dict[str, Any]:\n    \"\
          \"\"\n    主函数，处理文件上传，并内置令牌过期自动刷新重试逻辑。\n    \"\"\"\n    # 1. 输入验证\n    if\
          \ not isinstance(input_files, list):\n        raise TypeError(f\"输入应为文件数组\
          \ (List)，但收到了 {type(input_files)} 类型。\")\n\n    if not input_files:\n  \
          \      return {\"output_files\": [], \"markdown_output\": \"没有文件需要处理。\"\
          }\n\n    # 初始化认证管理器\n    auth_manager = AuthManager(CONFIG)\n    target_url\
          \ = f\"{CONFIG['API_BASE_URL']}{CONFIG['ENDPOINTS']['upload']}\"\n    processed_files\
          \ = []\n\n    # 2. 遍历处理每个文件\n    for index, file_obj in enumerate(input_files):\n\
          \        print(f\"--- 开始处理第 {index + 1} 个文件: {file_obj.get('filename')}\
          \ ---\")\n        updated_file_obj = file_obj.copy()\n\n        try:\n \
          \           # a. 参数校验 (逻辑不变)\n            dify_download_url = file_obj.get('url')\n\
          \            original_filename = file_obj.get('filename')\n            mime_type\
          \ = file_obj.get('mime_type')\n            if not all([dify_download_url,\
          \ original_filename, mime_type]):\n                raise ValueError(\"文件对象缺少\
          \ 'url', 'filename', 或 'mime_type' 关键字段。\")\n\n            # b. 下载文件 (逻辑不变)\n\
          \            print(\"步骤 1/3: 正在从Dify下载文件...\")\n            # ... (下载逻辑保持完全一致)\n\
          \            with requests.get(dify_download_url, stream=True, timeout=60)\
          \ as download_response:\n                download_response.raise_for_status()\n\
          \                file_content = download_response.content\n            \n\
          \            files_to_upload = {'file': (original_filename, file_content,\
          \ mime_type)}\n\n            # c. 上传文件 - 包含重试逻辑\n            print(\"步骤\
          \ 2/3: 正在上传文件...\")\n            try:\n                # 第一次尝试上传\n     \
          \           upload_response = requests.post(\n                    target_url,\
          \ \n                    headers=auth_manager.get_headers(), \n         \
          \           files=files_to_upload, \n                    timeout=120\n \
          \               )\n                upload_response.raise_for_status()\n\
          \            except requests.exceptions.HTTPError as e:\n              \
          \  # 关键：检查是否是401错误\n                if e.response.status_code == 401:\n\
          \                    print(\"上传失败 (401 Unauthorized)，疑似令牌过期。尝试刷新令牌并重试...\"\
          )\n                    auth_manager.refresh_token() # 刷新令牌\n           \
          \         print(\"重试上传...\")\n                    # 第二次尝试上传\n          \
          \          upload_response = requests.post(\n                        target_url,\
          \ \n                        headers=auth_manager.get_headers(), \n     \
          \                   files=files_to_upload, \n                        timeout=120\n\
          \                    )\n                    upload_response.raise_for_status()\
          \ # 如果再次失败，异常会向上抛出\n                else:\n                    # 如果是其他HTTP错误（如500,\
          \ 404等），直接抛出\n                    raise e\n            \n            # d.\
          \ 解析API响应 (逻辑不变)\n            response_data = upload_response.json()\n \
          \           print(\"上传成功，API返回:\", json.dumps(response_data, indent=2, ensure_ascii=False))\n\
          \            if response_data.get(\"status\") is True and 'data' in response_data\
          \ and 'url' in response_data['data']:\n                new_url = response_data['data']['url']\n\
          \                print(f\"步骤 3/3: 成功获取新URL: {new_url}\")\n             \
          \   updated_file_obj['url'] = new_url\n            else:\n             \
          \   raise Exception(f\"API响应格式不正确或状态为false。消息: {response_data.get('message')}\"\
          )\n\n        except Exception as e:\n            error_message = f\"处理文件时发生错误:\
          \ {e}\"\n            print(f\"错误: {error_message}\")\n            updated_file_obj['error']\
          \ = error_message\n\n        processed_files.append(updated_file_obj)\n\
          \        print(f\"--- 文件 {file_obj.get('filename')} 处理完毕 ---\\n\")\n\n \
          \   # 3. 生成 Markdown 字符串 (逻辑不变)\n    markdown_links = []\n    for file_data\
          \ in processed_files:\n        if 'error' not in file_data:\n          \
          \  filename = file_data.get('filename')\n            url = file_data.get('url')\n\
          \            if filename and url:\n                markdown_links.append(f\"\
          [{filename}]({url})\")\n    markdown_output_string = \"\\n\".join(markdown_links)\n\
          \n    # 4. 返回结果 (逻辑不变)\n    return {\n        \"output_files\": processed_files,\n\
          \        \"markdown_output\": markdown_output_string\n    }"
        code_language: python3
        outputs:
          markdown_output:
            children: null
            type: string
          output_files:
            children: null
            type: array[object]
        selected: false
        title: 传服务器 (1)
        type: code
        variables:
        - value_selector:
          - '176173627380527'
          - files
          value_type: array[file]
          variable: input_files
      height: 52
      id: '176173627380529'
      position:
        x: 1024.5686011873113
        y: 1221.0327580230687
      positionAbsolute:
        x: 1024.5686011873113
        y: 1221.0327580230687
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        author: Vampxgg
        desc: ''
        height: 842
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"襄阳职业学校","type":"text","version":1}],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":null,"format":"","indent":0,"type":"root","version":1}}'
        theme: violet
        title: ''
        type: ''
        width: 3202
      height: 842
      id: '1761736317240'
      position:
        x: -137.04160514883756
        y: 591.7609050292439
      positionAbsolute:
        x: -137.04160514883756
        y: 591.7609050292439
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 3202
    - data:
        code: "import time\nimport json\n\ndef main() -> dict:\n  \"\"\"\n  Dify Code\
          \ Node Main Entry Point.\n  This function waits for 2 minutes and then returns\
          \ a predefined JSON string.\n  \n  :param input_str: The input string from\
          \ the upstream node. (Even if not used, it's required for triggering).\n\
          \  :return: A dictionary where the key 'result' contains the JSON string\
          \ output.\n  \"\"\"\n  \n  # 1. 模板数据定义\n  template_data = [{\"title\": \"\
          2024年中国智能网联汽车（ICV）市场现状及发展趋势研判\", \"source\": \"智研咨询\", \"snippet\": \"2019-2023年中国智能网联汽车市场规模\
          \ ... 智研咨询是中国领先产业咨询机构，提供深度产业研究报告、商业计划书、可行性研究报告及定制服务等一站式产业咨询 ...\", \"date\"\
          : \"\"}, {\"title\": \"2024年智能网联汽车行业市场前景及投资研究报告\", \"source\": \"网易\", \"\
          snippet\": \"2023年中国智能网联汽车市场规模为1613亿元，中国智能网联汽车市场渗透率也持续提升。 4.智能网联汽车行业上下游分析.\
          \ 智能网联汽车产销持续增长，对汽车关键零部件的 ...\", \"date\": \"\"}, {\"title\": \"2024年中国智能网联汽车（ICV）市场现状及发展趋势研判\"\
          , \"source\": \"智研咨询\", \"snippet\": \"2019-2023年中国智能网联汽车市场规模. 五、市场竞争格局及重点企业分析.\
          \ 1 ... 智研咨询是中国领先产业咨询机构，提供深度产业研究报告、商业计划书、可行性 ...\", \"date\": \"\"}, {\"\
          title\": \"2024年中国智能网联汽车行业市场前景预测研究报告（简版）\", \"source\": \"手机网易网\", \"snippet\"\
          : \"中商产业研究院发布的《2024-2029年中国智能网联汽车行业市场分析及前景研究报告》显示，2023年中国智能网联汽车市场规模达到约1613亿元，近五年年均复合\
          \ ...\", \"date\": \"\"}, {\"title\": \"智能网联汽车产业链全景图（2021年4月版）\", \"source\"\
          : \"中关村物联网产业联盟\", \"snippet\": \"智能网联汽车产业链全景图（2021年4月版）. 整车. 《中国新兴造车企业布局及智能\
          \ ... 《2019-2020车载毫米波雷达拆解与成本分析报告》. 《2020-2021年全球与中国汽车 ...\", \"date\": \"\
          \"}, {\"title\": \"智能网联汽车产业链全景图\", \"source\": \"前瞻网\", \"snippet\": \"\
          数据图表 行业分析 研究报告 免费报告 产业周报 企业数据大屏 产业链 产业热力图. 搜索. 智能网联汽车产业链全景图. 发布 ...\", \"\
          date\": \"\"}, {\"title\": \"2024年智能网联汽车（ICV）市场国内发展趋势研究及未来前景预测 ...\", \"\
          source\": \"格隆汇\", \"snippet\": \"报告分析了智能网联汽车（ICV）行业历史市场价值变化趋势、智能网联汽车（ICV）市场发展现状、当前竞争格局以及各主要企业市场表现、经营情况和发展优劣势等，最后预测了\
          \ ...\", \"date\": \"\"}, {\"title\": \"2024年车联网品牌有哪些车联网品牌龙头合集\", \"source\"\
          : \"中国报告大厅\", \"snippet\": \"车联网行业拥有众多品牌，如何选择一家有品质、信用与服务保障的品牌，成为了众多消费者非常关注的问题。百度apollo、腾讯车联、阿里云、华为HUAWEI、博泰PATEO、四维\
          \ ...\", \"date\": \"\"}, {\"title\": \"重塑尊严：制造业普工用工困局的系统破解之道\", \"source\"\
          : \"thinkvaughn.com\", \"snippet\": \"当天津发布制造业人才需求目录时，智能网联测试员与工程师并列其中；当\
          \ ... 北方人的夜生活 ，约等于零（武汉狼盟315花天酒地夜生活） · “若干”是 ...\", \"date\": \"\"}, {\"\
          title\": \"天津市24小时人工客服(天津地接旅行社电话一览表)2025年10月精选 ...\", \"source\": \"urkeji.com\"\
          , \"snippet\": \"... 2024年末增长了12%。乘联分会：反内卷浪潮正推动 ... 免费停车至少2小时，武汉15个商场开启停车优惠活动。\
          \ ... 萝卜快跑等企业持续招聘智能网联测试员、数据标注师 ...\", \"date\": \"\"}, {\"title\": \"重塑尊严：制造业普工用工困局的系统破解之道\"\
          , \"source\": \"thinkvaughn.com\", \"snippet\": \"当天津发布制造业人才需求目录时，智能网联测试员与工程师并列其中；当\
          \ ... 北方人的夜生活 ，约等于零（武汉狼盟315花天酒地夜生活） · “若干”是 ...\", \"date\": \"\"}, {\"\
          title\": \"天津市24小时人工客服(天津地接旅行社电话一览表)2025年10月精选 ...\", \"source\": \"urkeji.com\"\
          , \"snippet\": \"... 2023年同期25款）；新能源车的促销力度维持在10.7 ... 免费停车至少2小时，武汉15个商场开启停车优惠活动。\
          \ ... 萝卜快跑等企业持续招聘智能网联测试员、数据标注师 ...\", \"date\": \"\"}, {\"title\": \"自动驾驶工程师招聘信息\"\
          , \"source\": \"BOSS直聘\", \"snippet\": \"任职要求1. 至少具备C1驾照，实际驾龄3年以上，有优秀的安全驾驶意识和驾驶技能；\
          \ 2. 专科及以上学历，车辆、机械、计算机专业优先； 3. 1-5年以上实车. 自动驾驶测试工程师.\", \"date\": \"\"},\
          \ {\"title\": \"保隆科技：向不特定对象发行可转换公司债券证券募集说明书 ...\", \"source\": \"新浪网\",\
          \ \"snippet\": \"传感器自动标定技术, 针对不同传感器类型，采用自适应自动标定方法，标定精度高，稳定性好, 自主研发. DMS,\
          \ 非接触式的检测识别技术, 通过驾驶员面部特征 ...\", \"date\": \"\"}, {\"title\": \"150-200元/天智能网联汽车测试员（实习生）\"\
          , \"source\": \"BOSS直聘\", \"snippet\": \"本职位为人社部新公布的新职业之一，人工智能、智能驾驶方向岗位职责：\
          \ 1、根据产品设计和需求制定测试计划，设计用例，并参与用例执行过程；\", \"date\": \"\"}, {\"title\": \"「盐城大丰区技术研发岗（智能网联汽车）\
          \ ...\", \"source\": \"智联招聘\", \"snippet\": \"职位描述. 【岗位职责】. 1. 试验项目经理角色，带领服务团队进行智能网联相关试验工作；.\
          \ 2. 制定试验方案，协调测试车辆、设备、人员等资源；. 3. 监督试验进度，确保 ...\", \"date\": \"\"}, {\"title\"\
          : \"测试必备技能之ADAS智能驾驶测试设计篇原创\", \"source\": \"CSDN博客\", \"snippet\": \"ADAS\
          \ 集成了传感器、域控制器和软件算法，为驾驶员提供了自适应巡航、车道保持、紧急制动等多项智能辅助功能，将驾驶体验推向崭新的高度。\", \"date\"\
          : \"\"}, {\"title\": \"史上最全自动驾驶岗位介绍-List\", \"source\": \"知乎专栏\", \"snippet\"\
          : \"负责对标定参数进行相关车辆测试，给出测试报告。 ○ 技能要求：. ○ C++编程, 熟悉Linux及ROS系统；. ○ 有传感器标定工作经历，熟悉视觉或激光SLAM\
          \ ...\", \"date\": \"\"}, {\"title\": \"三明市思凯兰航空职业技术学校新能源汽车运用与维修主要就业方向 ...\"\
          , \"source\": \"0757bdqn.com\", \"snippet\": \"6. 智能网联与诊断技术. 岗位：车载系统诊断技师、智能网联测试员.\
          \ 工作内容 ... 职业发展路径清晰（如从技师晋升为技术主管或经理）。 建议. 在校期间可考取“新 ...\", \"date\": \"\"\
          }, {\"title\": \"工劳网｜工劳搜索：全国\", \"source\": \"工劳网\", \"snippet\": \"湖北省(43)\
          \ ... 网统计智联招聘历次发布的《中国企业招聘薪酬报告》 ... 近年来，盐城市委、市政府高度重视新能源汽车产业发展，专门出台《关于加快推进新能源及智能网联汽车\
          \ ...\", \"date\": \"\"}, {\"title\": \"工劳网｜工劳搜索：人工智能\", \"source\": \"\
          laborinfocn3.com\", \"snippet\": \"... 湖北省. 法规进行交通事故责任认定。发生道路交通事故并造成损害，依法应由智能网联汽车\
          \ ... 智联招聘今日公布“2024年第二季度《中国企业招聘薪酬报告》 ... 智联招聘平台 ...\", \"date\": \"\"},\
          \ {\"title\": \"工劳网｜工劳搜索：全国\", \"source\": \"laborinfocn5.com\", \"snippet\"\
          : \"湖北省(44). 湖南省(51). 广东省(319). 广西壮族自治区 ... 网统计智联招聘历次发布的《中国企业招聘薪酬报告》 ...\
          \ 智能网联汽车产业高质量发展的政策意见》，全力推动 ...\", \"date\": \"\"}, {\"title\": \"工劳搜索：人工\"\
          , \"source\": \"laborinfocn3.com\", \"snippet\": \"发生道路交通事故并造成损害，依法应由智能网联汽车一方承担责任的，由车辆\
          \ ... 智联招聘今日公布“2024年第二季度《中国企业招聘薪酬报告》”显示，在深圳， 人工 ...\", \"date\": \"\"},\
          \ {\"title\": \"2024私域人才需求与薪酬报告-见实科技&前程无忧\", \"source\": \"grcc.vip\", \"\
          snippet\": \"... 薪酬报告-见实科技&前程无忧. ... 2020年智能网联汽车-网联功能与应用(CFA)标准制定路线图(40页).\
          \ 396 0 30.00. 2020年智能网联汽车预期功能安全场景 ...\", \"date\": \"\"}, {\"title\": \"\
          见实携手前程无忧发布《2025私域人才需求与薪酬报告》_中国观察者网\", \"source\": \"guanchazhe.net\", \"\
          snippet\": \"12月5日,见实2024年度私域大会在上海圆满举办。 ... 此文仅供参考，不作买卖依据。 推荐内容. 见实携手前程无忧发布《2025私域人才需求与薪酬报告》\
          \ ... 抢占“智高点”！成都 ...\", \"date\": \"\"}, {\"title\": \"前程无忧2023离职与调薪调研报告.pdf\"\
          , \"source\": \"搜弘文库\", \"snippet\": \"前程无忧2023离职与调薪调研报告.pdf ... 比如高科技行业中人工智能、半导体、物联网等子行业，汽车行业中的新能源汽车、智能网联汽车等子行业。\
          \ ... 中国薪酬报告2025.pdf ...\", \"date\": \"\"}, {\"title\": \"工劳网｜工劳搜索：全国\"\
          , \"source\": \"laborinfocn5.com\", \"snippet\": \"网统计智联招聘历次发布的《中国企业招聘薪酬报告》\
          \ ... 近年来，盐城市委、市政府高度重视新能源汽车产业发展，专门出台《关于加快推进新能源及智能网联汽车 ... 明确自己拿不到 ...\"\
          , \"date\": \"\"}, {\"title\": \"无人驾驶人才需求旺盛，萝卜快跑等AI岗位扩招60%\", \"source\"\
          : \"知乎专栏\", \"snippet\": \"《无人驾驶汽车背后的“老司机”：智能网联汽车安全员测试员等“新职业”》）. 萝卜快跑的招聘中对具备出租车、公交车、网约车等运营经验的传统司机设有\
          \ ...\", \"date\": \"\"}, {\"title\": \"无人驾驶火热催生人才新需求百度AI岗位扩招六成- 北京\", \"\
          source\": \"京报网\", \"snippet\": \"随着业务覆盖范围的稳步扩大，其对AI人才的需求也将持续增长。 招聘平台Boss直聘信息显示，目前萝卜快跑已发布多个技术与运营类岗位，包括智能驾驶\
          \ ...\", \"date\": \"\"}, {\"title\": \"「BOSS直聘」24365校园招聘服务\", \"source\"\
          : \"BOSS直聘\", \"snippet\": \"热门校招 · 前端开发工程师-Flow 20-35K·15薪 · 26届AI领航员-大装置-云原生平台开发工程师\
          \ 28-35K·15薪 · 校招-算法工程师(A127217) 20-35K·16薪 · AI算法工程师/AI软件/AI ...\", \"\
          date\": \"\"}, {\"title\": \"2023职场红利盘点：当找工作不再是件容易事儿（全文版）\", \"source\"\
          : \"36Kr\", \"snippet\": \"回顾2023，职场Bonus为求职者、招聘人士盘出了8大求职找工作时可优先考虑的“元主题”。不过我们一直知道，这些主题听上去有点大，不够聚焦。\"\
          , \"date\": \"\"}, {\"title\": \"https://www.ep12.com/uploads/soft/230418/桂教职成〔2023...\"\
          , \"source\": \"ep12.com\", \"snippet\": \"为落实《教育部等四部门印发〈关于在院校实施“学历 ...\
          \ 国汽（北京）智能网联汽车研究院有限公司. 智能网联 ... 国汽（北京）智能网联汽车研究院有限公司. 智能网 ...\", \"date\"\
          : \"\"}, {\"title\": \"中心要闻cicv-pg电子夺宝试玩\", \"source\": \"neilsinghcomedy.com\"\
          , \"snippet\": \"... 教育部办公厅等四部门关于进一步做好在院校实施1 x证书制度试点有关经费 ... 智能网联汽车测试装调职业技能等级证书的考核费用进行了核算。经\
          \ ...\", \"date\": \"\"}, {\"title\": \"关于对省政协十三届二次会议第20240395号提案的答复\",\
          \ \"source\": \"湖北省教育厅\", \"snippet\": \"省教育厅专门印发《现代职业教育体系建设改革工程实施方案》（鄂教组秘〔2023〕\
          \ ... 将符合条件的职业教育产教融合项目纳入地方政府专项债券支持范围。对产教融合型 ...\", \"date\": \"\"}, {\"\
          title\": \"职业教育产教融合赋能提升行动实施方案（2023—2025年）\", \"source\": \"湖北工业大学\", \"\
          snippet\": \"... 产教融合赋能提升行动实施方案（2023—2025 年. ... 附件【《职业教育产教融合赋能提升行动实施方案（2023—2025年）》.pdf】已下载10\
          \ ...\", \"date\": \"\"}, {\"title\": \"职业教育产教融合赋能提升行动实施方案（2023—2025 年）\"\
          , \"source\": \"武汉交通职业学院\", \"snippet\": \"政策法规. 职业教育产教融合赋能提升行动实施方案（2023—2025\
          \ 年）. 2024-12-02 09:42. 职业教育产教融合赋能提升行动实施方案 ... 武汉交通职业学院 地址：湖北省武汉市 ...\"\
          , \"date\": \"\"}, {\"title\": \"职业教育产教融合赋能提升行动实施方案（2023—2025年）\", \"source\"\
          : \"湖北工业大学\", \"snippet\": \"职业教育产教融合赋能提升行动实施方案（2023—2025年）. 发表时间：2024-01-04\
          \ ... 附件【《职业教育产教融合赋能提升行动实施方案（2023—2025年）》.pdf】已下载 ...\", \"date\": \"\"\
          }, {\"title\": \"统计信息\", \"source\": \"湖北省教育厅\", \"snippet\": \"政府信息公开 ;\
          \ 2025年湖北省普通高等学校名单 2025-09-18 ; 2025年湖北省高等教育自考助学（非学历教育）机构名单 2025-09-18 ;\
          \ 湖北省普通高等职业学校专科专业目录 2025-08- ...\", \"date\": \"\"}, {\"title\": \"湖北省教育厅2024年政府信息公开工作年度报告\"\
          , \"source\": \"湖北省教育厅\", \"snippet\": \"湖北省教育厅2024年政府信息公开工作年度报告 ; 一、总体情况\
          \ ; 二、主动公开政府信息情况 ; 三、收到和处理政府信息公开申请情况 ; 四、政府信息公开行政复议 ...\", \"date\": \"\"\
          }, {\"title\": \"统计信息\", \"source\": \"湖北省教育厅\", \"snippet\": \"省教育厅省统计局省财政厅关于2023年全省教育经费执行情况统计公告\
          \ 2024-12-26 ... [有效]2015年湖北教育事业发展概况 2016-11-30; [有效]截至2016年8月底五年规划 ...\"\
          , \"date\": \"\"}, {\"title\": \"湖北省教育厅2023年政府信息公开工作年度报告\", \"source\":\
          \ \"湖北省教育厅\", \"snippet\": \"年度报告内容包括总体情况、主动公开政府信息情况、收到和处理政府信息公开申请情况、政府信息公开行政复议、行政诉讼情况、存在的主要问题及改进情况、\
          \ ...\", \"date\": \"\"}, {\"title\": \"猎聘：2022汽车行业人才数据报告\", \"source\"\
          : \"Scribd\", \"snippet\": \"2022 汽车行业人才数据报告分享. 猎聘大数据研究院. 2022.12. PART.01.\
          \ 汽车行业大变革. PART.02. 汽车人才大数据. PART.03. 汽车人才招聘策略 汽车百年变革黄金时代：智能 ...\", \"date\"\
          : \"\"}, {\"title\": \"Keyword Search - FHKI\", \"source\": \"香港工業總會\",\
          \ \"snippet\": \"Press releases related to FHKI affairs, activities and\
          \ industrial and business topics issued by FHKI.\", \"date\": \"\"}, {\"\
          title\": \"6 20【2025人工智能行业人才供需趋势报告】 | PDF\", \"source\": \"Scribd\", \"\
          snippet\": \"《智能网联汽车道路测试与示范应用管理规范(试行)》 2021年7月工信部.公安部 ... 武汉1.58% 绵阳0.97%\
          \ 深圳1.50% 武汉1.47% 郑州1.48% 杭州0.86% 武汉1.30% 郑州 ...\", \"date\": \"\"}, {\"\
          title\": \"猎聘：2022汽车行业人才数据报告\", \"source\": \"Scribd\", \"snippet\": \"\
          ... 人才紧缺指数（TSI指数）的高低受多维度因素影响，汽车人才TSI指数2020 ... 上海北京深圳杭州广州合肥重庆武汉南京郑州上海北京深圳广州杭州成都苏州武汉南京重庆.\"\
          , \"date\": \"\"}, {\"title\": \"6 20【2025人工智能行业人才供需趋势报告】 | PDF\", \"source\"\
          : \"Scribd\", \"snippet\": \"《智能网联汽车道路测试与示范应用管理规范(试行)》 2021年7月工信部.公安部 ...\
          \ 武汉1.58% 绵阳0.97% 深圳1.50% 武汉1.47% 郑州1.48% 杭州0.86% 武汉1.30% 郑州 ...\", \"date\"\
          : \"\"}, {\"title\": \"新能源汽车人才争夺愈演愈烈人才缺口将达百万量级_商业网-解读中国 ...\", \"source\"\
          : \"mbahome.com\", \"snippet\": \"分析机构认为，随着新能源汽车产业的快速发展，在未来的4到5年内，新能源及智能网联汽车\
          \ ... 人才紧缺指数整体稳中有升，人才处于供不应求态势 ... 【环球时快讯】山东男子去 ...\", \"date\": \"\"}, {\"\
          title\": \"FOURIN中国汽车调查月报\", \"source\": \"fourin.cn\", \"snippet\": \"\
          到2025年，智能网联汽车相关产业的市场规模预计将达到约5,000亿元。这一政策 ... 湖北省、湖南省、江西省同比2位数的增幅拉动下，正在成长为仅次于东部地区的重要\
          \ ...\", \"date\": \"\"}, {\"title\": \"2023年3月刊| PDF\", \"source\": \"\
          Scribd\", \"snippet\": \"该计划提出，到2025 年，嘉定区智能网联汽车相关产业规模将力争达到3000 亿元。 ...\
          \ 湖北省突破性发展新能源和智能网联汽. 车产业、建设万亿级汽车产业创新走廊注入 ...\", \"date\": \"\"}, {\"title\"\
          : \"2023年3月刊| PDF\", \"source\": \"Scribd\", \"snippet\": \"该计划提出，到2025\
          \ 年，嘉定区智能网联汽车相关产业规模将力争达到3000 亿元。 ... 湖北省突破性发展新能源和智能网联汽. 车产业、建设万亿级汽车产业创新走廊注入\
          \ ...\", \"date\": \"\"}, {\"title\": \"FOURIN中国汽车调查月报\", \"source\": \"\
          fourin.cn\", \"snippet\": \"到2025年，智能网联汽车相关产业的市场规模预计将达到约5,000亿元。这一政策 ...\
          \ 湖北省、湖南省、江西省同比2位数的增幅拉动下，正在成长为仅次于东部地区的重要 ...\", \"date\": \"\"}]\n\n  #\
          \ 2. 等待2分钟 (120秒)\n  # 警告：请确保您的Dify环境执行超时时间 > 120秒\n  time.sleep(5)\n\n\
          \  # 3. 将数据结构转换为JSON字符串\n  # ensure_ascii=False 保证中文字符正常显示\n  output_string\
          \ = json.dumps(template_data, ensure_ascii=False)\n\n  # 4. 关键：以Dify要求的字典格式返回输出\n\
          \  # 'result' 这个key必须与你在UI上定义的输出变量名完全一致\n  return {\n    'result': output_string\n\
          \  }\n\n"
        code_language: python3
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: 代码执行 21
        type: code
        variables: []
      height: 52
      id: '1761741945019'
      position:
        x: 796.1244425581468
        y: 935.8286089602037
      positionAbsolute:
        x: 796.1244425581468
        y: 935.8286089602037
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import time\nimport json\n\ndef main() -> dict:\n  \"\"\"\n  Dify Code\
          \ Node Main Entry Point.\n  This function waits for 2 minutes and then returns\
          \ a predefined JSON string.\n  \n  :param input_str: The input string from\
          \ the upstream node. (Even if not used, it's required for triggering).\n\
          \  :return: A dictionary where the key 'result' contains the JSON string\
          \ output.\n  \"\"\"\n  \n  # 1. 模板数据定义\n  template_data = \"### 封面页\\n<br>\\\
          n<br>\\n<br>\\n<br>\\n<br>\\n\\n<p align=\\\"center\\\">\\n  <span style=\\\
          \"font-size: 32px; font-weight: bold;\\\">智能网联汽车技术专业人才需求分析与产教融合诊断报告</span>\\\
          n</p>\\n<p align=\\\"center\\\">\\n  <span style=\\\"font-size: 20px;\\\"\
          >——基于大数据分析的深度洞察</span>\\n</p>\\n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\\
          n<br>\\n<p align=\\\"center\\\">\\n  <strong>学校：襄阳职业技术学院</strong>\\n</p>\\\
          n<p align=\\\"center\\\">\\n  <strong>撰写时间：2025年10月29日</strong>\\n</p>\\\
          n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\n<br>\\n\\\
          n---\\n### **第一章：调研概况**\\n\\n#### **（一）调研目的与意义**\\n\\n随着新一轮科技革命与产业变革的深度融合，智能网联汽车已上升为国家战略性新兴产业，并成为全球汽车产业转型升级的核心方向与未来竞争的制高点。本报告旨在通过对智能网联汽车产业，特别是**湖北省**区域内的人才需求进行系统性、前瞻性的数据挖掘与分析，为**襄阳职业技术学院**（以下简称“学校”）**智能网联汽车技术**专科专业的顶层设计与战略发展提供决策支持。\\\
          n\\n本次调研的战略价值与现实意义体现在三个层面：\\n\\n*   **宏观层面：响应国家与区域发展战略。** 报告紧密对接国家《中国制造2025》、工信部“车路云一体化”试点等重大战略部署，以及湖北省打造万亿级汽车产业走廊、将武汉建设成为国家级智能网联汽车示范区的宏伟目标。通过精准分析产业人才需求，助力学校的专业建设与国家及区域经济发展同频共振，为湖北省抢占智能网联汽车产业高地提供坚实的人才支撑。\\\
          n\\n*   **中观层面：支撑学校专业定位与特色发展。** 在职业教育高质量发展的背景下，本报告旨在为学校厘清【智能网联汽车技术】专业的市场定位，明确其在产业链中的独特价值。通过对标行业标杆企业与岗位需求，帮助学校在众多同类专业中形成差异化竞争优势，将有限的教育资源精准投向市场最需要、最具发展前景的人才培养方向。\\\
          n\\n*   **微观层面：指导课程体系与教学模式改革。** 报告将深入剖析目标岗位的知识、能力、素质结构，为学校的人才培养方案修订、课程体系优化、实训条件建设、师资队伍发展以及产教融合深化提供具体、可量化的数据依据。最终目标是破解应届毕业生“经验鸿沟”难题，实现人才培养供给侧与产业需求侧的无缝对接，显著提升毕业生的就业竞争力和职业发展潜力。\\\
          n\\n#### **（二）调研对象与内容**\\n\\n为确保分析的精准性与针对性，本次调研严格界定了研究对象与内容边界：\\n\\n*  \
          \ **行业范畴：** 聚焦于智能网联汽车（Intelligent Connected Vehicle, ICV）产业，涵盖其上游（感知、决策、执行、通信系统等关键软硬件）、中游（整车制造、智能驾驶解决方案集成）及下游（测试、运维、数据服务等）全产业链环节。\\\
          n*   **地域范围：** 以**湖北省**为核心分析区域，并辐射全国重点汽车产业集群，以提供更广阔的对标视野。\\n*   **目标岗位群：**\
          \ 重点研究与**专科**层次毕业生高度相关的技术技能型岗位，如智能网联汽车测试员、ADAS标定工程师、智能座舱系统维护员、车路协同设备运维员等。\\\
          n*   **核心分析模块：** 报告将系统覆盖行业发展趋势、目标岗位画像、人才能力需求图谱、区域产教匹配度诊断、专业建设对标等核心模块，形成从宏观产业洞察到微观教学建议的完整分析闭环。\\\
          n\\n#### **（三）调研方法与数据来源**\\n\\n为保证报告的科学性、客观性与前瞻性，本次调研采用了“混合研究方法”，有机结合了大数据分析与深度文本挖掘。\\\
          n\\n1.  **大数据挖掘分析：** 以大规模、多源异构的公开数据为基础，运用统计分析、趋势预测等模型，对产业人才需求的宏观态势、结构特征与薪酬水平进行量化分析。\\\
          n2.  **文本内容分析：** 借助自然语言处理（NLP）技术，对海量招聘文本进行深度解析，精准提取并量化岗位职责描述中的技能关键词、工具要求和素质能力，构建结构化的岗位能力图谱。\\\
          n\\n数据来源主要包括：\\n*   **招聘数据：** 主流招聘平台（如BOSS直聘、智联招聘、前程无忧等）发布的岗位信息。\\n*   **行业报告：**\
          \ 权威咨询机构（如智研咨询、中商产业研究院等）发布的行业研究报告与白皮书。\\n*   **政府公开数据：** 国家及地方政府（如工信部、湖北省人民政府、湖北省教育厅等）发布的产业规划、政策文件及统计公报。\\\
          n*   **企业公开信息：** 上市公司年报、招股说明书、官方网站等披露的业务布局与技术路线信息。\\n\\n#### **（四）样本情况说明**\\\
          n\\n本次分析的数据基础坚实可靠。研究团队在**2024年10月至2025年10月**期间，共采集和清洗了**湖北省**及周边核心区域与**智能网联汽车技术**专业相关的有效招聘岗位样本共计**35,728**条，覆盖相关企业**2,156**家。通过对这些一手数据进行深度清洗、去重与标准化处理，确保了本报告所有结论均建立在坚实的数据基础之上，为学校的战略决策提供了高置信度的参考。\\\
          n\\n---\\n### **第二章：行业发展现状与趋势**\\n\\n#### **（一）行业发展历程**\\n\\n智能网联汽车（ICV）的发展并非一蹴而就，而是历经了从单车智能到网联赋能的演进过程，其发展历程深刻影响了人才需求的结构变迁。\\\
          n\\n*   **萌芽探索期（20世纪80年代 - 2010年）：** 欧美发达国家率先开启无人驾驶技术研究。这一阶段的重点是基础的车辆自动化控制，核心驱动力源于学术界和少数研究机构的探索。相应地，人才需求高度集中于车辆工程、机械控制等传统工科领域的顶尖研究型人才，产业规模尚未形成。\\\
          n\\n*   **发展加速期（2010年 - 2020年）：** 随着人工智能与传感器技术的突破，以谷歌为代表的科技巨头入局，推动“自动驾驶”概念走向公众视野。约2015年起，中国将“智能网联汽车”作为国家战略方向，政策引导与资本投入双轮驱动，产业进入快速发展通道。这一时期，人才需求的重点从纯机械控制转向**“机械+电子+软件”的复合型人才**，对环境感知算法、决策规划、车载软件开发等能力的需求开始爆发，软件工程师和算法工程师成为市场新宠。\\\
          n\\n*   **融合变革期（2020年至今）：** 5G、云计算、大数据技术与汽车产业深度融合，“车-路-云”一体化成为行业共识。工信部等五部门联合推动的“车路云一体化”应用试点，标志着产业进入生态构建的新阶段。此阶段，人才需求发生深刻变革，**不仅需要精通单车智能的技术人才，更急需掌握V2X通信、云控平台、数据安全、高精地图等网联化、协同化技术的跨界人才**。对技术技能人才而言，岗位的内涵从车辆本身延伸至路侧设施和云端平台，催生了大量测试、运维、标定等新型技术技能岗位。\\\
          n\\n#### **（二）行业发展现状**\\n\\n##### **1. 行业政策背景**\\n\\n密集的政策支持是驱动中国智能网联汽车产业发展的核心引擎。国家及地方层面构筑了从顶层设计、标准制定到应用试点的全方位政策体系，为产业发展提供了强有力的方向指引和市场催化。\\\
          n\\n*   **顶层战略与标准引领：** 以《国家车联网产业标准体系建设指南（智能网联汽车）（2023版）》和《汽车行业稳增长工作方案(2023—2024年)》为代表的国家级文件，明确了技术路线图与发展目标。特别是提出到2025年系统形成支撑组合驾驶辅助和自动驾驶通用功能的标准体系，这直接催化了企业对**标准符合性测试、功能安全验证**等相关岗位的招聘需求，要求从业人员必须熟悉最新的国家和行业标准。\\\
          n\\n*   **应用试点与商业化加速：** 工信部等五部门联合开展的“车路云一体化”应用试点工作，在北京、**武汉**、福州等城市全面铺开，旨在推动智慧公交、自动驾驶出租车、智能物流等场景的规模化落地。这一举措极大地刺激了地方对**路侧单元（RSU）安装调试、云控平台运维、场景数据采集与标注、实地道路测试**等一线技术技能人才的需求，为职业院校毕业生提供了直接的就业市场。\\\
          n\\n*   **地方配套政策加持：** 湖北省作为汽车产业重镇，积极响应国家号召，出台一系列配套措施，如省教育厅印发的《现代职业教育体系建设改革工程实施方案》等文件，明确提出将符合条件的职业教育产教融合项目纳入地方政府专项债券支持范围，鼓励校企共建产业学院和实训基地。这为襄阳职业技术学院深化产教融合、获取更多资源支持，提供了坚实的政策保障。\\\
          n\\n##### **2. 行业发展现状（市场规模、竞争格局、地域分布）**\\n\\n在政策、技术和市场的多重驱动下，中国智能网联汽车产业正经历前所未有的高速增长，展现出巨大的市场潜力与活力。\\\
          n\\n分析显示，中国智能网联汽车市场规模实现了指数级增长。根据智研咨询和中商产业研究院的数据，市场规模从2019年的636亿元一路攀升，到2023年已突破1600亿元大关，达到1611亿元。进入2024年，市场继续保持强劲势头，规模预计将达到2152亿元。这一飞跃式增长的背后，是中国作为全球最大汽车市场（2023年产销量首破3000万辆）提供的广阔应用腹地，以及智能驾驶渗透率的快速提升。这对人才市场意味着，行业对各类人才的需求正从“增量”变为“海量”，为职业院校提供了广阔的舞台。\\\
          n\\n```echarts\\n{\\n  \\\"title\\\": {\\n    \\\"text\\\": \\\"中国智能网联汽车(ICV)市场规模高速增长\\\
          \",\\n    \\\"subtext\\\": \\\"数据来源：智研咨询、中商产业研究院\\\",\\n    \\\"left\\\"\
          : \\\"center\\\"\\n  },\\n  \\\"tooltip\\\": {\\n    \\\"trigger\\\": \\\
          \"axis\\\",\\n    \\\"axisPointer\\\": {\\n      \\\"type\\\": \\\"cross\\\
          \"\\n    }\\n  },\\n  \\\"legend\\\": {\\n    \\\"top\\\": \\\"bottom\\\"\
          ,\\n    \\\"data\\\": [\\\"市场规模（亿元）\\\"]\\n  },\\n  \\\"grid\\\": {\\n \
          \   \\\"left\\\": \\\"3%\\\",\\n    \\\"right\\\": \\\"4%\\\",\\n    \\\"\
          bottom\\\": \\\"10%\\\",\\n    \\\"containLabel\\\": true\\n  },\\n  \\\"\
          xAxis\\\": {\\n    \\\"type\\\": \\\"category\\\",\\n    \\\"boundaryGap\\\
          \": false,\\n    \\\"data\\\": [\\\"2019\\\", \\\"2020\\\", \\\"2021\\\"\
          , \\\"2022\\\", \\\"2023\\\", \\\"2024\\\"]\\n  },\\n  \\\"yAxis\\\": {\\\
          n    \\\"type\\\": \\\"value\\\",\\n    \\\"name\\\": \\\"亿元\\\",\\n   \
          \ \\\"axisLabel\\\": {\\n      \\\"formatter\\\": \\\"{value}\\\"\\n   \
          \ }\\n  },\\n  \\\"series\\\": [\\n    {\\n      \\\"name\\\": \\\"市场规模（亿元）\\\
          \",\\n      \\\"type\\\": \\\"line\\\",\\n      \\\"smooth\\\": true,\\\
          n      \\\"data\\\": [636, 848, 1077, 1275, 1611, 2152],\\n      \\\"markPoint\\\
          \": {\\n        \\\"data\\\": [\\n          { \\\"type\\\": \\\"max\\\"\
          , \\\"name\\\": \\\"最大值\\\" },\\n          { \\\"type\\\": \\\"min\\\",\
          \ \\\"name\\\": \\\"最小值\\\" }\\n        ]\\n      },\\n      \\\"markLine\\\
          \": {\\n        \\\"data\\\": [\\n          { \\\"type\\\": \\\"average\\\
          \", \\\"name\\\": \\\"平均值\\\" }\\n        ]\\n      },\\n      \\\"areaStyle\\\
          \": {}\\n    }\\n  ]\\n}\\n```\\n\\n从竞争格局来看，市场呈现出鲜明的“多元化”与“层次化”特征。第一梯队由**大型车企集团（如上汽、吉利、比亚迪）**和**科技巨头（如华为、百度）**构成，它们凭借雄厚的资本、强大的研发实力和资源整合能力，在高阶自动驾驶、智能座舱、车用操作系统等核心赛道构筑了高耸的竞争壁垒。第二梯队则由**造车新势力（如蔚来、小鹏）**和**专业技术供应商（如德赛西威）**组成，它们在特定细分领域通过技术创新寻求突破。这种格局启示我们，人才培养不应“一刀切”，既要培养能服务于大型企业体系化研发流程的技术人才，也要培养能适应初创公司灵活创新、快速迭代需求的多面手。\\\
          n\\n地域分布上，智能网联汽车产业资源高度集聚。数据显示，重点企业主要集中在**广东、上海、江苏、北京、浙江**等东部沿海地区。然而，**湖北省**凭借其雄厚的汽车工业基础和武汉作为国家级“车路云一体化”试点城市的战略地位，正在快速崛起，成为中部地区智能网联汽车产业发展的核心增长极。这对位于襄阳的学校而言，既面临着与省会武汉及东部发达地区的“人才虹吸”竞争，更迎来了服务本地及区域产业集群崛起的历史性机遇。\\\
          n\\n#### **（三）行业人才需求分析**\\n\\n智能网联汽车产业的蓬勃发展，正在重塑汽车行业的人才需求结构，呈现出复合化、高端化和应用型并重的特点。传统汽车行业以机械、车辆工程人才为主的局面被彻底打破，软件、算法、通信、数据等ICT领域人才大量涌入，成为推动产业创新的核心力量。\\\
          n\\n分析发现，行业人才需求金字塔结构日益清晰。塔尖是少数引领技术突破的科学家和顶尖架构师；塔身是大量的软件工程师、算法工程师、系统工程师等研发人才，他们是产业创新的中坚力量；而塔基则是规模庞大、需求旺盛的**应用型技术技能人才**，包括**智能网联汽车测试员、ADAS标定工程师、生产线智能设备操作员、车路协同系统运维员、数据采集与标注员**等。这一类人才是确保智能网联技术从研发走向大规模量产和应用落地的关键保障，其岗位职责与高等职业教育的培养目标高度契合。\\\
          n\\n尤其值得关注的是，随着L2+级智能驾驶功能成为新车标配，以及“车路云一体化”项目的推进，市场上对**测试验证、安装调试、维护保障**等环节的技术技能人才需求正迎来爆发式增长。企业不再仅仅需要能“造车”的人，更迫切需要能“验证车”、“调试车”、“保障车与路协同运行”的实操型人才。这对以培养技术技能人才为己任的专科层次院校，是明确的战略机遇。\\\
          n\\n#### **（四）行业发展趋势**\\n\\n展望未来3-5年，智能网联汽车产业将沿着“智能化”和“网联化”双螺旋路径持续深化，并呈现以下三大核心趋势，进而深刻影响人才需求的演变：\\\
          n\\n1.  **技术演进：从“辅助驾驶”迈向“人机共驾”。** 随着L3、L4级自动驾驶技术在特定场景（如高速公路、封闭园区、自动泊车）的逐步商业化，对系统的可靠性、安全性、体验感要求将达到前所未有的高度。这将驱动人才需求从单一功能开发，转向**多传感器融合感知、复杂场景决策规划、预期功能安全、网络安全**等更高阶、更复杂的领域。对技术技能人才而言，简单的功能“黑盒测试”将不再足够，**基于场景库的仿真测试、软硬件在环（HIL/SIL）测试、网络攻击与防御测试**等将成为必备技能。\\\
          n\\n2.  **生态融合：“车路云一体化”深度发展。** “聪明的车”需要“智慧的路”和“强大的云”来支撑。未来，路侧感知设备（激光雷达、摄像头）、边缘计算单元（MEC）、C-V2X通信网络将成为城市的新型基础设施。这将创造一个全新的、庞大的就业市场，对**路侧设备安装标定、网络联调联试、云控平台监控运维、V2X应用开发与测试**的人才需求将从无到有，并迅速增长。这为智能网联汽车技术专业开辟了超越车辆本身的广阔新方向。\\\
          n\\n3.  **人才结构：复合型与应用型人才缺口持续扩大。** 产业的跨界融合特性决定了单一技能背景的人才将难以适应未来发展。市场将更加青睐同时具备**汽车电子、计算机软件、通信技术和数据分析**等多领域知识的复合型人才。在专科层次，这意味着人才培养必须打破传统专业壁垒，构建模块化、跨学科的课程体系。同时，随着产业规模化、量产化进程的加速，对能够熟练使用专业工具、遵循标准流程、解决现场工程问题的**高素质应用型技术技能人才**的需求将持续处于高位，人才缺口将长期存在。\\\
          n\\n---\\n### **第三章：专业目标岗位筛选与确定**\\n\\n#### **（一）岗位筛选方法说明**\\n\\n为了科学、精准地为襄阳职业技术学院【智能网联汽车技术】专业（专科）锁定最具价值和最匹配的人才培养目标，本报告构建了“**T.P.D.S四维岗位筛选模型**”。该模型旨在从海量招聘数据中，筛选出最符合高职人才培养定位、与湖北省产业发展高度契合、且具备良好发展前景的核心技术技能岗位。\\\
          n\\n*   **T (Talent Demand Volume - 人才需求规模)：** 基于湖北省及核心辐射区域的招聘岗位数据，量化各岗位的需求数量。需求规模越大，表明该岗位市场容量广阔，是保障毕业生就业的基本盘。\\\
          n*   **P (Professional Relevance - 专业关联度)：** 评估岗位所需的核心技能与【智能网联汽车技术】专业的知识体系的匹配程度。关联度越高，意味着学校的课程设置能更有效地支撑该岗位的人才培养。\\\
          n*   **D (Development Prospect - 职业发展前景)：** 分析岗位的职业晋升路径和未来技术演进趋势。具备清晰晋升通道和良好成长空间的岗位，更能吸引优质生源，并保障毕业生长远的职业发展。\\\
          n*   **S (Salary Competitiveness - 薪酬竞争力)：** 考察岗位在湖北省地域范围内的薪酬水平，特别是起薪和1-3年经验的薪酬增长率。薪酬是衡量岗位价值和吸引力的重要市场信号。\\\
          n\\n通过对上述四个维度进行加权综合评估，本报告能够客观地识别出当前及未来3-5年内，最值得学校投入资源进行重点培养的目标岗位群。\\n\\\
          n#### **（二）关键指标分析**\\n\\n为了直观展示各备选岗位的市场定位，我们运用“T.P.D.S模型”对相关岗位进行量化分析，并以“人才需求规模”（横轴）、“平均薪酬水平”（纵轴）和“职业发展前景”（气泡大小）为关键指标，绘制了湖北省智能网联汽车技术技能岗位市场格局气泡图。\\\
          n\\n分析发现，各岗位在市场中呈现出明显的分化。其中，**“智能网联汽车测试员”**和**“ADAS标定工程师”**两个岗位脱颖而出，稳稳落入右上方的**“明星象限”**。这表明它们同时具备**高市场需求、高薪酬水平和广阔发展前景**的三重优势。深层原因在于，随着智能驾驶功能从“选配”变为“标配”，车辆上市前的测试验证与传感器标定工作量呈爆炸式增长，成为保障产品质量与安全的核心环节，企业愿意为此支付高溢价并大量招聘能够“即插即用”的技术技能人才。\\\
          n\\n与此同时，“数据采集/标注员”岗位位于“金牛象限”，需求量大但薪酬相对较低，技术门槛不高，可作为专业的辅助就业方向。而“智能硬件装配技工”等岗位虽然也与产业相关，但在薪酬和发展前景上不具备显著优势，不宜作为核心培养目标。\\\
          n\\n```echarts\\n{\\n  \\\"title\\\": {\\n    \\\"text\\\": \\\"湖北省智能网联汽车技术技能岗位市场格局（T.P.D.S模型）\\\
          \",\\n    \\\"left\\\": \\\"center\\\"\\n  },\\n  \\\"legend\\\": {\\n \
          \   \\\"right\\\": \\\"10%\\\",\\n    \\\"top\\\": \\\"10%\\\",\\n    \\\
          \"orient\\\": \\\"vertical\\\",\\n    \\\"data\\\": [\\\"明星象限岗\\\", \\\"\
          金牛象限岗\\\", \\\"潜力象限岗\\\", \\\"问题象限岗\\\"]\\n  },\\n  \\\"grid\\\": {\\n \
          \   \\\"left\\\": \\\"10%\\\",\\n    \\\"top\\\": \\\"20%\\\"\\n  },\\n\
          \  \\\"xAxis\\\": {\\n    \\\"name\\\": \\\"人才需求规模指数\\\",\\n    \\\"nameLocation\\\
          \": \\\"center\\\",\\n    \\\"nameGap\\\": 30,\\n    \\\"splitLine\\\":\
          \ {\\n      \\\"show\\\": true,\\n      \\\"lineStyle\\\": {\\n        \\\
          \"type\\\": \\\"dashed\\\"\\n      }\\n    },\\n    \\\"axisLabel\\\": {\\\
          n      \\\"formatter\\\": \\\"{value}\\\"\\n    }\\n  },\\n  \\\"yAxis\\\
          \": {\\n    \\\"name\\\": \\\"平均薪酬水平指数\\\",\\n    \\\"nameLocation\\\":\
          \ \\\"center\\\",\\n    \\\"nameGap\\\": 40,\\n    \\\"splitLine\\\": {\\\
          n      \\\"show\\\": true,\\n      \\\"lineStyle\\\": {\\n        \\\"type\\\
          \": \\\"dashed\\\"\\n      }\\n    },\\n    \\\"axisLabel\\\": {\\n    \
          \  \\\"formatter\\\": \\\"{value}\\\"\\n    }\\n  },\\n  \\\"visualMap\\\
          \": {\\n    \\\"show\\\": false,\\n    \\\"min\\\": 1,\\n    \\\"max\\\"\
          : 10,\\n    \\\"inRange\\\": {\\n      \\\"symbolSize\\\": [10, 80]\\n \
          \   }\\n  },\\n  \\\"series\\\": [\\n    {\\n      \\\"name\\\": \\\"明星象限岗\\\
          \",\\n      \\\"type\\\": \\\"scatter\\\",\\n      \\\"data\\\": [\\n  \
          \      { \\\"value\\\": [85, 80, 9], \\\"name\\\": \\\"智能网联汽车测试员\\\" },\\\
          n        { \\\"value\\\": [75, 78, 8], \\\"name\\\": \\\"ADAS标定工程师\\\" }\\\
          n      ],\\n      \\\"itemStyle\\\": {\\\"color\\\": \\\"#5470c6\\\"},\\\
          n      \\\"label\\\": { \\\"show\\\": true, \\\"formatter\\\": \\\"{b}\\\
          \", \\\"position\\\": \\\"top\\\" }\\n    },\\n    {\\n      \\\"name\\\"\
          : \\\"金牛象限岗\\\",\\n      \\\"type\\\": \\\"scatter\\\",\\n      \\\"data\\\
          \": [\\n        { \\\"value\\\": [90, 45, 4], \\\"name\\\": \\\"数据采集/标注员\\\
          \" }\\n      ],\\n      \\\"itemStyle\\\": {\\\"color\\\": \\\"#91cc75\\\
          \"},\\n      \\\"label\\\": { \\\"show\\\": true, \\\"formatter\\\": \\\"\
          {b}\\\", \\\"position\\\": \\\"top\\\" }\\n    },\\n    {\\n      \\\"name\\\
          \": \\\"潜力象限岗\\\",\\n      \\\"type\\\": \\\"scatter\\\",\\n      \\\"data\\\
          \": [\\n        { \\\"value\\\": [40, 92, 7], \\\"name\\\": \\\"V2X系统工程师\\\
          \" },\\n        { \\\"value\\\": [55, 70, 6], \\\"name\\\": \\\"智能座舱系统工程师\\\
          \" }\\n      ],\\n      \\\"itemStyle\\\": {\\\"color\\\": \\\"#fac858\\\
          \"},\\n      \\\"label\\\": { \\\"show\\\": true, \\\"formatter\\\": \\\"\
          {b}\\\", \\\"position\\\": \\\"top\\\" }\\n    },\\n    {\\n      \\\"name\\\
          \": \\\"问题象限岗\\\",\\n      \\\"type\\\": \\\"scatter\\\",\\n      \\\"data\\\
          \": [\\n        { \\\"value\\\": [30, 40, 3], \\\"name\\\": \\\"智能硬件装配技工\\\
          \" }\\n      ],\\n      \\\"itemStyle\\\": {\\\"color\\\": \\\"#ee6666\\\
          \"},\\n      \\\"label\\\": { \\\"show\\\": true, \\\"formatter\\\": \\\"\
          {b}\\\", \\\"position\\\": \\\"top\\\" }\\n    }\\n  ]\\n}\\n```\\n\\n####\
          \ **（三）目标岗位推荐**\\n\\n基于以上分析，本报告为襄阳职业技术学院【智能网联汽车技术】专业（专科）强烈推荐以下两个核心目标岗位，并建议将人才培养资源向其倾斜：\\\
          n\\n**1. 智能网联汽车测试员**\\n\\n*   **推荐理由：** 这是当前智能网联汽车实现量产和功能迭代过程中**需求量最大、最核心**的技术技能岗位之一。无论是整车厂、零部件供应商还是第三方检测机构，都需要大量的测试员执行功能测试、性能测试、场景测试和法规符合性测试。该岗位对专科生的实践动手能力、严谨细致的工作态度要求高，与职业教育的培养目标高度吻合。更重要的是，该岗位是深入了解智能驾驶系统全貌的绝佳入口，为毕业生未来向测试开发工程师、测试项目经理等更高阶职位发展奠定了坚实基础。\\\
          n\\n**2. ADAS（高级驾驶辅助系统）标定工程师**\\n\\n*   **推荐理由：** 摄像头、雷达等传感器是智能汽车的“眼睛”，其安装位置和参数的精确标定，直接决定了ADAS功能的性能和安全性。ADAS标定工程师负责在生产线、售后维修等环节，使用专业设备对传感器进行静态和动态标定。这是一个**技术壁垒相对较高、经验价值突出**的岗位。随着车辆传感器配置数量的增加和标定流程的日益复杂，经验丰富的标定工程师成为市场上的“香饽饽”，薪酬待遇优厚。培养此方向人才，能帮助学校建立鲜明的技术特色，毕业生具备“一技之长”，在就业市场上拥有不可替代的竞争力。\\\
          n\\n---\\n### **第四章：目标岗位人才需求大数据分析**\\n\\n本章节将聚焦于前述推荐的核心目标岗位——**智能网联汽车测试员**与**ADAS标定工程师**，通过对湖北省及周边区域的大数据进行深度挖掘，精确刻画其360度人才需求画像。\\\
          n\\n#### **（一）目标岗位人才需求概况**\\n\\n整体来看，智能网联汽车测试员和ADAS标定工程师在湖北省呈现出强劲且持续增长的人才需求态势。以省会武汉为核心的“武襄十随”汽车产业走廊，聚集了大量的整车厂、零部件供应商和研发中心，构成了需求的主力军。招聘企业类型多样，既包括东风、吉利等传统车企的智能网联部门，也涵盖了百度Apollo、华为车BU等科技公司，以及中汽研等第三方检测认证机构，为毕业生提供了丰富的就业选择。随着“车路云一体化”试点的深入，对这两个岗位的需求正从“整车厂”向“全产业链”扩散，市场前景极为广阔。\\\
          n\\n#### **（二）目标岗位人才需求特征分析**\\n\\n##### **1. 学历要求分析：专科学历是坚实的“敲门砖”**\\n\\\
          n分析显示，专科学历是进入智能网联汽车测试与标定领域的坚实“敲门砖”，占据了湖北地区相关技术技能岗位近五成的市场需求。数据显示，在目标岗位群中，明确要求“大专”学历的占比高达**48%**，与要求“本科”学历的**43%**基本持平，而对学历要求不限及硕士以上的合计仅占9%。这充分说明，企业在招聘一线技术技能岗位时，更看重应聘者的实际操作能力和岗位匹配度，而非唯学历论。这对于作为技术技能人才培养主阵地的襄阳职业技术学院而言是巨大的机遇，应坚定办学自信，将资源聚焦于强化学生的岗位核心技能。\\\
          n\\n```echarts\\n{\\n  \\\"title\\\": {\\n    \\\"text\\\": \\\"目标岗位学历要求分布：专科占据半壁江山\\\
          \",\\n    \\\"left\\\": \\\"center\\\"\\n  },\\n  \\\"tooltip\\\": {\\n\
          \    \\\"trigger\\\": \\\"item\\\"\\n  },\\n  \\\"legend\\\": {\\n    \\\
          \"orient\\\": \\\"vertical\\\",\\n    \\\"left\\\": \\\"left\\\"\\n  },\\\
          n  \\\"series\\\": [\\n    {\\n      \\\"name\\\": \\\"学历要求\\\",\\n    \
          \  \\\"type\\\": \\\"pie\\\",\\n      \\\"radius\\\": \\\"50%\\\",\\n  \
          \    \\\"data\\\": [\\n        { \\\"value\\\": 48, \\\"name\\\": \\\"大专\\\
          \" },\\n        { \\\"value\\\": 43, \\\"name\\\": \\\"本科\\\" },\\n    \
          \    { \\\"value\\\": 6, \\\"name\\\": \\\"不限\\\" },\\n        { \\\"value\\\
          \": 3, \\\"name\\\": \\\"硕士及以上\\\" }\\n      ],\\n      \\\"emphasis\\\"\
          : {\\n        \\\"itemStyle\\\": {\\n          \\\"shadowBlur\\\": 10,\\\
          n          \\\"shadowOffsetX\\\": 0,\\n          \\\"shadowColor\\\": \\\
          \"rgba(0, 0, 0, 0.5)\\\"\\n        }\\n      }\\n    }\\n  ]\\n}\\n```\\\
          n\\n##### **2. 经验要求分析：应届生面临显著“经验鸿沟”**\\n\\n然而，尽管专科生是招聘主体，但企业普遍青睐具备1-3年工作经验的成熟人才，这揭示了应届毕业生面临着显著的“经验鸿沟”。数据显示，要求“1-3年”工作经验的岗位占比高达**55%**，要求“3-5年”的也占到**22%**，而明确面向“应届生”或“经验不限”的岗位合计仅占**23%**。深层原因在于，智能网联汽车的测试与标定工作直接关系到产品安全，企业希望新员工能够“来了就能用”，最大限度缩短在岗培训周期，降低试错成本。这对学校的人才培养模式提出了严峻挑战，必须将“经验鸿沟”的弥合作为专业建设的核心目标。\\\
          n\\n```echarts\\n{\\n  \\\"title\\\": {\\n    \\\"text\\\": \\\"目标岗位工作经验要求分布\\\
          \",\\n    \\\"left\\\": \\\"center\\\"\\n  },\\n  \\\"tooltip\\\": {\\n\
          \    \\\"trigger\\\": \\\"axis\\\",\\n    \\\"axisPointer\\\": {\\n    \
          \  \\\"type\\\": \\\"shadow\\\"\\n    }\\n  },\\n  \\\"grid\\\": {\\n  \
          \  \\\"left\\\": \\\"3%\\\",\\n    \\\"right\\\": \\\"4%\\\",\\n    \\\"\
          bottom\\\": \\\"3%\\\",\\n    \\\"containLabel\\\": true\\n  },\\n  \\\"\
          xAxis\\\": {\\n    \\\"type\\\": \\\"value\\\",\\n    \\\"boundaryGap\\\"\
          : [0, 0.01]\\n  },\\n  \\\"yAxis\\\": {\\n    \\\"type\\\": \\\"category\\\
          \",\\n    \\\"data\\\": [\\\"5-10年\\\", \\\"3-5年\\\", \\\"1-3年\\\", \\\"\
          应届生/不限\\\"]\\n  },\\n  \\\"series\\\": [\\n    {\\n      \\\"name\\\": \\\
          \"岗位占比\\\",\\n      \\\"type\\\": \\\"bar\\\",\\n      \\\"data\\\": [5,\
          \ 22, 55, 23],\\n      \\\"label\\\": {\\n        \\\"show\\\": true,\\\
          n        \\\"position\\\": \\\"right\\\",\\n        \\\"formatter\\\": \\\
          \"{c}%\\\"\\n      }\\n    }\\n  ]\\n}\\n```\\n\\n##### **3. 学历与经验交叉分析：高职生的机遇与挑战**\\\
          n\\n进一步将学历与经验进行交叉分析，我们能更深刻地洞察高职毕业生的市场处境。在要求“1-3年经验”的岗位中，约有**60%**的岗位对学历要求为“大专及以上”，这意味着只要高职毕业生能够通过某种方式获得等效于1-3年的实践经验，他们就能与本科生在广阔的成熟人才市场上一较高下。这正是产教融合的价值所在：通过将企业真实项目、真实流程、真实工具引入校园，让学生在毕业时即拥有“准工作经验”，从而直接跨越“经验鸿沟”，进入就业的“主赛道”。\\\
          n\\n##### **4. 薪酬水平分析：技能价值驱动薪酬高增长**\\n\\n目标岗位的薪酬水平充分体现了其高技术技能价值，并呈现出经验驱动下的高增长曲线。在湖北地区，应届生的起薪普遍在**6k-8k/月**的区间，具备1-3年经验后，薪酬能迅速跃升至**9k-14k/月**，而拥有3-5年经验的资深测试员或标定工程师，月薪可达**15k-20k**以上。这种陡峭的薪酬增长曲线，强有力地证明了岗位实践经验的价值。学校应将此作为激励学生投身技能学习的有力宣传点，并以此为依据，引导学生树立合理的职业发展预期。\\\
          n\\n##### **5. 职业发展路径分析：从执行到管理的清晰通道**\\n\\n目标岗位的职业发展路径清晰，为学生提供了可持续的成长空间。以智能网联汽车测试员为例，其典型的晋升路径如下：\\\
          n\\n*   **初级测试员（0-1年）：** 核心任务是**执行**。根据测试用例，完成指定的测试任务，记录测试数据和现象，提交Bug报告。此阶段需掌握车辆基本驾驶技能、测试设备的基本操作和测试流程。\\\
          n*   **中级测试员/测试组长（1-3年）：** 核心任务是**设计与分析**。能够独立编写测试用例，搭建测试环境，对测试中发现的疑难问题进行初步分析和定位。此阶段需补充**测试策略设计、脚本编写（如Python）、车载总线技术（CAN/LIN）**等知识。\\\
          n*   **高级测试工程师/测试主管（3-5年及以上）：** 核心任务是**规划与管理**。负责制定整体测试方案和计划，进行测试团队管理、资源协调，并对新技术的测试方法进行研究（如自动化测试、仿真测试）。此阶段需要具备**项目管理、团队领导、自动化测试框架开发**等更高阶的能力。\\\
          n\\n学校在进行人才培养时，不仅要夯实学生在第一阶段的执行能力，更应在前瞻性地在课程中融入第二、三阶段所需的核心知识与技能，为学生的长远发展赋能。\\\
          n\\n#### **（三）目标岗位能力需求分析**\\n\\n通过对招聘岗位描述进行NLP文本分析，我们将能力需求解构为“技术技能”与“综合素质”两大维度，并构建了能力图谱。\\\
          n\\n##### **1. 技术技能图谱**\\n\\n技术技能是岗位的核心，我们将其分为三个层次：\\n\\n*   **核心必备（权重>40%）：**\
          \ 这是岗位的基石，必须精通。包括：\\n    *   **智能驾驶功能理解：** 深刻理解ACC、LKA、AEB、APA等主流ADAS功能的工作原理、激活条件和限制边界。\\\
          n    *   **车辆驾驶与法规：** 熟练的驾驶技能（C1/C2驾照），无不良驾驶记录，熟悉道路交通安全法规。\\n    *   **测试/标定执行能力：**\
          \ 严格遵循测试用例或标定流程，精准完成操作，并规范记录数据。\\n    *   **办公软件应用：** 熟练使用Office套件（Word/Excel/PPT）撰写报告、整理数据。\\\
          n\\n*   **熟练掌握（权重20%-40%）：** 这是提升竞争力的关键，应熟练应用。包括：\\n    *   **车载总线技术：**\
          \ 掌握CAN/LIN总线工作原理，会使用CANoe、CANalyzer等工具进行报文分析和数据记录。\\n    *   **专业测试设备使用：**\
          \ 能够操作和使用驾驶机器人、ADAS目标物（假人、假车）、高精度定位设备（RTK/IMU）等。\\n    *   **脚本语言基础：** 具备一定的Python或CAPL脚本编写能力，用于辅助测试和数据处理。\\\
          n    *   **Linux系统基础：** 了解Linux基本命令，能够在车载系统环境下进行文件操作和日志查看。\\n\\n*   **加分项（权重<20%）：**\
          \ 这是未来发展的潜力所在，应有所涉猎。包括：\\n    *   **自动化测试知识：** 了解自动化测试的基本概念和框架。\\n    *\
          \   **车辆控制理论：** 了解车辆纵向和横向动力学控制基础。\\n    *   **网络安全基础：** 了解基本的汽车网络攻击与防御知识。\\\
          n\\n```echarts\\n{\\n  \\\"title\\\": {\\n    \\\"text\\\": \\\"目标岗位技术技能雷达图\\\
          \",\\n    \\\"left\\\": \\\"center\\\"\\n  },\\n  \\\"legend\\\": {\\n \
          \   \\\"data\\\": [\\\"技术技能要求\\\"],\\n    \\\"bottom\\\": 5\\n  },\\n  \\\
          \"radar\\\": {\\n    \\\"indicator\\\": [\\n      { \\\"name\\\": \\\"智能驾驶功能理解\\\
          \", \\\"max\\\": 100 },\\n      { \\\"name\\\": \\\"驾驶与法规\\\", \\\"max\\\
          \": 100 },\\n      { \\\"name\\\": \\\"测试/标定执行\\\", \\\"max\\\": 100 },\\\
          n      { \\\"name\\\": \\\"办公软件应用\\\", \\\"max\\\": 100 },\\n      { \\\"\
          name\\\": \\\"车载总线技术\\\", \\\"max\\\": 100 },\\n      { \\\"name\\\": \\\
          \"专业设备使用\\\", \\\"max\\\": 100 },\\n      { \\\"name\\\": \\\"脚本语言基础\\\"\
          , \\\"max\\\": 100 },\\n      { \\\"name\\\": \\\"Linux系统基础\\\", \\\"max\\\
          \": 100 },\\n      { \\\"name\\\": \\\"自动化测试知识\\\", \\\"max\\\": 100 }\\\
          n    ],\\n    \\\"shape\\\": \\\"circle\\\",\\n    \\\"splitNumber\\\":\
          \ 5,\\n    \\\"axisName\\\": {\\n      \\\"formatter\\\": \\\"{value}\\\"\
          ,\\n      \\\"color\\\": \\\"#4283A9\\\"\\n    }\\n  },\\n  \\\"series\\\
          \": [\\n    {\\n      \\\"name\\\": \\\"技能要求\\\",\\n      \\\"type\\\":\
          \ \\\"radar\\\",\\n      \\\"data\\\": [\\n        {\\n          \\\"value\\\
          \": [95, 90, 92, 85, 75, 70, 60, 55, 40],\\n          \\\"name\\\": \\\"\
          技术技能要求\\\",\\n          \\\"areaStyle\\\": {\\n            \\\"color\\\"\
          : \\\"rgba(84, 112, 198, 0.4)\\\"\\n          }\\n        }\\n      ]\\\
          n    }\\n  ]\\n}\\n```\\n\\n##### **2. 综合素质图谱**\\n\\n除了硬技能，企业同样高度重视从业者的综合素质，主要包括：\\\
          n*   **责任心与安全意识：** 测试与标定工作事关生命安全，极强的责任心和安全意识是首要前提。\\n*   **沟通协作能力：** 需要与开发、项目、产品等多个团队密切沟通，清晰地描述问题、反馈进展。\\\
          n*   **逻辑思维与问题解决能力：** 能够对测试中出现的异常现象进行逻辑分析，并积极寻找解决方案。\\n*   **学习能力与抗压能力：**\
          \ 智能网联技术迭代迅速，需要持续学习新知识；外场测试工作强度大，环境多变，需要良好的抗压能力。\\n\\n#### **（四）目标岗位人才需求趋势预测分析**\\\
          n\\n结合行业发展趋势，未来3-5年，目标岗位的人才需求将呈现“量升质增”的态势：\\n*   **需求量持续上升：** 随着高阶智能驾驶功能的普及和“车路云一体化”的建设，测试与标定的工作量将成倍增加，岗位需求将持续扩大。\\\
          n*   **技能要求“软硬兼备”：** 对软件和数据处理能力的要求将显著提升。例如，测试员需要更多地参与自动化测试脚本的开发与维护；标定工程师需要处理更复杂的传感器融合标定问题。\\\
          n*   **岗位内涵拓展：** 岗位职责将从车端向路端和云端延伸。例如，出现“V2X场景测试员”、“云控平台测试员”等新岗位，要求从业者具备通信和云计算相关知识。\\\
          n\\n#### **（五）目标岗位人才需求画像（总结性）**\\n\\n综上所述，湖北省智能网联汽车产业渴求的专科层次理想人才画像如下：\\\
          n\\n**一名合格的【智能网联汽车技术】专业毕业生，应当是：** 一位持有C1/C2驾照、驾驶经验良好、深刻理解主流ADAS功能、能熟练运用CANoe等总线工具和各类测试/标定专用设备、具备一定Python脚本编写能力、能够在Linux环境下工作的**“准工程师”**。他/她不仅具备严谨细致的执行力，更拥有强烈的安全责任意识、良好的沟通协作能力和主动解决问题的态度，能够在毕业后迅速融入企业研发测试流程，为智能网联产品的安全落地贡献价值。\\\
          n\\n---\\n### **第五章：【智能网联汽车技术】专业建设情况分析**\\n\\n本章节旨在通过对标全国及湖北省内【智能网联汽车技术】专业的宏观布局与发展态势，为襄阳职业技术学院明晰自身定位、找准发展坐标提供参考。\\\
          n\\n#### **（一）全国【智能网联汽车技术】专业分布情况**\\n\\n【智能网联汽车技术】作为一个与战略性新兴产业紧密伴生的新专业，其在全国高等职业院校中的布点呈现出鲜明的**产业导向性**和**地域集聚性**。分析显示，该专业的开设院校主要集中在我国汽车工业实力雄厚、智能网联产业链布局完善的地区。\\\
          n\\n具体来看，**广东省、江苏省、上海市、北京市、浙江省**等东部沿海省市，凭借其强大的汽车产业集群和领先的科技创新能力，成为开设此专业院校数量最多的第一梯队。此外，**重庆市、吉林省**以及**湖北省**等传统汽车工业重镇，也依托其深厚的产业底蕴，形成了专业的重点布局区域。这种分布格局清晰地表明，专业建设与区域产业生态的关联度极高，产业强则专业兴。襄阳职业技术学院地处湖北这一汽车产业大省，拥有发展该专业的天然土壤和区位优势。\\\
          n\\n#### **（二）全国【智能网联汽车技术】专业开设趋势（10年+3年预测）**\\n\\n回顾过去十年，【智能网联汽车技术】专业的开设数量经历了一个从“零星探索”到“爆发式增长”的典型过程。在2020年之前，全国仅有少数几所嗅觉敏锐的职业院校试点开设；自2021年该专业被正式列入《职业教育专业目录》以来，全国范围内开设此专业的院校数量急剧增加，呈现井喷态势。\\\
          n\\n展望未来三年（2026-2028年），我们预测专业布点数量的**增长速度将有所放缓，进入一个平台整理期**。原因在于，一方面市场需求虽大，但经过几年的快速扩张，专业布局已初步满足产业基础人才需求；另一方面，教育主管部门和院校自身将更加注重专业建设的“质”，而非“量”，重点将从“有没有”转向“好不好”。这意味着，未来的竞争将是内涵建设的竞争，那些能够真正深化产教融合、培养出高质量技能人才的院校将脱颖而出。\\\
          n\\n```echarts\\n{\\n  \\\"title\\\": {\\n    \\\"text\\\": \\\"全国智能网联汽车技术专业（专科）开设院校数量趋势\\\
          \",\\n    \\\"subtext\\\": \\\"历史数据及未来3-5年趋势预测\\\",\\n    \\\"left\\\":\
          \ \\\"center\\\"\\n  },\\n  \\\"tooltip\\\": {\\n    \\\"trigger\\\": \\\
          \"axis\\\"\\n  },\\n  \\\"legend\\\": {\\n    \\\"data\\\": [\\\"开设院校数量\\\
          \"],\\n    \\\"top\\\": \\\"bottom\\\"\\n  },\\n  \\\"grid\\\": {\\n   \
          \ \\\"left\\\": \\\"3%\\\",\\n    \\\"right\\\": \\\"4%\\\",\\n    \\\"\
          bottom\\\": \\\"10%\\\",\\n    \\\"containLabel\\\": true\\n  },\\n  \\\"\
          xAxis\\\": {\\n    \\\"type\\\": \\\"category\\\",\\n    \\\"boundaryGap\\\
          \": false,\\n    \\\"data\\\": [\\\"2018\\\", \\\"2019\\\", \\\"2020\\\"\
          , \\\"2021\\\", \\\"2022\\\", \\\"2023\\\", \\\"2024\\\", \\\"2025\\\",\
          \ \\\"2026(E)\\\", \\\"2027(E)\\\", \\\"2028(E)\\\"]\\n  },\\n  \\\"yAxis\\\
          \": {\\n    \\\"type\\\": \\\"value\\\",\\n    \\\"name\\\": \\\"数量（所）\\\
          \"\\n  },\\n  \\\"series\\\": [\\n    {\\n      \\\"name\\\": \\\"开设院校数量\\\
          \",\\n      \\\"type\\\": \\\"line\\\",\\n      \\\"smooth\\\": true,\\\
          n      \\\"data\\\": [5, 12, 35, 98, 165, 240, 295, 330, 350, 360, 365],\\\
          n      \\\"areaStyle\\\": {},\\n      \\\"markLine\\\": {\\n        \\\"\
          symbol\\\": \\\"none\\\",\\n        \\\"data\\\": [{\\n          \\\"name\\\
          \": \\\"预测分界\\\",\\n          \\\"xAxis\\\": \\\"2025\\\"\\n        }],\\\
          n        \\\"label\\\": {\\n          \\\"formatter\\\": \\\"预测开始\\\"\\\
          n        }\\n      }\\n    }\\n  ]\\n}\\n```\\n\\n#### **（三）全省【智能网联汽车技术】专业开设情况**\\\
          n\\n在湖北省内，【智能网联汽车技术】专业的建设同样呈现出蓬勃发展的态势。依托武汉“中国车都”的强大产业辐射能力，省内已有多所高职院校布局此专业，形成了一定的集群效应。除襄阳职业技术学院外，**武汉软件工程职业学院、武汉交通职业学院、湖北交通职业技术学院**等均是省内该专业领域的重要参与者。这些院校大多位于武汉市，能够更便捷地对接东风、百度萝卜快跑等头部企业的资源。这对于地处襄阳的学校而言，既是竞争压力，也是学习和对标的参照系。学校需要思考如何立足襄阳本地的产业特色（如东风商用车基地），形成与武汉地区院校的错位发展和特色竞争。\\\
          n\\n#### **（四）【智能网联汽车技术】专业建设情况分析（如全国排名、重点院校对标）**\\n\\n目前，国家层面尚未有针对【智能网联汽车技术】这一新兴专业的官方权威排名。但通过分析“双高计划”建设单位、国家级职业教育教师教学创新团队以及各类技能大赛的获奖情况，可以识别出一批在该专业领域具有领先优势的标杆院校。\\\
          n\\n**深圳职业技术大学（原深圳职业技术学院）** 和 **武汉软件工程职业学院** 是两个值得襄阳职业技术学院重点对标的范例。\\n\\\
          n*   **深圳职业技术大学：** 作为全国职业教育的领头羊，其智能网联汽车专业群建设起点高、投入大，与比亚迪、华为等头部企业建立了深度合作关系，其课程体系紧跟技术前沿，实训设备达到业界领先水平，是全国范围内的顶尖标杆。\\\
          n*   **武汉软件工程职业学院：** 作为省内标杆，该校充分利用地处武汉的区位优势，与本地产业结合紧密，其人才培养方案和课程设置对湖北省的产业需求有更强的针对性。\\\
          n\\n对标这些重点院校，襄阳职业技术学院应清醒地认识到，在专业建设的硬件投入、师资水平、产教融合深度等方面仍存在一定差距。但这同时也指明了努力的方向：必须以超常规的力度，加快“双师型”教师队伍建设，升级实训条件，并与以东风公司为龙头的本地企业建立更加紧密、实质性的合作关系，从而在激烈的专业竞争中占据一席之地。\\\
          n\\n---\\n### **第六章：区域产教对接匹配度诊断**\\n\\n本章是报告的诊断核心，旨在通过量化分析，精准诊断**襄阳职业技术学院【智能网联汽车技术】专业**在服务**湖北省**产业发展中，人才供给与产业需求之间的匹配程度，揭示结构性矛盾，为专业调整提供数据依据。\\\
          n\\n#### **（一）专业布局对接匹配分析**\\n\\n“供需比”是衡量区域人才供给是否满足产业需求的关键指标。我们通过对比湖北省智能网联汽车产业的人才需求在全国的占比，与湖北省开设该专业的高职院校数量在全国的占比，来量化专业布局的匹配度。\\\
          n\\n*   **需求侧分析：** 湖北省作为我国汽车产业的核心基地之一，拥有以东风集团为核心的完整产业链，并在武汉获批国家级“车路云一体化”应用试点，产业发展势头强劲。大数据分析显示，2025年湖北省智能网联汽车相关岗位的需求量约占全国总需求的**8.5%**，位居全国前列，是中部地区当之无愧的产业高地。\\\
          n\\n*   **供给侧分析：** 与强劲的需求相比，人才供给侧则显得相对薄弱。根据教育部公开数据及我们的调研统计，截至2025年，湖北省开设【智能网联汽车技术】专科专业的院校数量约占全国同类院校总数的**5.2%**。\\\
          n\\n*   **供需匹配诊断：**\\n    **区域人才供需比 = 供给占比 / 需求占比 = 5.2% / 8.5% ≈ 0.61**\\\
          n\\n    供需比显著低于1，揭示了湖北省智能网联汽车领域存在着严重的**人才供给缺口**。这意味着，产业发展的速度已经远超本地人才培养的速度。对于襄阳职业技术学院而言，这既是巨大的发展机遇，也意味着沉甸甸的责任。学校加大投入、扩大招生、提升培养质量，不仅是自身发展的需要，更是服务区域经济发展的迫切要求。\\\
          n\\n```echarts\\n{\\n  \\\"title\\\": {\\n    \\\"text\\\": \\\"湖北省智能网联汽车人才供需布局匹配度诊断\\\
          \",\\n    \\\"left\\\": \\\"center\\\",\\n    \\\"subtext\\\": \\\"供需比 <\
          \ 1，表明人才供给存在显著缺口\\\"\\n  },\\n  \\\"tooltip\\\": {\\n    \\\"trigger\\\"\
          : \\\"axis\\\",\\n    \\\"axisPointer\\\": {\\n      \\\"type\\\": \\\"\
          shadow\\\"\\n    }\\n  },\\n  \\\"grid\\\": {\\n    \\\"left\\\": \\\"3%\\\
          \",\\n    \\\"right\\\": \\\"4%\\\",\\n    \\\"bottom\\\": \\\"3%\\\",\\\
          n    \\\"containLabel\\\": true\\n  },\\n  \\\"xAxis\\\": {\\n    \\\"type\\\
          \": \\\"category\\\",\\n    \\\"data\\\": [\\\"全国需求占比\\\", \\\"全国供给占比\\\"\
          ]\\n  },\\n  \\\"yAxis\\\": {\\n    \\\"type\\\": \\\"value\\\",\\n    \\\
          \"axisLabel\\\": {\\n      \\\"formatter\\\": \\\"{value} %\\\"\\n    }\\\
          n  },\\n  \\\"series\\\": [\\n    {\\n      \\\"name\\\": \\\"湖北省占比\\\"\
          ,\\n      \\\"type\\\": \\\"bar\\\",\\n      \\\"barWidth\\\": \\\"60%\\\
          \",\\n      \\\"data\\\": [\\n        { \\\"value\\\": 8.5, \\\"itemStyle\\\
          \": { \\\"color\\\": \\\"#c23531\\\" }, \\\"name\\\": \\\"需求端（产业岗位）\\\"\
          \ },\\n        { \\\"value\\\": 5.2, \\\"itemStyle\\\": { \\\"color\\\"\
          : \\\"#2f4554\\\" }, \\\"name\\\": \\\"供给端（专业布点）\\\" }\\n      ],\\n   \
          \   \\\"label\\\": {\\n        \\\"show\\\": true,\\n        \\\"position\\\
          \": \\\"top\\\",\\n        \\\"formatter\\\": \\\"{c}%\\\"\\n      }\\n\
          \    }\\n  ]\\n}\\n```\\n\\n#### **（二）学历结构对接匹配分析**\\n\\n除了总量的缺口，人才培养的结构性错配是更深层次的问题。我们通过对比市场需求的学历结构与区域人才供给的学历结构，来诊断其匹配程度。\\\
          n\\n*   **需求侧结构：** 如第四章分析所示，企业对智能网联汽车技术技能岗位的学历要求呈现出极强的**“务实性”**。数据显示，明确要求“大专”学历的岗位占比高达**48%**，“本科”占比为**43%**。这表明在技术技能一线，企业对专科层次人才的需求几乎与本科层次平分秋色，甚至略占优势。\\\
          n\\n*   **供给侧结构：** 襄阳职业技术学院作为专科层次的职业院校，其【智能网联汽车技术】专业的毕业生，为市场贡献的是**100%的专科层次**人才供给。\\\
          n\\n*   **结构匹配诊断：**\\n    表面上看，学校的专科人才供给与市场对专科人才的巨大需求（48%）是高度匹配的。然而，真正的**“结构失配”**并非体现在学历层次上，而是体现在**“能力结构”**上。\\\
          n\\n    我们定义一个**“能力结构失配指数”**：即企业需求中“要求1-3年及以上经验”的岗位比例（高达77%）与学校供给中“具备准工作经验”的毕业生比例（理想状态下应接近100%，但现实中可能很低）之间的巨大差距。当前，传统教学模式培养的应届生普遍缺乏企业认可的“工作经验”，导致他们难以进入占市场需求主体（77%）的成熟岗位招聘池，只能在仅占23%的“应届生”岗位中激烈竞争。\\\
          n\\n    **这种“学历达标、经验为零”的现状，是当前产教融合最核心的痛点。** 学校的人才培养目标，必须从“输送合格学历的毕业生”转变为“培养具备准工作经验的技术专才”，才能真正破解这一结构性矛盾，实现与产业需求的高质量匹配。\\\
          n\\n---\\n### **第七章：调研结论**\\n\\n通过对智能网联汽车产业的宏观趋势、湖北省的区域特点以及目标岗位的人才需求进行系统性大数据分析，本报告得出以下核心结论，旨在为襄阳职业技术学院【智能网联汽车技术】专业的战略决策提供清晰的诊断依据：\\\
          n\\n1.  **产业东风正劲，区域机遇空前。** 智能网联汽车产业正处于国家战略驱动下的高速增长期，市场规模持续扩大。湖北省凭借其雄厚的汽车工业基础和以武汉为核心的“车路云一体化”试点战略地位，已成为中部地区产业发展的桥头堡，为应用型技术技能人才创造了巨大的、持续增长的就业市场。\\\
          n\\n2.  **岗位需求明确，专科大有可为。** 产业对人才的需求已下沉至量产、测试、运维等应用环节。其中，**“智能网联汽车测试员”和“ADAS标定工程师”**等技术技能岗位需求旺盛、薪酬优厚、发展路径清晰。更重要的是，企业对这些岗位的学历要求极为务实，**近五成岗位向专科生开放**，这为襄阳职业技术学院等高职院校提供了明确且大有可为的战略赛道。\\\
          n\\n3.  **“经验鸿沟”是核心痛点，产教融合是唯一解法。** 尽管学历门槛匹配，但企业普遍要求**1-3年工作经验**，面向应届生的岗位不足四分之一。毕业生面临着从“校园”到“职场”的显著“经验鸿沟”。弥合这一鸿沟，让学生在毕业时即拥有企业认可的“准工作经验”，是专业建设必须攻克的首要难题，而深化产教融合是实现这一目标的唯一有效路径。\\\
          n\\n4.  **区域人才供给严重不足，结构性矛盾突出。** 诊断数据显示，湖北省智能网联汽车人才的“供需比”仅为**0.61**，存在严重的总量供给缺口。同时，更存在着“能力结构”的失配，即学校培养的“理论型”毕业生与企业渴求的“实战型”人才之间存在巨大差距。这要求学校必须加快人才培养模式的转型升级。\\\
          n\\n5.  **对标先进差距仍在，特色发展迫在眉睫。** 与国内如深圳职业技术大学、省内如武汉软件工程职业学院等标杆院校相比，本校在师资力量、实训条件、产教融合深度等方面仍有提升空间。在专业布点日益增多的背景下，必须立足襄阳本地产业特色（如商用车、零部件基地），走**差异化、特色化**发展之路，避免同质化竞争。\\\
          n\\n---\\n### **第八章：建议**\\n\\n基于以上结论，为将挑战转化为机遇，推动襄阳职业技术学院【智能网联汽车技术】专业成为区域领先、特色鲜明的品牌专业，兹提出以下八项战略与战术建议：\\\
          n\\n1.  **战略聚焦：锚定“测试与标定”特色方向。**\\n    建议学校集中资源，将专业的核心培养方向锚定在“智能网联汽车测试与标定”这一市场需求最旺盛、与专科层次最匹配的领域。在专业宣传、招生、课程设置和资源配置上，明确打出“培养高级测试与标定工程师”的特色品牌，形成与省内其他院校的错位竞争优势。\\\
          n\\n2.  **课程重构：“逆向设计”与“模块整合”。**\\n    彻底摒弃“学科导向”的传统课程体系，采用“岗位能力导向”的逆向设计方法。以第四章构建的“能力图谱”为蓝图，将“智能驾驶功能”、“车载总线”、“专业设备”、“脚本语言”等核心技能点，重构为**项目式、模块化**的课程单元。例如，开设《基于CANoe的ADAS功能测试》、《驾驶机器人场景测试项目实战》、《摄像头与雷达静态/动态标定》等高度仿真的项目课程。\\\
          n\\n3.  **师资升级：“内培外引”打造双师铁军。**\\n    实施“教师能力升级计划”。一方面，分批次将专业教师送往东风、百度等合作企业进行**为期不少于3个月**的顶岗实践，学习最新的测试标定流程与工具；另一方面，大力推行“产业导师”制度，从企业一线聘请资深测试经理、标定专家作为兼职教师，为学生讲授最前沿的实战案例，实现“企业工程师进课堂”。\\\
          n\\n4.  **实训革新：构建“车-路-云”一体化教学工厂。**\\n    推动实训基地从“功能验证型”向“生产流程型”升级。投资建设能够模拟“车-路-云”一体化测试环境的“教学工厂”，不仅要配备主流的测试标定硬件（如驾驶机器人、ADAS目标物、V2X路侧单元），更要引入企业级的测试管理与自动化测试软件平台，让学生在校内即可完整体验企业真实的项目流程。\\\
          n\\n5.  **标准融入：将1+X证书标准全面融入教学。**\\n    将**“智能网联汽车测试装调”**等1+X职业技能等级证书的考核标准与核心技能要求，全面、有机地融入到日常教学和课程考核中。实现“课证融通”，鼓励学生在毕业时不仅获得毕业证，更能手持行业高度认可的技能等级证书，作为其“准工作经验”的有力证明。\\\
          n\\n6.  **合作深化：共建“东风智能网联产业学院”。**\\n    利用地处襄阳的区位优势，与东风公司（特别是商用车和零部件板块）等龙头企业建立更加紧密的战略合作关系。建议从“订单班”模式升级为共建**“东风智能网联产业学院”**。通过校企共同制定人才培养方案、共同开发课程、共同组织教学、共同进行考核评价，将企业需求前置到人才培养的全过程，从根本上解决“经验鸿沟”问题。\\\
          n\\n7.  **过程重塑：实施“毕业即上岗”学徒制项目。**\\n    在大学的最后一年，推行现代学徒制。筛选优秀学生进入合作企业的“准员工”培养通道，以“师傅带徒弟”的方式，在真实的工作岗位上完成毕业设计和顶岗实习。学生的实习内容即未来的工作内容，实习考核合格后直接留用，实现“招生即招工、毕业即上岗”的无缝衔接。\\\
          n\\n8.  **评价改革：引入企业参与的多元评价体系。**\\n    改革学生学业评价方式，变“单一卷面考试”为“多元过程性考核”。引入企业项目案例、实操技能竞赛、项目报告答辩等考核形式。关键核心课程的最终成绩，应由校内教师和企业导师共同评定，确保评价标准与行业用人标准高度一致，真正驱动学生将精力聚焦于实战能力的提升。\"\
          \n\n  # 2. 等待2分钟 (120秒)\n  # 警告：请确保您的Dify环境执行超时时间 > 120秒\n  time.sleep(10)\n\
          \n  # 3. 将数据结构转换为JSON字符串\n  # ensure_ascii=False 保证中文字符正常显示\n  output_string\
          \ = json.dumps(template_data, ensure_ascii=False)\n\n  # 4. 关键：以Dify要求的字典格式返回输出\n\
          \  # 'result' 这个key必须与你在UI上定义的输出变量名完全一致\n  return {\n    'result': template_data\n\
          \  }\n\n"
        code_language: python3
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: 代码执行 21 (1)
        type: code
        variables: []
      height: 52
      id: '17617436446190'
      position:
        x: 1086.3219722695617
        y: 1073.8894580209421
      positionAbsolute:
        x: 1086.3219722695617
        y: 1073.8894580209421
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gemini-3-flash-preview
          provider: langgenius/gemini/google
        prompt_template:
        - id: 81bf7800-b7bd-4024-93be-fc72e5d49240
          role: system
          text: "你是一个数据筛选专家，你的任务是评估提供的网页内容是否对制作一份“人才需求分析报告”具有参考价值。\n\n请根据以下规则判断：\n\
            1. **非常相关：** 内容直接讨论某个行业、区域或专业的人才供需、技能要求、薪资水平、培养方案、市场趋势、政策影响、招聘策略、教育与产业对接等。\n\
            2. **中度相关：** 内容间接与人才需求分析报告相关，例如介绍某个行业的发展前景（可能影响人才需求）、某个技能的详细介绍（可能与技能要求相关）、某个地方的经济发展状况（可能影响人才的吸引力）。如果无法直接判断，但其信息可能作为报告的背景或补充。\n\
            3. **不相关：** 内容是广告、娱乐新闻、个人博客（非专业性）、与人才或就业主题无关的产品介绍、纯粹的技术文档（不涉及人才市场）、与用户输入的学校、专业、地区、教育层次完全不匹配的信息、色情、暴力、违法内容、重复内容等。\n\
            \n请针对每一个给定的网页信息，输出其相关性评估。如果内容是“不相关”的，请说明具体的不相关原因。\n\n**用户输入信息（作为背景参考，帮助你判断相关性）：**\n\
            学校: {用户输入的学校}\n专业: {用户输入的专业}\n地区: {用户输入的地区}\n教育层次: {用户输入的教育层次}\n\n**请严格按照以下JSON格式输出，不要包含任何其他说明文字：**\n\
            ```json\n[\n  {\n    \"source_id\": \"xxx\", // 原始网页的唯一标识\n    \"title\"\
            : \"xxx\", // 原始网页标题\n    \"url\": \"xxx\", // 原始网页链接\n    \"relevance\"\
            : \"非常相关/中度相关/不相关\",\n    \"reason_for_exclusion\": \"（如果relevance为'不相关'，请说明原因）\"\
            \n  },\n  // ... 其他网页信息\n]\n"
        - id: 886f00d5-513d-45d4-bfee-950626ccfa94
          role: user
          text: '用户输入信息：

            学校: {{#1754636636322.school#}}

            专业: {{#1754636636322.major#}}

            地区: {{#1754636636322.region#}}

            教育层次: {{#1754636636322.education_level#}}


            待评估的网页信息：{{#1770109476978.trimmed_markdown_content#}}'
        retry_config:
          max_retries: 3
          retry_enabled: true
          retry_interval: 1000
        selected: false
        title: 数据筛选agent
        type: llm
        vision:
          enabled: false
      height: 119
      id: '1765163992033'
      position:
        x: 2138.7401621672852
        y: -1003.6184717443404
      positionAbsolute:
        x: 2138.7401621672852
        y: -1003.6184717443404
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "import re\nimport json\nfrom typing import Dict, Optional, Any\ndef\
          \ extract_json_block(text: str) -> Optional[str]:\n    \"\"\"\n    从输入文本中提取\
          \ JSON 代码块。\n    优先匹配 markdown 中的 ```json``` 块。\n    如果失败，则尝试直接解析整个文本是否为\
          \ JSON。\n    \"\"\"\n    if not isinstance(text, str):\n        print(f\"\
          Error: extract_json_block received non-string input: {type(text)}. Attempting\
          \ conversion.\")\n        try:\n            text = str(text)\n        except\
          \ Exception as e:\n            print(f\"Error: Failed to convert input to\
          \ string: {e}\")\n            return None\n    # 1. 优先提取 ```json``` 代码块\n\
          \    json_block_match = re.search(r\"```json\\s*([\\s\\S]*?)\\s*```\", text,\
          \ re.IGNORECASE | re.DOTALL)\n    if json_block_match:\n        json_content\
          \ = json_block_match.group(1).strip()\n        try:\n            json.loads(json_content)\
          \ # 尝试解析以验证\n            return json_content # 如果有效，则返回这个 JSON 字符串\n   \
          \     except json.JSONDecodeError:\n            print(f\"Warning: Content\
          \ within ```json``` block is not valid JSON. Full content: \\n{json_content}\\\
          n\")\n            # 如果代码块内容无效，不做回退，因为明确指定了要代码块中的内容\n            # 所以这里继续返回\
          \ None，或者如果希望回退，则可以在这里添加回退逻辑\n            pass # 发生错误，继续尝试下一个逻辑 (即整个文本是否为JSON)\n\
          \    # 2. 如果没有 ```json``` 块，或者 ```json``` 块内容不合法，则尝试将整个文本作为 JSON 解析\n  \
          \  try:\n        stripped_text = text.strip()\n        json.loads(stripped_text)\
          \ # 尝试解析以验证\n        return stripped_text # 如果整个文本是有效 JSON，则返回它\n    except\
          \ json.JSONDecodeError:\n        print(f\"Info: No ```json``` block found\
          \ or entire text is not valid JSON. Full text: \\n{text}\\n\")\n       \
          \ return None # 无法提取或解析 JSON\ndef main(llm_output_text: Optional[str]) ->\
          \ Dict[str, Any]:\n    \"\"\"\n    从 llm_output_text 中提取 ```json``` 代码块内容，并作为字符串返回。\n\
          \    \"\"\"\n    if not isinstance(llm_output_text, str) or not llm_output_text.strip():\n\
          \        print(\"Warning: llm_output_text is not a valid string or is empty.\"\
          )\n        return {\n            \"result\": None, # 返回 None 更准确，表示未找到有效\
          \ JSON\n        }\n    # 直接从 llm_output_text 中提取 JSON\n    extracted_json_str\
          \ = extract_json_block(llm_output_text)\n    return {\n        \"result\"\
          : extracted_json_str,\n    }"
        code_language: python3
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: 提取json
        type: code
        variables:
        - value_selector:
          - '1765163992033'
          - text
          value_type: string
          variable: llm_output_text
      height: 52
      id: '1765164099685'
      position:
        x: 1748.985599869119
        y: -914.9419967286384
      positionAbsolute:
        x: 1748.985599869119
        y: -914.9419967286384
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "# import json\n# from typing import List, Dict, Any\n\n# def is_empty_dict(data:\
          \ Any) -> bool:\n#     \"\"\"Checks if a dictionary is considered empty.\n\
          #     Handles nested structures as well.\"\"\"\n\n#     if isinstance(data,\
          \ dict):\n#         return not any(data.values())  # If *all* values are\
          \ falsy, it's empty.\n#     return False\n\n# def main(\n#     original_search_results:\
          \ Dict[str, Any],\n#     llm_evaluation_output: str = None\n# ) -> Dict[str,\
          \ Any]:\n#     \"\"\"Optimized version for speed and removes empty objects.\"\
          \"\"\n\n#     evaluation_map = {}\n#     if llm_evaluation_output:\n#  \
          \       try:\n#             llm_evaluation_output: List[Dict[str, Any]]\
          \ = json.loads(llm_evaluation_output)\n#             evaluation_map = {item[\"\
          source_id\"]: item for item in llm_evaluation_output}\n#         except\
          \ json.JSONDecodeError as e:\n#             print(f\"Warning: Error parsing\
          \ LLM output: {e}. Ignoring filtering.\")\n\n#     career_postings = []\n\
          #     enterprise_infos = []\n#     filtered_results = []\n\n#     original_search_results_list\
          \ = original_search_results[0].get(\"result\", [])\n\n#     for doc_item\
          \ in original_search_results_list:\n#         web_data = doc_item.get(\"\
          web_data\")\n#         if not web_data:\n#             filtered_results.append(doc_item)\n\
          #             continue\n\n#         # Extract career postings, filtering\
          \ out empty dicts\n#         if \"career_postings\" in web_data and \"data\"\
          \ in web_data[\"career_postings\"]:\n#             career_postings.extend([item\
          \ for item in web_data[\"career_postings\"][\"data\"] if not is_empty_dict(item)])\n\
          \n#         # Extract enterprise info, filtering out empty dicts\n#    \
          \     if \"enterprise_infos\" in web_data:\n#             enterprise_data\
          \ = web_data[\"enterprise_infos\"]\n#             if \"data\" in enterprise_data:\n\
          #                 enterprise_infos.extend([item for item in enterprise_data[\"\
          data\"] if not is_empty_dict(item)])\n#             elif not is_empty_dict(enterprise_data):\
          \  # Handle the case where enterprise_infos is a single dict\n#        \
          \         enterprise_infos.append(enterprise_data)\n\n#         # Process\
          \ all_source_list based on LLM evaluation\n#         comprehensive_data\
          \ = web_data.get(\"comprehensive_data\", {})\n#         all_source_list\
          \ = comprehensive_data.get(\"all_source_list\", [])\n\n#         if all_source_list:\
          \  # Skip processing when all_source_list is empty\n#             filtered_all_source_list\
          \ = []\n#             if evaluation_map:\n#                 for source_data\
          \ in all_source_list:\n#                     source_id = source_data.get(\"\
          source_id\")\n#                     if source_id:\n#                   \
          \      evaluation = evaluation_map.get(source_id)\n#                   \
          \      if evaluation is None or evaluation.get(\"relevance\") != \"不相关\"\
          :\n#                             filtered_all_source_list.append(source_data)\n\
          #                     else:\n#                         filtered_all_source_list.append(source_data)\n\
          #             else:\n#                 filtered_all_source_list = all_source_list\n\
          \n#             if filtered_all_source_list: #Check if filtered all source\
          \ list isnt empty before setting\n#                 if \"comprehensive_data\"\
          \ not in web_data:\n#                    web_data[\"comprehensive_data\"\
          ]={}\n\n#                 web_data[\"comprehensive_data\"][\"all_source_list\"\
          ] = filtered_all_source_list\n#                 filtered_results.append(doc_item)\n\
          \n#     career_postings = [item for item in career_postings if not is_empty_dict(item)]\
          \ #Remove empty stuff last\n#     enterprise_infos = [item for item in enterprise_infos\
          \ if not is_empty_dict(item)]\n\n#     # String conversion SHOULD happen\
          \ only ONCE at the OUTPUT stage\n#     career_postings_str = str(career_postings)\n\
          #     enterprise_infos_str = str(enterprise_infos)\n#     filtered_results_str\
          \ = str(filtered_results)\n\n#     return {\n#         \"output_str\": filtered_results_str,\n\
          #         \"output\": filtered_results,\n#         \"career_postings\":\
          \ career_postings,\n#         \"career_postings_str\": career_postings_str,\n\
          #         \"enterprise_infos\": enterprise_infos,\n#         \"enterprise_infos_str\"\
          : enterprise_infos_str\n        \n#     }\nimport json\nfrom typing import\
          \ List, Dict, Any\n\ndef is_empty_dict(data: Any) -> bool:\n    \"\"\"\n\
          \    检查一个字典是否为空。\n    也适用于检查嵌套结构。\n    \"\"\"\n    if isinstance(data, dict):\n\
          \        return not any(data.values())  # 如果所有值都为假值 (如 None, '', [], {}),\
          \ 则视为空\n    return False\n\ndef extract_web_data(original_search_results:\
          \ List[Dict[str, Any]]) -> List[Dict[str, str]]:\n    \"\"\"\n    从嵌套的 all_source_list\
          \ 中提取 {url, query, snippet, title} 列表。\n    此函数能安全地处理可能缺失的字段和不正确的数据类型。\n\
          \    输入 `original_search_results` 预期为一个列表, 例如: `[{ \"result\": [...] }]`\n\
          \    \"\"\"\n    web_data_list = []\n\n    if not isinstance(original_search_results,\
          \ list):\n        print(\"警告：extract_web_data 的输入不是列表。返回空列表。\")\n      \
          \  return []\n\n    for result_level1 in original_search_results:\n    \
          \    # 使用 .get() 安全地获取 \"result\" 列表\n        result_list = result_level1.get(\"\
          result\", [])\n        if not isinstance(result_list, list):\n         \
          \   continue\n\n        for item in result_list:\n            if not isinstance(item,\
          \ dict):\n                continue\n            \n            # 使用 .get()\
          \ 链式调用安全地导航到 all_source_list，防止 KeyError\n            all_source_list =\
          \ item.get(\"web_data\", {}).get(\"comprehensive_data\", {}).get(\"all_source_list\"\
          , [])\n\n            if not isinstance(all_source_list, list):\n       \
          \         continue\n\n            for source in all_source_list:\n     \
          \           if isinstance(source, dict):\n                    title = source.get(\"\
          title\", \"\")\n                    snippet = source.get(\"snippet\", \"\
          \")\n                    query = source.get(\"query\", \"\")  # 获取 'query'\n\
          \                    url = source.get(\"url\", \"\")\n                 \
          \   source = source.get(\"source\", \"\")\n\n                    if not\
          \ isinstance(url, str):\n                        url = \"\"\n\n        \
          \            web_data_list.append({\n                        \"url\": url,\n\
          \                        # \"query\": query,\n                        \"\
          snippet\": snippet,\n                        \"title\": title,\n       \
          \                 \"source\":source\n                    })\n\n    return\
          \ web_data_list\n\ndef main(\n    original_search_results: List[Dict[str,\
          \ Any]],  # <-- 修复1: 类型应为 List\n    llm_evaluation_output: str = None\n\
          ) -> Dict[str, Any]:\n    \"\"\"\n    优化版本，用于快速处理数据并移除空对象。\n    处理的 `original_search_results`\
          \ 结构为 `[{ \"result\": [...] }]`。\n    \"\"\"\n\n    evaluation_map = {}\n\
          \    if llm_evaluation_output:\n        try:\n            llm_evaluation_list:\
          \ List[Dict[str, Any]] = json.loads(llm_evaluation_output)\n           \
          \ evaluation_map = {item[\"source_id\"]: item for item in llm_evaluation_list}\n\
          \        except (json.JSONDecodeError, TypeError) as e:\n            print(f\"\
          警告: 解析LLM输出时出错: {e}。将忽略筛选。\")\n\n    career_postings = []\n    enterprise_infos\
          \ = []\n    filtered_results = []\n\n    # --- 修复2: 增加健壮性检查，防止因输入格式问题导致的崩溃\
          \ ---\n    original_search_results_list = []\n    # 检查 `original_search_results`\
          \ 是否是一个非空列表\n    if original_search_results and isinstance(original_search_results,\
          \ list):\n        # 检查列表的第一个元素是否是字典\n        first_item = original_search_results[0]\n\
          \        if isinstance(first_item, dict):\n            # 安全地获取 \"result\"\
          \ 列表\n            original_search_results_list = first_item.get(\"result\"\
          , [])\n    \n    if not isinstance(original_search_results_list, list):\n\
          \        original_search_results_list = []\n\n    for doc_item in original_search_results_list:\n\
          \        if not isinstance(doc_item, dict): # 增加健壮性\n            continue\n\
          \            \n        web_data = doc_item.get(\"web_data\")\n        if\
          \ not web_data:\n            filtered_results.append(doc_item)\n       \
          \     continue\n\n        # 提取 career postings, 过滤空字典\n        career_postings_data\
          \ = web_data.get(\"career_postings\", {})\n        if isinstance(career_postings_data,\
          \ dict) and \"data\" in career_postings_data and isinstance(career_postings_data.get(\"\
          data\"), list):\n            career_postings.extend([item for item in career_postings_data[\"\
          data\"] if not is_empty_dict(item)])\n\n        # 提取 enterprise info, 过滤空字典\n\
          \        enterprise_data = web_data.get(\"enterprise_infos\")\n        if\
          \ enterprise_data:\n            if isinstance(enterprise_data, dict) and\
          \ \"data\" in enterprise_data and isinstance(enterprise_data.get(\"data\"\
          ), list):\n                enterprise_infos.extend([item for item in enterprise_data[\"\
          data\"] if not is_empty_dict(item)])\n            elif isinstance(enterprise_data,\
          \ dict) and not is_empty_dict(enterprise_data):\n                enterprise_infos.append(enterprise_data)\n\
          \n        # 基于 LLM 评估处理 all_source_list\n        comprehensive_data = web_data.get(\"\
          comprehensive_data\", {})\n        all_source_list = comprehensive_data.get(\"\
          all_source_list\", [])\n\n        if isinstance(all_source_list, list) and\
          \ all_source_list:\n            filtered_all_source_list = []\n        \
          \    if evaluation_map:\n                for source_data in all_source_list:\n\
          \                    if not isinstance(source_data, dict): continue\n  \
          \                  source_id = source_data.get(\"source_id\")\n        \
          \            if source_id:\n                        evaluation = evaluation_map.get(source_id)\n\
          \                        if evaluation is None or evaluation.get(\"relevance\"\
          ) != \"不相关\":\n                            filtered_all_source_list.append(source_data)\n\
          \                    else:\n                        filtered_all_source_list.append(source_data)\n\
          \            else:\n                filtered_all_source_list = all_source_list\n\
          \n            if filtered_all_source_list:\n                if \"comprehensive_data\"\
          \ not in web_data or not isinstance(web_data.get(\"comprehensive_data\"\
          ), dict):\n                   web_data[\"comprehensive_data\"] = {}\n  \
          \              web_data[\"comprehensive_data\"][\"all_source_list\"] = filtered_all_source_list\n\
          \                filtered_results.append(doc_item)\n    \n    # 最终清理\n \
          \   career_postings = [item for item in career_postings if not is_empty_dict(item)]\n\
          \    enterprise_infos = [item for item in enterprise_infos if not is_empty_dict(item)]\n\
          \n    # --- 修复3: 重新集成 web_data 的提取与输出 ---\n    final_web_data = extract_web_data(original_search_results)\n\
          \    \n    # 在输出阶段统一进行字符串转换\n    final_web_data_str = str(final_web_data)\n\
          \    career_postings_str = str(career_postings)\n    enterprise_infos_str\
          \ = str(enterprise_infos)\n    filtered_results_str = str(filtered_results)\n\
          \n    # --- 修复4: 在返回字典中添加所需字段 ---\n    return {\n        \"output_str\"\
          : filtered_results_str,\n        \"output\": filtered_results,\n       \
          \ \"career_postings\": career_postings,\n        \"career_postings_str\"\
          : career_postings_str,\n        \"enterprise_infos\": enterprise_infos,\n\
          \        \"enterprise_infos_str\": enterprise_infos_str,\n        \"web_data\"\
          : final_web_data,\n        \"web_data_str\": final_web_data_str\n    }\n"
        code_language: python3
        outputs:
          career_postings:
            children: null
            type: array[object]
          career_postings_str:
            children: null
            type: string
          enterprise_infos:
            children: null
            type: array[object]
          enterprise_infos_str:
            children: null
            type: string
          output:
            children: null
            type: array[object]
          output_str:
            children: null
            type: string
          web_data:
            children: null
            type: array[object]
          web_data_str:
            children: null
            type: string
        selected: false
        title: 剔除不相干内容
        type: code
        variables:
        - value_selector:
          - '1770109415803'
          - result
          value_type: array[object]
          variable: original_search_results
        - value_selector:
          - '1765164099685'
          - result
          value_type: string
          variable: llm_evaluation_output
      height: 52
      id: '1765164153379'
      position:
        x: 2138.7401621672852
        y: -900.6187811777932
      positionAbsolute:
        x: 2138.7401621672852
        y: -900.6187811777932
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "def main(arg1: str):\n    \"\"\"\n    Removes all occurrences of '---'\
          \ from the input string arg1.\n\n    If an error occurs during the processing,\
          \ the original string arg1 is returned.\n    If successful, the modified\
          \ string (with '---' removed) is returned.\n\n    Args:\n        arg1: The\
          \ input string.\n\n    Returns:\n        A dictionary with a single key\
          \ 'result' whose value is\n        the processed string or the original\
          \ string if an error occurred.\n    \"\"\"\n    # Initialize the result\
          \ with the original arg1.\n    # This covers the \"return original on error\"\
          \ case by default.\n    result_value = arg1\n\n    try:\n        # Perform\
          \ the string replacement.\n        # The .replace() method replaces all\
          \ occurrences of the first argument\n        # with the second argument.\
          \ It's a robust method that typically\n        # doesn't raise errors for\
          \ valid string inputs.\n        updated_arg1 = arg1.replace(\"---\", \"\"\
          )\n\n        # If the replacement was successful (which it almost always\
          \ will be\n        # when arg1 is a string), update the result_value.\n\
          \        result_value = updated_arg1\n\n    except Exception as e:\n   \
          \     # In the unlikely event of an error (e.g., if arg1 somehow wasn't\n\
          \        # a string despite the type hint, or for extremely rare system-level\
          \ issues),\n        # we catch the exception.\n        # The result_value\
          \ remains arg1 as it was initialized, fulfilling\n        # the requirement\
          \ to return the original on error.\n        # print(f\"An error occurred\
          \ during string replacement: {e}. Returning original arg1.\")\n        pass\
          \ # No explicit action needed here, as result_value is already arg1\n\n\
          \    return {\n        \"result\": result_value\n    }\n"
        code_language: python3
        outputs:
          result:
            children: null
            type: string
        selected: false
        title: 代码执行 22
        type: code
        variables:
        - value_selector:
          - '1754991511949'
          - md_content
          value_type: string
          variable: arg1
      height: 52
      id: '1766335411658'
      position:
        x: 917.8466547894516
        y: -308.96887810534236
      positionAbsolute:
        x: 917.8466547894516
        y: -308.96887810534236
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: empty
            id: 630beadf-5fdf-4eed-9631-a8d92d91e059
            value: ''
            varType: string
            variable_selector:
            - '1754636636322'
            - step_content
          id: 'true'
          logical_operator: and
        selected: false
        title: 条件分支 6
        type: if-else
      height: 124
      id: '1770091124929'
      position:
        x: 651.0170641459815
        y: -465.01196034914847
      positionAbsolute:
        x: 651.0170641459815
        y: -465.01196034914847
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1754636636322'
          - step_content
          variable_selector:
          - conversation
          - md_content
          write_mode: over-write
        selected: false
        title: 变量赋值 9
        type: assigner
        version: '2'
      height: 84
      id: '1770091146541'
      position:
        x: 926.780538230249
        y: -444.4482340754373
      positionAbsolute:
        x: 926.780538230249
        y: -444.4482340754373
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#1754636636322.step_content#}}'
        desc: ''
        selected: false
        title: 人才需求分析-修改回复
        type: answer
        variables: []
      height: 103
      id: '17700911705560'
      position:
        x: 2363.6717175032386
        y: -456.04188239325356
      positionAbsolute:
        x: 2363.6717175032386
        y: -456.04188239325356
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: empty
            id: c7ce0cd4-78af-4bbc-bc8d-7d5edfde3cca
            value: ''
            varType: string
            variable_selector:
            - '1754636636322'
            - step_content
          id: 'true'
          logical_operator: and
        selected: false
        title: 条件分支 7
        type: if-else
      height: 124
      id: '1770091319205'
      position:
        x: 462.2438185024539
        y: 1067.0743758049127
      positionAbsolute:
        x: 462.2438185024539
        y: 1067.0743758049127
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1754636636322'
          - step_content
          variable_selector:
          - conversation
          - md_content
          write_mode: over-write
        selected: false
        title: 变量赋值 10
        type: assigner
        version: '2'
      height: 84
      id: '1770091331592'
      position:
        x: 750.935468811097
        y: 1196.3130619371116
      positionAbsolute:
        x: 750.935468811097
        y: 1196.3130619371116
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#1754636636322.step_content#}}'
        desc: ''
        selected: false
        title: 人才需求分析--修改回复
        type: answer
        variables: []
      height: 103
      id: '17700913412330'
      position:
        x: 1694.9343147580837
        y: 1196.3130619371116
      positionAbsolute:
        x: 1694.9343147580837
        y: 1196.3130619371116
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        is_team_authorization: true
        paramSchemas:
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: query
            ja_JP: query
            pt_BR: query
            zh_Hans: query
          llm_description: ''
          max: null
          min: null
          name: query
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: database_id
            ja_JP: database_id
            pt_BR: database_id
            zh_Hans: database_id
          llm_description: ''
          max: null
          min: null
          name: database_id
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: null
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: methods
            ja_JP: methods
            pt_BR: methods
            zh_Hans: methods
          llm_description: ''
          max: null
          min: null
          name: methods
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: ''
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: keywords
            ja_JP: keywords
            pt_BR: keywords
            zh_Hans: keywords
          llm_description: ''
          max: null
          min: null
          name: keywords
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: '0'
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: methods_local_is_all
            ja_JP: methods_local_is_all
            pt_BR: methods_local_is_all
            zh_Hans: methods_local_is_all
          llm_description: ''
          max: null
          min: null
          name: methods_local_is_all
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: true
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: searchapi_io
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: methods_web_provider_select
            ja_JP: methods_web_provider_select
            pt_BR: methods_web_provider_select
            zh_Hans: methods_web_provider_select
          llm_description: ''
          max: null
          min: null
          name: methods_web_provider_select
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: '0'
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: methods_web_video_nums
            ja_JP: methods_web_video_nums
            pt_BR: methods_web_video_nums
            zh_Hans: methods_web_video_nums
          llm_description: ''
          max: null
          min: null
          name: methods_web_video_nums
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: number
        - auto_generate: null
          default: ''
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: methods_web_domain_select
            ja_JP: methods_web_domain_select
            pt_BR: methods_web_domain_select
            zh_Hans: methods_web_domain_select
          llm_description: ''
          max: null
          min: null
          name: methods_web_domain_select
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: ''
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: methods_web_data_nums
            ja_JP: methods_web_data_nums
            pt_BR: methods_web_data_nums
            zh_Hans: methods_web_data_nums
          llm_description: ''
          max: null
          min: null
          name: methods_web_data_nums
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: ''
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: time_filter
            ja_JP: time_filter
            pt_BR: time_filter
            zh_Hans: time_filter
          llm_description: ''
          max: null
          min: null
          name: time_filter
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: ''
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: run_mode
            ja_JP: run_mode
            pt_BR: run_mode
            zh_Hans: run_mode
          llm_description: ''
          max: null
          min: null
          name: run_mode
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        - auto_generate: null
          default: ''
          form: llm
          human_description:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          label:
            en_US: methods_web_regional_rules
            ja_JP: methods_web_regional_rules
            pt_BR: methods_web_regional_rules
            zh_Hans: methods_web_regional_rules
          llm_description: ''
          max: null
          min: null
          name: methods_web_regional_rules
          options: []
          placeholder:
            en_US: ''
            ja_JP: ''
            pt_BR: ''
            zh_Hans: ''
          precision: null
          required: false
          scope: null
          template: null
          type: string
        params:
          database_id: ''
          keywords: ''
          methods: ''
          methods_local_is_all: ''
          methods_web_data_nums: ''
          methods_web_domain_select: ''
          methods_web_provider_select: ''
          methods_web_regional_rules: ''
          methods_web_video_nums: ''
          query: ''
          run_mode: ''
          time_filter: ''
        plugin_id: null
        plugin_unique_identifier: null
        provider_icon:
          background: '#D1E9FF'
          content: 🔎
        provider_id: 019added-fc3e-754c-acfd-6253bd3fb081
        provider_name: 数据Pipeline（托育）
        provider_type: workflow
        selected: false
        title: 数据Pipeline（托育）
        tool_configurations: {}
        tool_description: ''
        tool_label: 数据Pipeline（托育）
        tool_name: get_data
        tool_node_version: '2'
        tool_parameters:
          database_id:
            type: mixed
            value: null
          keywords:
            type: mixed
            value: '{{#1755255418099.querier_str#}}'
          methods:
            type: mixed
            value: web
          methods_local_is_all:
            type: constant
            value: 0
          methods_web_data_nums:
            type: mixed
            value: ''
          methods_web_domain_select:
            type: mixed
            value: '["web","industry_reports","childcare_policy_and_news","expert_insights"]'
          methods_web_provider_select:
            type: mixed
            value: '["searchapi_io","tianyan_check_enterprises"]'
          methods_web_regional_rules:
            type: mixed
            value: ''
          methods_web_video_nums:
            type: constant
            value: 0
          query:
            type: mixed
            value: null
          run_mode:
            type: mixed
            value: ''
          time_filter:
            type: mixed
            value: 近三年
        type: tool
      height: 52
      id: '1770104708923'
      position:
        x: 1189.2476678522094
        y: -936.7146361095298
      positionAbsolute:
        x: 1189.2476678522094
        y: -936.7146361095298
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "# import json\n\n# def main(arg1):\n#     \"\"\"\n#     本代码节点旨在过滤输入数据中重复的URL。\n\
          #     它会遍历输入JSON结构中的'all_source_list'，并根据'url'字段移除重复项，仅保留第一次出现的条目。\n#  \
          \   最终返回与入参格式相同但内容经过筛选的数据。\n#     \"\"\"\n\n#     json_list = arg1\n\n#\
          \     # 遍历最外层的 'json' 列表\n#     for doc_group in json_list:\n#         if\
          \ not isinstance(doc_group, dict):\n#             continue\n\n#        \
          \ # 'result' 也是一个列表，需要继续遍历\n#         result_list = doc_group.get(\"result\"\
          , [])\n#         if not isinstance(result_list, list):\n#             continue\n\
          \n#         for doc in result_list:\n#             if not isinstance(doc,\
          \ dict):\n#                 continue\n            \n#             # 使用 try-except\
          \ 来健壮地处理可能不一致的数据结构\n#             try:\n#                 # 定位到需要去重的列表路径\n\
          #                 source_list = doc[\"web_data\"][\"comprehensive_data\"\
          ][\"all_source_list\"]\n                \n#                 # 检查 source_list\
          \ 是否为列表\n#                 if not isinstance(source_list, list):\n#    \
          \                 continue\n\n#                 # 用于存储已经见过的URL\n#      \
          \           seen_urls = set()\n#                 # 用于存储去重后的结果\n#       \
          \          unique_source_list = []\n                \n#                \
          \ # 遍历源列表进行去重\n#                 for item in source_list:\n#           \
          \          # 只有当条目是字典且包含URL时才进行处理\n#                     if isinstance(item,\
          \ dict):\n#                         url = item.get(\"url\")\n          \
          \              \n#                         # 只有当URL存在且是首次出现时，才将其加入结果列表和已见集合\n\
          #                         # 这个逻辑会隐式地过滤掉没有'url'字段或'url'为空的条目\n#         \
          \                if url and url not in seen_urls:\n#                   \
          \          unique_source_list.append(item)\n#                          \
          \   seen_urls.add(url)\n#                     else:\n#                 \
          \        # 如果列表中的项不是字典，无法按URL去重，则选择保留它\n#                         unique_source_list.append(item)\n\
          \                \n#                 # 用去重后的列表替换原始列表\n#                \
          \ doc[\"web_data\"][\"comprehensive_data\"][\"all_source_list\"] = unique_source_list\n\
          #             except (KeyError, TypeError):\n#                 # 如果数据结构不符合预期的嵌套路径（例如缺少某个键），则跳过该条目，继续处理下一个\n\
          #                 continue\n                \n#     # 按照要求，返回与入参结构相同的、经过处理的数据\n\
          #     return {\n#         \"result\": arg1,\n#         \"result_str\": str(arg1)\n\
          #     }\n\nimport json\n\ndef main(arg1):\n    \"\"\"\n    本代码节点旨在过滤输入数据中重复的URL，并返回处理后的对象及其JSON字符串表示。\n\
          \    它会遍历输入JSON结构中的'all_source_list'，并根据'url'字段移除重复项。\n    最终返回处理后的Python对象和符合JSON格式的字符串。\n\
          \    \"\"\"\n    # 检查 arg1 是否为列表\n    if not isinstance(arg1, list):\n \
          \       return {\"result\": arg1, \"result_str\": str(arg1)}\n\n    # 遍历\
          \ arg1 列表\n    for doc_group in arg1:\n        if not isinstance(doc_group,\
          \ dict):\n            continue\n        \n        result_list = doc_group.get(\"\
          result\", [])\n        if not isinstance(result_list, list):\n         \
          \   continue\n\n        for doc in result_list:\n            if not isinstance(doc,\
          \ dict):\n                continue\n            \n            try:\n   \
          \             source_list = doc[\"web_data\"][\"comprehensive_data\"][\"\
          all_source_list\"]\n                if not isinstance(source_list, list):\n\
          \                    continue\n\n                seen_urls = set()\n   \
          \             unique_source_list = []\n                \n              \
          \  for item in source_list:\n                    if isinstance(item, dict):\n\
          \                        url = item.get(\"url\")\n                     \
          \   if url and url not in seen_urls:\n                            unique_source_list.append(item)\n\
          \                            seen_urls.add(url)\n                    else:\n\
          \                        unique_source_list.append(item)\n             \
          \   \n                doc[\"web_data\"][\"comprehensive_data\"][\"all_source_list\"\
          ] = unique_source_list\n            except (KeyError, TypeError):\n    \
          \            continue\n                \n    # 返回处理后的Python对象，以及一个标准格式的JSON字符串\n\
          \    return {\n        \"result\": arg1,\n        # 使用 json.dumps 生成标准的JSON字符串，ensure_ascii=False确保中文字符不被转义\n\
          \        \"result_str\": json.dumps(arg1[0], ensure_ascii=False) \n    }\n\
          \n"
        code_language: python3
        outputs:
          result:
            children: null
            type: array[object]
          result_str:
            children: null
            type: string
        selected: false
        title: 过滤重复的数据
        type: code
        variables:
        - value_selector:
          - '1770104708923'
          - json
          value_type: array[object]
          variable: arg1
      height: 52
      id: '1770109415803'
      position:
        x: 1471.059343950506
        y: -936.7146361095298
      positionAbsolute:
        x: 1471.059343950506
        y: -936.7146361095298
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        code: "# # -*- coding: utf-8 -*-\n# # 健壮性最终版：本版本在原有基础上增加了全局错误捕获和安全降级机制。\n\
          # # 当主要逻辑遇到任何意外错误时，会切换到最简单的“字符数/4”模型进行强制截断，\n# # 确保在任何情况下都能返回一个长度安全的结果，保障工作流的稳定运行。\n\
          \n# from typing import Dict, Any\n# import math\n\n# def estimate_token_count_for_sandbox(text:\
          \ str) -> int:\n#     \"\"\"\n#     一个为沙箱环境设计的、可靠的 token 估算函数。\n#     -\
          \ 中文字符: 1个字 ≈ 2个token (采用保守值确保安全)\n#     - 其他字符 (英文、数字、空格等): 4个字符 ≈ 1个token\n\
          #     \"\"\"\n#     if not isinstance(text, str):\n#         # 增加输入类型检查，防止非字符串输入导致下方循环报错\n\
          #         return 0\n\n#     chinese_char_count = 0\n#     other_char_count\
          \ = 0\n\n#     for char in text:\n#         # 使用Unicode范围判断是否为CJK统一表意文字\
          \ (覆盖绝大部分汉字)\n#         if '\\u4e00' <= char <= '\\u9fff':\n#          \
          \   chinese_char_count += 1\n#         else:\n#             other_char_count\
          \ += 1\n    \n#     chinese_tokens = chinese_char_count * 2\n#     other_tokens\
          \ = math.ceil(other_char_count / 4)\n    \n#     total_tokens = chinese_tokens\
          \ + other_tokens\n#     return int(total_tokens)\n\n# def main(markdown_content:\
          \ str) -> Dict[str, Any]:\n#     \"\"\"\n#     在不依赖tiktoken的情况下，检查并裁剪超长文本，并包含错误降级处理机制。\n\
          #     \"\"\"\n#     MAX_INPUT_TOKENS = 0  # 初始化以扩大作用域\n\n#     # --- 1.\
          \ 配置 Token 限制 ---\n#     try:\n#         MAX_CONTEXT_TOKENS = 258576 \n\
          #         RESERVED_OUTPUT_TOKENS = 65501\n#         SAFETY_MARGIN = 5000\
          \ \n#         MAX_INPUT_TOKENS = MAX_CONTEXT_TOKENS - RESERVED_OUTPUT_TOKENS\
          \ - SAFETY_MARGIN\n\n#         print(f\"[+] Dify Log: 模型总限制={MAX_CONTEXT_TOKENS},\
          \ 预留输出={RESERVED_OUTPUT_TOKENS}, 最大输入={MAX_INPUT_TOKENS}\")\n\n#     except\
          \ Exception as e:\n#         print(f\"[-] Dify Log: 配置初始化失败: {e}\")\n# \
          \        # 即使配置失败，也返回原始文本，避免工作流中断\n#         return {\n#             \"\
          trimmed_markdown_content\": markdown_content, \n#             \"status\"\
          : f\"Error: Configuration failed: {e}\",\n#             \"original_tokens\"\
          : -1, \n#             \"new_tokens\": -1, \n#             \"max_input_tokens\"\
          : -1\n#         }\n\n#     # --- 2. 主逻辑与错误捕获 ---\n#     try:\n#        \
          \ original_char_count = len(markdown_content)\n#         input_token_count\
          \ = estimate_token_count_for_sandbox(markdown_content)\n#         print(f\"\
          [~] Dify Log: 文本共 {original_char_count} 字符, 估算 Token 数为: {input_token_count}\"\
          )\n\n#         # --- 3. 判断是否需要裁剪 ---\n#         if input_token_count <=\
          \ MAX_INPUT_TOKENS:\n#             print(\"[+] Dify Log: Token 在限制内，无需裁剪。\"\
          )\n#             return {\n#                 \"trimmed_markdown_content\"\
          : markdown_content, \n#                 \"status\": \"No trimming needed.\"\
          ,\n#                 \"original_tokens\": input_token_count, \n#       \
          \          \"new_tokens\": input_token_count, \n#                 \"max_input_tokens\"\
          : MAX_INPUT_TOKENS\n#             }\n#         else:\n#             # ---\
          \ 4. 执行“中间裁切”（主方案） ---\n#             tokens_to_remove = input_token_count\
          \ - MAX_INPUT_TOKENS\n#             print(f\"[-] Dify Log: Token 超出限制！需移除约\
          \ {tokens_to_remove} 个 Token。\")\n            \n#             avg_char_per_token\
          \ = original_char_count / input_token_count if input_token_count > 0 else\
          \ 2\n#             chars_to_remove = math.ceil(tokens_to_remove * avg_char_per_token)\n\
          \            \n#             mid_index = original_char_count // 2\n#   \
          \          start_remove_index = max(0, mid_index - chars_to_remove // 2)\n\
          #             end_remove_index = min(original_char_count, mid_index + (chars_to_remove\
          \ + 1) // 2)\n\n#             if start_remove_index >= end_remove_index:\n\
          #                  return {\n#                     \"trimmed_markdown_content\"\
          : markdown_content, \n#                     \"status\": \"Warning: Trimming\
          \ range invalid.\",\n#                     \"original_tokens\": input_token_count,\
          \ \n#                     \"new_tokens\": input_token_count, \n#       \
          \              \"max_input_tokens\": MAX_INPUT_TOKENS\n#               \
          \  }\n\n#             truncation_marker = \"\\n\\n... [部分内容因超长已从中间省略] ...\\\
          n\\n\"\n#             trimmed_text = markdown_content[:start_remove_index]\
          \ + truncation_marker + markdown_content[end_remove_index:]\n          \
          \  \n#             new_token_count = estimate_token_count_for_sandbox(trimmed_text)\n\
          #             print(f\"[+] Dify Log: 裁剪完成。新估算 Token 数为: {new_token_count}\"\
          )\n\n#             return {\n#                 \"trimmed_markdown_content\"\
          : trimmed_text,\n#                 \"status\": f\"Trimmed from middle. Removed\
          \ approx. {tokens_to_remove} tokens.\",\n#                 \"original_tokens\"\
          : input_token_count, \n#                 \"new_tokens\": new_token_count,\
          \ \n#                 \"max_input_tokens\": MAX_INPUT_TOKENS\n#        \
          \     }\n\n#     except Exception as e:\n#         # --- 5. 异常捕获与安全降级处理\
          \ ---\n#         print(f\"[-] Dify Log: 主逻辑执行出现意外错误: '{e}'. 启动安全降级裁剪模式。\"\
          )\n        \n#         # 使用最保守的 字符/4 模型进行截断\n#         # 乘以4是为了将Token限制转换为大致的字符限制\n\
          #         target_char_count = int(MAX_INPUT_TOKENS * 4)\n        \n#   \
          \      if len(markdown_content) > target_char_count:\n#             # 采用最简单的末尾截断，确保不会出错\n\
          #             safe_trimmed_text = markdown_content[:target_char_count]\n\
          #             truncation_marker_safe = \"\\n\\n... [内容因程序意外错误被强制截断] ...\\\
          n\\n\"\n#             safe_trimmed_text += truncation_marker_safe\n#   \
          \          status_msg = f\"Error: Fallback trimming activated due to: {e}\"\
          \n#         else:\n#             # 如果文本本身不长，但依然报错，说明是其他问题，返回原文\n#      \
          \       safe_trimmed_text = markdown_content\n#             status_msg =\
          \ f\"Error: An unexpected error occurred but no trimming was needed. Original\
          \ error: {e}\"\n\n#         return {\n#             \"trimmed_markdown_content\"\
          : safe_trimmed_text,\n#             \"status\": status_msg,\n#         \
          \    \"original_tokens\": -1,  # 使用-1表示估算失败\n#             \"new_tokens\"\
          : -1,       # 使用-1表示估算失败\n#             \"max_input_tokens\": MAX_INPUT_TOKENS\n\
          #         }\n# -*- coding: utf-8 -*-\n# 健壮性最终版：本版本在原有基础上增加了全局错误捕获和安全降级机制。\n\
          # 当主要逻辑遇到任何意外错误时，会切换到最简单的“字符数/4”模型进行强制截断，\n# 确保在任何情况下都能返回一个长度安全的结果，保障工作流的稳定运行。\n\
          \nfrom typing import Dict, Any\nimport math\n\ndef estimate_token_count_for_sandbox(text:\
          \ str) -> int:\n    \"\"\"\n    一个为沙箱环境设计的、可靠的 token 估算函数。\n    - 中文字符:\
          \ 1个字 ≈ 2个token (采用保守值确保安全)\n    - 其他字符 (英文、数字、空格等): 4个字符 ≈ 1个token\n  \
          \  \"\"\"\n    if not isinstance(text, str):\n        # 增加输入类型检查，防止非字符串输入导致下方循环报错\n\
          \        return 0\n\n    chinese_char_count = 0\n    other_char_count =\
          \ 0\n\n    for char in text:\n        # 使用Unicode范围判断是否为CJK统一表意文字 (覆盖绝大部分汉字)\n\
          \        if '\\u4e00' <= char <= '\\u9fff':\n            chinese_char_count\
          \ += 1\n        else:\n            other_char_count += 1\n    \n    chinese_tokens\
          \ = chinese_char_count * 2\n    other_tokens = math.ceil(other_char_count\
          \ / 4)\n    \n    total_tokens = chinese_tokens + other_tokens\n    return\
          \ int(total_tokens)\n\ndef main(markdown_content: str) -> Dict[str, Any]:\n\
          \    \"\"\"\n    在不依赖tiktoken的情况下，检查并裁剪超长文本，并包含错误降级处理机制。\n    \"\"\"\n \
          \   MAX_INPUT_TOKENS = 0  # 初始化以扩大作用域\n\n    # --- 1. 配置 Token 限制 ---\n\
          \    try:\n        MAX_CONTEXT_TOKENS = 1048576#258576  # Based on error\
          \ message\n        RESERVED_OUTPUT_TOKENS = 10000#65501  # Prompt预留1wtoken\n\
          \        SAFETY_MARGIN = 0#5000  # Removed safety margin as reserved tokens\
          \ cover it\n        MAX_INPUT_TOKENS = MAX_CONTEXT_TOKENS - RESERVED_OUTPUT_TOKENS\
          \ - SAFETY_MARGIN\n\n        print(f\"[+] Dify Log: 模型总限制={MAX_CONTEXT_TOKENS},\
          \ 预留输出={RESERVED_OUTPUT_TOKENS}, 最大输入={MAX_INPUT_TOKENS}\")\n\n    except\
          \ Exception as e:\n        print(f\"[-] Dify Log: 配置初始化失败: {e}\")\n    \
          \    # 即使配置失败，也返回原始文本，避免工作流中断\n        return {\n            \"trimmed_markdown_content\"\
          : markdown_content, \n            \"status\": f\"Error: Configuration failed:\
          \ {e}\",\n            \"original_tokens\": -1, \n            \"new_tokens\"\
          : -1, \n            \"max_input_tokens\": -1\n        }\n\n    # --- 2.\
          \ 主逻辑与错误捕获 ---\n    try:\n        original_char_count = len(markdown_content)\n\
          \        input_token_count = estimate_token_count_for_sandbox(markdown_content)\n\
          \        print(f\"[~] Dify Log: 文本共 {original_char_count} 字符, 估算 Token 数为:\
          \ {input_token_count}\")\n\n        # --- 3. 判断是否需要裁剪 ---\n        if input_token_count\
          \ <= MAX_INPUT_TOKENS:\n            print(\"[+] Dify Log: Token 在限制内，无需裁剪。\"\
          )\n            return {\n                \"trimmed_markdown_content\": markdown_content,\
          \ \n                \"status\": \"No trimming needed.\",\n             \
          \   \"original_tokens\": input_token_count, \n                \"new_tokens\"\
          : input_token_count, \n                \"max_input_tokens\": MAX_INPUT_TOKENS\n\
          \            }\n        else:\n            # --- 4. 执行“中间裁切”（主方案） ---\n\
          \            tokens_to_remove = input_token_count - MAX_INPUT_TOKENS\n \
          \           print(f\"[-] Dify Log: Token 超出限制！需移除约 {tokens_to_remove} 个\
          \ Token。\")\n            \n            avg_char_per_token = original_char_count\
          \ / input_token_count if input_token_count > 0 else 2\n            chars_to_remove\
          \ = math.ceil(tokens_to_remove * avg_char_per_token)\n            \n   \
          \         mid_index = original_char_count // 2\n            start_remove_index\
          \ = max(0, mid_index - chars_to_remove // 2)\n            end_remove_index\
          \ = min(original_char_count, mid_index + (chars_to_remove + 1) // 2)\n\n\
          \            if start_remove_index >= end_remove_index:\n              \
          \   return {\n                    \"trimmed_markdown_content\": markdown_content,\
          \ \n                    \"status\": \"Warning: Trimming range invalid.\"\
          ,\n                    \"original_tokens\": input_token_count, \n      \
          \              \"new_tokens\": input_token_count, \n                   \
          \ \"max_input_tokens\": MAX_INPUT_TOKENS\n                }\n\n        \
          \    truncation_marker = \"\\n\\n... [部分内容因超长已从中间省略] ...\\n\\n\"\n     \
          \       trimmed_text = markdown_content[:start_remove_index] + truncation_marker\
          \ + markdown_content[end_remove_index:]\n            \n            new_token_count\
          \ = estimate_token_count_for_sandbox(trimmed_text)\n            print(f\"\
          [+] Dify Log: 裁剪完成。新估算 Token 数为: {new_token_count}\")\n\n            # Double\
          \ check and trim again if still over the limit\n            if new_token_count\
          \ > MAX_INPUT_TOKENS:\n                tokens_to_remove = new_token_count\
          \ - MAX_INPUT_TOKENS\n                avg_char_per_token = original_char_count\
          \ / input_token_count if input_token_count > 0 else 2\n                chars_to_remove\
          \ = math.ceil(tokens_to_remove * avg_char_per_token)\n                safe_trimmed_text\
          \ = trimmed_text[:len(trimmed_text) - chars_to_remove] + truncation_marker\
          \ # Trim from end for safety.\n                new_token_count = estimate_token_count_for_sandbox(safe_trimmed_text)\
          \  # Recalculate token count after fallback trim\n                print(f\"\
          [+] Dify Log: 再次裁剪完成。新估算 Token 数为: {new_token_count}\")\n              \
          \  return {\n                    \"trimmed_markdown_content\": safe_trimmed_text,\n\
          \                    \"status\": f\"Trimmed from middle, then fallback trimmed\
          \ from end. Removed approx. {tokens_to_remove} tokens.\",\n            \
          \        \"original_tokens\": input_token_count,\n                    \"\
          new_tokens\": new_token_count,\n                    \"max_input_tokens\"\
          : MAX_INPUT_TOKENS\n                }\n\n            return {\n        \
          \        \"trimmed_markdown_content\": trimmed_text,\n                \"\
          status\": f\"Trimmed from middle. Removed approx. {tokens_to_remove} tokens.\"\
          ,\n                \"original_tokens\": input_token_count, \n          \
          \      \"new_tokens\": new_token_count, \n                \"max_input_tokens\"\
          : MAX_INPUT_TOKENS\n            }\n\n    except Exception as e:\n      \
          \  # --- 5. 异常捕获与安全降级处理 ---\n        print(f\"[-] Dify Log: 主逻辑执行出现意外错误:\
          \ '{e}'. 启动安全降级裁剪模式。\")\n        \n        # 使用最保守的 字符/4 模型进行截断\n      \
          \  # 乘以4是为了将Token限制转换为大致的字符限制\n        target_char_count = int(MAX_INPUT_TOKENS\
          \ * 4)\n        \n        if len(markdown_content) > target_char_count:\n\
          \            # 采用最简单的末尾截断，确保不会出错\n            safe_trimmed_text = markdown_content[:target_char_count]\n\
          \            truncation_marker_safe = \"\\n\\n... [内容因程序意外错误被强制截断] ...\\\
          n\\n\"\n            safe_trimmed_text += truncation_marker_safe\n      \
          \      status_msg = f\"Error: Fallback trimming activated due to: {e}\"\n\
          \        else:\n            # 如果文本本身不长，但依然报错，说明是其他问题，返回原文\n            safe_trimmed_text\
          \ = markdown_content\n            status_msg = f\"Error: An unexpected error\
          \ occurred but no trimming was needed. Original error: {e}\"\n\n       \
          \ return {\n            \"trimmed_markdown_content\": safe_trimmed_text,\n\
          \            \"status\": status_msg,\n            \"original_tokens\": -1,\
          \  # 使用-1表示估算失败\n            \"new_tokens\": -1,       # 使用-1表示估算失败\n  \
          \          \"max_input_tokens\": MAX_INPUT_TOKENS\n        }\n"
        code_language: python3
        outputs:
          max_input_tokens:
            children: null
            type: number
          new_tokens:
            children: null
            type: number
          original_tokens:
            children: null
            type: number
          status:
            children: null
            type: string
          trimmed_markdown_content:
            children: null
            type: string
        selected: false
        title: token量安全保证器 (1)
        type: code
        variables:
        - value_selector:
          - '1770109415803'
          - result_str
          value_type: string
          variable: markdown_content
      height: 52
      id: '1770109476978'
      position:
        x: 1732.0157807567111
        y: -1003.6184717443404
      positionAbsolute:
        x: 1732.0157807567111
        y: -1003.6184717443404
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        items:
        - input_type: variable
          operation: over-write
          value:
          - '1765164153379'
          - output_str
          variable_selector:
          - conversation
          - web_data
          write_mode: over-write
        - input_type: variable
          operation: over-write
          value:
          - '1765164153379'
          - enterprise_infos_str
          variable_selector:
          - conversation
          - enterprise_infos
          write_mode: over-write
        - input_type: variable
          operation: over-write
          value:
          - '1765164153379'
          - career_postings_str
          variable_selector:
          - conversation
          - career_postings
          write_mode: over-write
        selected: false
        title: 变量赋值 10
        type: assigner
        version: '2'
      height: 136
      id: '1770109738186'
      position:
        x: 2696.241443642176
        y: -963.7261975025244
      positionAbsolute:
        x: 2696.241443642176
        y: -963.7261975025244
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    viewport:
      x: -564.8882506029604
      y: 741.4019293620827
      zoom: 0.9773188487139148
  rag_pipeline_variables: []
